(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     29602,        955]
NotebookOptionsPosition[     27353,        877]
NotebookOutlinePosition[     27826,        895]
CellTagsIndexPosition[     27783,        892]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"P", "[", 
   RowBox[{"i_", ",", "j_", ",", "xList_", ",", "\[Mu]_"}], "]"}], ":=", 
  TagBox[GridBox[{
     {"\[Piecewise]", GridBox[{
        {"1", 
         RowBox[{
          RowBox[{"i", "\[Equal]", "1"}], "&&", 
          RowBox[{"j", "\[Equal]", "0"}]}]},
        {
         RowBox[{
          UnderoverscriptBox["\[Sum]", 
           RowBox[{"k", "=", "1"}], 
           RowBox[{"i", "-", "1"}]], 
          RowBox[{
           RowBox[{"P", "[", 
            RowBox[{
             RowBox[{"i", "-", "1"}], ",", 
             RowBox[{"k", "-", "1"}], ",", "xList", ",", "\[Mu]"}], "]"}], 
           "*", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{
              UnderoverscriptBox["\[Sum]", 
               RowBox[{"l", "=", "0"}], 
               RowBox[{"k", "-", "1"}]], 
              RowBox[{
               FractionBox[
                SuperscriptBox[
                 RowBox[{"xList", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", "-", "1"}], "]"}], "]"}], "l"], 
                RowBox[{
                 SuperscriptBox["\[Mu]", "l"], "*", 
                 RowBox[{"l", "!"}]}]], "*", 
               RowBox[{"Exp", "[", 
                FractionBox[
                 RowBox[{"-", 
                  RowBox[{"xList", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", "-", "1"}], "]"}], "]"}]}], "\[Mu]"], 
                "]"}]}]}]}], ")"}]}]}], 
         RowBox[{
          RowBox[{"i", "\[GreaterEqual]", "2"}], "&&", 
          RowBox[{"j", "\[Equal]", "0"}]}]},
        {
         RowBox[{
          UnderoverscriptBox["\[Sum]", 
           RowBox[{"k", "=", "0"}], 
           RowBox[{"i", "-", "j", "-", "1"}]], 
          RowBox[{
           RowBox[{"P", "[", 
            RowBox[{
             RowBox[{"i", "-", "1"}], ",", 
             RowBox[{"j", "+", "k", "-", "1"}], ",", "xList", ",", "\[Mu]"}], 
            "]"}], "*", 
           FractionBox[
            SuperscriptBox[
             RowBox[{"xList", "[", 
              RowBox[{"[", 
               RowBox[{"i", "-", "1"}], "]"}], "]"}], "k"], 
            RowBox[{
             SuperscriptBox["\[Mu]", "k"], "*", 
             RowBox[{"k", "!"}]}]], "*", 
           RowBox[{"Exp", "[", 
            FractionBox[
             RowBox[{"-", 
              RowBox[{"xList", "[", 
               RowBox[{"[", 
                RowBox[{"i", "-", "1"}], "]"}], "]"}]}], "\[Mu]"], "]"}]}]}], 
         
         RowBox[{
          RowBox[{"i", "\[GreaterEqual]", "2"}], "&&", 
          RowBox[{"j", "\[GreaterEqual]", "1"}]}]}
       },
       AllowedDimensions->{2, Automatic},
       Editable->True,
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxItemSize->{
        "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
         "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.84]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}},
       Selectable->True]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxItemSize->{
     "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.35]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}],
   "Piecewise",
   DeleteWithContents->True,
   Editable->False,
   SelectWithContents->True,
   Selectable->False]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"w", "[", 
   RowBox[{"i_", ",", "xList_", ",", "\[Mu]_"}], "]"}], ":=", 
  TagBox[GridBox[{
     {"\[Piecewise]", GridBox[{
        {"0", 
         RowBox[{"i", "\[Equal]", "1"}]},
        {
         RowBox[{
          UnderoverscriptBox["\[Sum]", 
           RowBox[{"j", "=", "1"}], 
           RowBox[{"i", "-", "1"}]], 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"j", "*", "\[Mu]"}], ")"}], "*", 
           RowBox[{"P", "[", 
            RowBox[{"i", ",", "j", ",", "xList", ",", "\[Mu]"}], "]"}]}]}], 
         RowBox[{"i", "\[GreaterEqual]", "2"}]}
       },
       AllowedDimensions->{2, Automatic},
       Editable->True,
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxItemSize->{
        "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
         "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.84]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}},
       Selectable->True]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxItemSize->{
     "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.35]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}],
   "Piecewise",
   DeleteWithContents->True,
   Editable->False,
   SelectWithContents->True,
   Selectable->False]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Phi]", "[", 
   RowBox[{"xList_", ",", "\[Gamma]_", ",", "\[Mu]_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", "\[Gamma]"}], ")"}], "*", 
    RowBox[{
     UnderoverscriptBox["\[Sum]", 
      RowBox[{"i", "=", "1"}], 
      RowBox[{
       RowBox[{"Length", "[", "xList", "]"}], "+", "1"}]], 
     RowBox[{"w", "[", 
      RowBox[{"i", ",", "xList", ",", "\[Mu]"}], "]"}]}]}], "+", 
   RowBox[{"\[Gamma]", "*", 
    RowBox[{
     UnderoverscriptBox["\[Sum]", 
      RowBox[{"i", "=", "1"}], 
      RowBox[{"Length", "[", "xList", "]"}]], 
     RowBox[{"xList", "[", 
      RowBox[{"[", "i", "]"}], "]"}]}]}], "+", 
   RowBox[{"\[Gamma]", "*", 
    RowBox[{"w", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "[", "xList", "]"}], "+", "1"}], ",", "xList", ",", 
      "\[Mu]"}], "]"}]}]}]}]}], "Input",
 CellChangeTimes->{{3.680251000925722*^9, 3.68025113146624*^9}, {
   3.680298841058309*^9, 3.680299087317749*^9}, 3.680299151228565*^9, {
   3.6802991869067183`*^9, 3.680299201826708*^9}, {3.6802998218998413`*^9, 
   3.68029982200242*^9}, {3.680301252535657*^9, 3.680301287344844*^9}, {
   3.680301374870729*^9, 3.6803014441540947`*^9}, {3.6803014966367197`*^9, 
   3.680301533995049*^9}, {3.680301589145356*^9, 3.680301665591489*^9}, {
   3.6803040217379627`*^9, 3.6803040220756607`*^9}, 3.680304494807775*^9, {
   3.680304708427453*^9, 3.680304719071371*^9}, {3.680552810164156*^9, 
   3.680552810664631*^9}, {3.680572311196271*^9, 3.6805724168801003`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"w", "[", 
  RowBox[{"1", ",", 
   RowBox[{"{", 
    SubscriptBox["x", "1"], "}"}], ",", "\[Mu]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"w", "[", 
  RowBox[{"2", ",", 
   RowBox[{"{", 
    SubscriptBox["x", "1"], "}"}], ",", "\[Mu]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.680553027790299*^9, 3.68055305774675*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.6805727019832373`*^9, 3.680572786695883*^9}],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{"-", 
    FractionBox[
     SubscriptBox["x", "1"], "\[Mu]"]}]], " ", "\[Mu]"}]], "Output",
 CellChangeTimes->{3.6805727019832373`*^9, 3.680572786706472*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Phi]", "[", 
   RowBox[{
    RowBox[{"{", 
     SubscriptBox["x", "1"], "}"}], ",", "\[Gamma]", ",", "\[Mu]"}], "]"}], "//",
   "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.6805530643925953`*^9, 3.680553088635229*^9}, {
  3.680572453324923*^9, 3.6805724568885612`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"-", 
     FractionBox[
      SubscriptBox["x", "1"], "\[Mu]"]}]], " ", "\[Mu]"}], "+", 
  RowBox[{"\[Gamma]", " ", 
   SubscriptBox["x", "1"]}]}]], "Output",
 CellChangeTimes->{3.680572702053974*^9, 3.68057278689568*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"\[Phi]", "[", 
     RowBox[{
      RowBox[{"{", 
       SubscriptBox["x", "1"], "}"}], ",", "\[Gamma]", ",", "\[Mu]"}], "]"}], 
    ",", 
    SubscriptBox["x", "1"]}], "]"}], "//", "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.680552982798023*^9, 3.6805529843762703`*^9}, {
  3.680572458916545*^9, 3.6805724628888817`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"-", 
     FractionBox[
      SubscriptBox["x", "1"], "\[Mu]"]}]]}], "+", "\[Gamma]"}]], "Output",
 CellChangeTimes->{3.680572702095724*^9, 3.6805727869258966`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"$Assumptions", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     SubscriptBox["x", "1"], "\[Element]", "Reals"}], ",", 
    RowBox[{"\[Gamma]", "\[Element]", "Reals"}], ",", 
    RowBox[{"\[Mu]", "\[Element]", "Reals"}], ",", 
    RowBox[{
     SubscriptBox["x", "1"], "\[GreaterEqual]", "0"}], ",", 
    RowBox[{"\[Gamma]", ">", "0"}], ",", 
    RowBox[{"\[Gamma]", "<", "1"}], ",", 
    RowBox[{"\[Mu]", ">", "0"}]}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"\[Phi]", "[", 
        RowBox[{
         RowBox[{"{", 
          SubscriptBox["x", "1"], "}"}], ",", "\[Gamma]", ",", "\[Mu]"}], 
        "]"}], ",", 
       SubscriptBox["x", "1"]}], "]"}], "\[Equal]", "0"}], ",", 
    SubscriptBox["x", "1"]}], "]"}], "//", "FullSimplify"}]}], "Input",
 CellChangeTimes->{{3.680560373526869*^9, 3.68056041553927*^9}, {
  3.680560502908194*^9, 3.680560554029248*^9}, {3.680560585817977*^9, 
  3.680560624892939*^9}, {3.6805608485089207`*^9, 3.680560878288506*^9}, {
  3.6805724736369057`*^9, 3.680572479199443*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    SubscriptBox["x", "1"], "\[Element]", "Reals"}], ",", 
   RowBox[{"\[Gamma]", "\[Element]", "Reals"}], ",", 
   RowBox[{"\[Mu]", "\[Element]", "Reals"}], ",", 
   RowBox[{
    SubscriptBox["x", "1"], "\[GreaterEqual]", "0"}], ",", 
   RowBox[{"\[Gamma]", ">", "0"}], ",", 
   RowBox[{"\[Gamma]", "<", "1"}], ",", 
   RowBox[{"\[Mu]", ">", "0"}]}], "}"}]], "Output",
 CellChangeTimes->{3.680572702121937*^9, 3.680572786960517*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    SubscriptBox["x", "1"], "\[Rule]", 
    RowBox[{"ConditionalExpression", "[", 
     RowBox[{
      RowBox[{"\[Mu]", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Pi]", " ", 
          RowBox[{"C", "[", "1", "]"}]}], "+", 
         RowBox[{"Log", "[", 
          FractionBox["1", "\[Gamma]"], "]"}]}], ")"}]}], ",", 
      RowBox[{
       RowBox[{"C", "[", "1", "]"}], "\[Element]", "Integers"}]}], "]"}]}], 
   "}"}], "}"}]], "Output",
 CellChangeTimes->{3.680572702121937*^9, 3.680572787042666*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]", "[", 
    RowBox[{
     RowBox[{"{", 
      SubscriptBox["x", "1"], "}"}], ",", "\[Gamma]", ",", "\[Mu]"}], "]"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["x", "1"], "\[Rule]", 
     RowBox[{
      RowBox[{"-", "\[Mu]"}], "*", 
      RowBox[{"Log", "[", "\[Gamma]", "]"}]}]}], "}"}]}], "//", 
  "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"\[Phi]", "[", 
      RowBox[{
       RowBox[{"{", 
        SubscriptBox["x", "1"], "}"}], ",", "\[Gamma]", ",", "\[Mu]"}], "]"}],
      ",", 
     SubscriptBox["x", "1"]}], "]"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["x", "1"], "\[Rule]", 
     RowBox[{
      RowBox[{"-", "\[Mu]"}], "*", 
      RowBox[{"Log", "[", "\[Gamma]", "]"}]}]}], "}"}]}], "//", 
  "FullSimplify"}]}], "Input",
 CellChangeTimes->{{3.680560629593133*^9, 3.680560659597518*^9}, {
  3.680560724606482*^9, 3.680560822740799*^9}, {3.680572483043954*^9, 
  3.680572510962738*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "\[Gamma]"}], " ", "\[Mu]", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", "1"}], "+", 
    RowBox[{"Log", "[", "\[Gamma]", "]"}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.680572702213863*^9, 3.68057278706607*^9}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.680572702213863*^9, 3.680572787076123*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"\[Phi]", "[", 
     RowBox[{
      RowBox[{"{", 
       SubscriptBox["x", "1"], "}"}], ",", "\[Gamma]", ",", "\[Mu]"}], "]"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["x", "1"], ",", "2"}], "}"}]}], "]"}], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.680560980639958*^9, 3.6805610316323137`*^9}, {
  3.680572514320518*^9, 3.680572538570394*^9}}],

Cell[BoxData[
 FractionBox[
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{"-", 
    FractionBox[
     SubscriptBox["x", "1"], "\[Mu]"]}]], "\[Mu]"]], "Output",
 CellChangeTimes->{3.680572702263051*^9, 3.6805727871125383`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"w", "[", 
  RowBox[{"1", ",", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["x", "1"], ",", 
     SubscriptBox["x", "2"]}], "}"}], ",", "1"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"w", "[", 
  RowBox[{"2", ",", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["x", "1"], ",", 
     SubscriptBox["x", "2"]}], "}"}], ",", "1"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"w", "[", 
   RowBox[{"3", ",", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["x", "1"], ",", 
      SubscriptBox["x", "2"]}], "}"}], ",", "1"}], "]"}], "//", 
  "FullSimplify"}]}], "Input",
 CellChangeTimes->{{3.680561074464261*^9, 3.680561097665063*^9}, {
  3.680576360547254*^9, 3.680576387838119*^9}, {3.680578691712881*^9, 
  3.68057869330807*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{
  3.6805727022964077`*^9, 3.6805727871592617`*^9, {3.680576362499642*^9, 
   3.680576388581588*^9}, 3.680578693750836*^9}],

Cell[BoxData[
 SuperscriptBox["\[ExponentialE]", 
  RowBox[{"-", 
   SubscriptBox["x", "1"]}]]], "Output",
 CellChangeTimes->{
  3.6805727022964077`*^9, 3.6805727871592617`*^9, {3.680576362499642*^9, 
   3.680576388581588*^9}, 3.680578693759985*^9}],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{
    RowBox[{"-", 
     SubscriptBox["x", "1"]}], "-", 
    SubscriptBox["x", "2"]}]], " ", 
  RowBox[{"(", 
   RowBox[{"1", "+", 
    SuperscriptBox["\[ExponentialE]", 
     SubscriptBox["x", "1"]], "+", 
    SubscriptBox["x", "2"]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.6805727022964077`*^9, 3.6805727871592617`*^9, {3.680576362499642*^9, 
   3.680576388581588*^9}, 3.680578693791827*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Phi]", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["x", "1"], ",", 
      SubscriptBox["x", "2"]}], "}"}], ",", "\[Gamma]", ",", "1"}], "]"}], "//",
   "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.680561148753046*^9, 3.680561149637231*^9}, {
  3.680572547194605*^9, 3.680572551292984*^9}, {3.6805786964848757`*^9, 
  3.6805786966084557`*^9}}],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{
    RowBox[{"-", 
     SubscriptBox["x", "1"]}], "-", 
    SubscriptBox["x", "2"]}]], " ", 
  RowBox[{"(", 
   RowBox[{"1", "+", 
    SuperscriptBox["\[ExponentialE]", 
     SubscriptBox["x", "1"]], "+", 
    SubscriptBox["x", "2"], "+", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      SubscriptBox["x", "2"]], " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", "\[Gamma]", "+", 
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         SubscriptBox["x", "1"]], " ", "\[Gamma]", " ", 
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["x", "1"], "+", 
          SubscriptBox["x", "2"]}], ")"}]}]}], ")"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.680572702962184*^9, 3.6805727878075*^9, 
  3.680578697287315*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["x", "1"], ",", 
       SubscriptBox["x", "2"]}], "}"}], ",", "\[Gamma]", ",", "1"}], "]"}], "//",
    "FullSimplify"}], "//", "TeXForm"}]], "Input",
 CellChangeTimes->{{3.680576766498456*^9, 3.680576770131206*^9}, {
  3.68057681657423*^9, 3.680576816855776*^9}, {3.680578701609379*^9, 
  3.680578701708325*^9}}],

Cell["\<\
e^{-x_1-x_2} \\left(e^{x_2} \\left(-\\gamma +\\gamma  e^{x_1}
   \\left(x_1+x_2\\right)+1\\right)+x_2+e^{x_1}+1\\right)\
\>", "Output",
 CellChangeTimes->{3.6805767713107977`*^9, 3.680576823494939*^9, 
  3.680578702465064*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"\[Phi]", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["x", "1"], ",", 
        SubscriptBox["x", "2"]}], "}"}], ",", "\[Gamma]", ",", "1"}], "]"}], 
    ",", 
    SubscriptBox["x", "1"]}], "]"}], "//", 
  "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"\[Phi]", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["x", "1"], ",", 
        SubscriptBox["x", "2"]}], "}"}], ",", "\[Gamma]", ",", "1"}], "]"}], 
    ",", 
    SubscriptBox["x", "2"]}], "]"}], "//", "FullSimplify"}]}], "Input",
 CellChangeTimes->{{3.680561269723989*^9, 3.680561275759309*^9}, {
  3.6805725530950813`*^9, 3.680572563284663*^9}, {3.68057870566088*^9, 
  3.680578707133453*^9}}],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{
    RowBox[{"-", 
     SubscriptBox["x", "1"]}], "-", 
    SubscriptBox["x", "2"]}]], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", "1"}], "+", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      SubscriptBox["x", "2"]], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "\[Gamma]", "+", 
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         SubscriptBox["x", "1"]], " ", "\[Gamma]"}]}], ")"}]}], "-", 
    SubscriptBox["x", "2"]}], ")"}]}]], "Output",
 CellChangeTimes->{3.680572703390955*^9, 3.680572788279496*^9, 
  3.680578707710104*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"-", 
     SubscriptBox["x", "2"]}]]}], "+", "\[Gamma]", "-", 
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{
     RowBox[{"-", 
      SubscriptBox["x", "1"]}], "-", 
     SubscriptBox["x", "2"]}]], " ", 
   SubscriptBox["x", "2"]}]}]], "Output",
 CellChangeTimes->{3.680572703390955*^9, 3.680572788279496*^9, 
  3.680578707810989*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"\[Phi]", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         SubscriptBox["x", "1"], ",", 
         SubscriptBox["x", "2"]}], "}"}], ",", "\[Gamma]", ",", "1"}], "]"}], 
     ",", 
     SubscriptBox["x", "1"]}], "]"}], "\[Equal]", "0"}], "//", 
  "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"\[Phi]", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         SubscriptBox["x", "1"], ",", 
         SubscriptBox["x", "2"]}], "}"}], ",", "\[Gamma]", ",", "1"}], "]"}], 
     ",", 
     SubscriptBox["x", "2"]}], "]"}], "\[Equal]", "0"}], "//", 
  "FullSimplify"}]}], "Input",
 CellChangeTimes->{{3.680561310615637*^9, 3.680561321570057*^9}, {
  3.680561447907345*^9, 3.680561477607728*^9}, {3.680561522499379*^9, 
  3.680561534217712*^9}, {3.6805725663784103`*^9, 3.68057260518818*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    SubscriptBox["x", "2"]], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "\[Gamma]", "+", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       SubscriptBox["x", "1"]], " ", "\[Gamma]"}]}], ")"}]}], "\[Equal]", 
  RowBox[{"1", "+", 
   SubscriptBox["x", "2"]}]}]], "Output",
 CellChangeTimes->{3.680572703852538*^9, 3.680572788768968*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    SubscriptBox["x", "1"]], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       SubscriptBox["x", "2"]], " ", "\[Gamma]"}]}], ")"}]}], "\[Equal]", 
  SubscriptBox["x", "2"]}]], "Output",
 CellChangeTimes->{3.680572703852538*^9, 3.680572788907399*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"\[Phi]", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            SubscriptBox["x", "1"], ",", 
            SubscriptBox["x", "2"]}], "}"}], ",", "\[Gamma]", ",", "1"}], 
         "]"}], ",", 
        SubscriptBox["x", "1"]}], "]"}], "\[Equal]", "0"}], "&&", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"\[Phi]", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            SubscriptBox["x", "1"], ",", 
            SubscriptBox["x", "2"]}], "}"}], ",", "\[Gamma]", ",", "1"}], 
         "]"}], ",", 
        SubscriptBox["x", "2"]}], "]"}], "\[Equal]", "0"}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["x", "1"], ",", 
      SubscriptBox["x", "2"]}], "}"}]}], "]"}], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.680561401138565*^9, 3.680561440314515*^9}, {
  3.680561562789484*^9, 3.680561568942492*^9}, {3.6805726332948513`*^9, 
  3.680572639509553*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Solve", "::", "nsmet"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"This system cannot be solved with the methods available to \
Solve. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/Solve\\\", ButtonNote -> \
\\\"Solve::nsmet\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.680572704314378*^9, 3.680572789291946*^9}],

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       SubscriptBox["x", "2"]], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "\[Gamma]", "+", 
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          SubscriptBox["x", "1"]], " ", "\[Gamma]"}]}], ")"}]}], "\[Equal]", 
     RowBox[{"1", "+", 
      SubscriptBox["x", "2"]}]}], "&&", 
    RowBox[{
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       SubscriptBox["x", "1"]], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          SubscriptBox["x", "2"]], " ", "\[Gamma]"}]}], ")"}]}], "\[Equal]", 
     SubscriptBox["x", "2"]}]}], ",", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["x", "1"], ",", 
     SubscriptBox["x", "2"]}], "}"}]}], "]"}]], "Output",
 CellChangeTimes->{3.6805727045079517`*^9, 3.680572789507172*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"\[Phi]", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["x", "1"], ",", 
        SubscriptBox["x", "2"]}], "}"}], ",", "\[Gamma]", ",", "1"}], "]"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["x", "1"], ",", "2"}], "}"}]}], "]"}], "//", 
  "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"\[Phi]", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["x", "1"], ",", 
        SubscriptBox["x", "2"]}], "}"}], ",", "\[Gamma]", ",", "1"}], "]"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["x", "2"], ",", "2"}], "}"}]}], "]"}], "//", 
  "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"\[Phi]", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["x", "1"], ",", 
        SubscriptBox["x", "2"]}], "}"}], ",", "\[Gamma]", ",", "1"}], "]"}], 
    ",", 
    SubscriptBox["x", "1"], ",", 
    SubscriptBox["x", "2"]}], "]"}], "//", "FullSimplify"}]}], "Input",
 CellChangeTimes->{{3.680561592100635*^9, 3.680561630406209*^9}, {
  3.680561661282693*^9, 3.6805616654721737`*^9}, {3.6805617097023582`*^9, 
  3.680561718557745*^9}, {3.680562092058117*^9, 3.680562131230084*^9}, {
  3.680562175397037*^9, 3.6805621756966352`*^9}, {3.6805622921495028`*^9, 
  3.680562339498487*^9}, {3.6805726444512*^9, 3.680572677766485*^9}}],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{
    RowBox[{"-", 
     SubscriptBox["x", "1"]}], "-", 
    SubscriptBox["x", "2"]}]], " ", 
  RowBox[{"(", 
   RowBox[{"1", "-", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      SubscriptBox["x", "2"]], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "\[Gamma]"}], ")"}]}], "+", 
    SubscriptBox["x", "2"]}], ")"}]}]], "Output",
 CellChangeTimes->{3.680572704593526*^9, 3.680572789588575*^9}],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{
    RowBox[{"-", 
     SubscriptBox["x", "1"]}], "-", 
    SubscriptBox["x", "2"]}]], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", "1"}], "+", 
    SuperscriptBox["\[ExponentialE]", 
     SubscriptBox["x", "1"]], "+", 
    SubscriptBox["x", "2"]}], ")"}]}]], "Output",
 CellChangeTimes->{3.680572704593526*^9, 3.6805727896094007`*^9}],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{
    RowBox[{"-", 
     SubscriptBox["x", "1"]}], "-", 
    SubscriptBox["x", "2"]}]], " ", 
  SubscriptBox["x", "2"]}]], "Output",
 CellChangeTimes->{3.680572704593526*^9, 3.6805727896216803`*^9}]
}, Open  ]]
},
WindowSize->{1280, 774},
WindowMargins->{{-1280, Automatic}, {-340, Automatic}},
PrivateNotebookOptions->{"VersionedStylesheet"->{"Default.nb"[8.] -> False}},
Magnification:>1.25 Inherited,
FrontEndVersion->"10.3 for Mac OS X x86 (32-bit, 64-bit Kernel) (December 10, \
2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 7432, 200, 252, "Input"],
Cell[CellGroupData[{
Cell[8015, 224, 349, 10, 57, "Input"],
Cell[8367, 236, 94, 1, 35, "Output"],
Cell[8464, 239, 229, 6, 46, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8730, 250, 311, 8, 36, "Input"],
Cell[9044, 260, 306, 9, 46, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9387, 274, 397, 11, 36, "Input"],
Cell[9787, 287, 254, 7, 46, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10078, 299, 1144, 29, 57, "Input"],
Cell[11225, 330, 485, 12, 35, "Output"],
Cell[11713, 344, 610, 17, 58, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12360, 366, 1046, 33, 57, "Input"],
Cell[13409, 401, 258, 7, 36, "Output"],
Cell[13670, 410, 92, 1, 35, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13799, 416, 451, 14, 36, "Input"],
Cell[14253, 432, 227, 6, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14517, 443, 774, 25, 78, "Input"],
Cell[15294, 470, 171, 3, 35, "Output"],
Cell[15468, 475, 249, 6, 36, "Output"],
Cell[15720, 483, 470, 14, 41, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[16227, 502, 409, 11, 36, "Input"],
Cell[16639, 515, 823, 25, 41, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[17499, 545, 441, 12, 36, "Input"],
Cell[17943, 559, 236, 5, 68, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[18216, 569, 833, 26, 57, "Input"],
Cell[19052, 597, 664, 21, 41, "Output"],
Cell[19719, 620, 440, 14, 36, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[20196, 639, 962, 29, 57, "Input"],
Cell[21161, 670, 442, 13, 41, "Output"],
Cell[21606, 685, 401, 12, 41, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[22044, 702, 1103, 34, 36, "Input"],
Cell[23150, 738, 452, 10, 29, "Message"],
Cell[23605, 750, 1000, 31, 43, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[24642, 786, 1503, 45, 78, "Input"],
Cell[26148, 833, 501, 16, 41, "Output"],
Cell[26652, 851, 413, 13, 41, "Output"],
Cell[27068, 866, 269, 8, 36, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
