(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     99317,       2795]
NotebookOptionsPosition[     94998,       2649]
NotebookOutlinePosition[     95464,       2667]
CellTagsIndexPosition[     95421,       2664]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"F", ",", "G", ",", "p", ",", "R", ",", "Cost"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"F", "[", 
    RowBox[{"a_", ",", "r_", ",", "\[Mu]_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"F", "[", 
     RowBox[{"a", ",", "r", ",", "\[Mu]"}], "]"}], "=", 
    TagBox[GridBox[{
       {"\[Piecewise]", GridBox[{
          {
           RowBox[{"1", "-", 
            RowBox[{
             UnderoverscriptBox["\[Sum]", 
              RowBox[{"i", "=", "0"}], 
              RowBox[{"r", "-", "1"}]], 
             RowBox[{
              FractionBox["1", 
               RowBox[{"i", "!"}]], "*", 
              SuperscriptBox[
               RowBox[{"(", 
                FractionBox["a", "\[Mu]"], ")"}], "i"], "*", 
              RowBox[{"Exp", "[", 
               FractionBox[
                RowBox[{"-", "a"}], "\[Mu]"], "]"}]}]}]}], 
           RowBox[{"a", ">", "0"}]},
          {"0", 
           RowBox[{"a", "\[Equal]", "0"}]}
         },
         AllowedDimensions->{2, Automatic},
         Editable->True,
         GridBoxAlignment->{
          "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxItemSize->{
          "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{1.}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.84]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}},
         Selectable->True]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
        "RowsIndexed" -> {}},
      GridBoxItemSize->{
       "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.35]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     "Piecewise",
     DeleteWithContents->True,
     Editable->False,
     SelectWithContents->True,
     Selectable->False]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"p", "[", 
    RowBox[{"a_", ",", "k_", ",", "j_", ",", "\[Mu]_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"p", "[", 
     RowBox[{"a", ",", "k", ",", "j", ",", "\[Mu]"}], "]"}], "=", 
    TagBox[GridBox[{
       {"\[Piecewise]", GridBox[{
          {
           RowBox[{"Boole", "[", 
            RowBox[{"j", "\[Equal]", "1"}], "]"}], 
           RowBox[{"k", "\[Equal]", "0"}]},
          {
           RowBox[{"F", "[", 
            RowBox[{"a", ",", "k", ",", "\[Mu]"}], "]"}], 
           RowBox[{
            RowBox[{"k", "\[GreaterEqual]", "1"}], "&&", 
            RowBox[{"j", "\[Equal]", "1"}]}]},
          {
           RowBox[{
            RowBox[{"F", "[", 
             RowBox[{"a", ",", 
              RowBox[{"k", "-", "j", "+", "1"}], ",", "\[Mu]"}], "]"}], "-", 
            RowBox[{"F", "[", 
             RowBox[{"a", ",", 
              RowBox[{"k", "-", "j", "+", "2"}], ",", "\[Mu]"}], "]"}]}], 
           RowBox[{
            RowBox[{"k", "\[GreaterEqual]", "2"}], "&&", 
            RowBox[{"2", "\[LessEqual]", "j"}], "&&", 
            RowBox[{"j", "\[LessEqual]", "k"}]}]},
          {
           RowBox[{"1", "-", 
            RowBox[{"F", "[", 
             RowBox[{"a", ",", "1", ",", "\[Mu]"}], "]"}]}], 
           RowBox[{
            RowBox[{"k", "\[GreaterEqual]", "1"}], "&&", 
            RowBox[{"j", "\[Equal]", 
             RowBox[{"(", 
              RowBox[{"k", "+", "1"}], ")"}]}]}]}
         },
         AllowedDimensions->{2, Automatic},
         Editable->True,
         GridBoxAlignment->{
          "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxItemSize->{
          "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{1.}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.84]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}},
         Selectable->True]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
        "RowsIndexed" -> {}},
      GridBoxItemSize->{
       "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.35]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     "Piecewise",
     DeleteWithContents->True,
     Editable->False,
     SelectWithContents->True,
     Selectable->False]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"G", "[", 
    RowBox[{"a_", ",", "r_", ",", "\[Mu]_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"G", "[", 
     RowBox[{"a", ",", "r", ",", "\[Mu]"}], "]"}], "=", 
    TagBox[GridBox[{
       {"\[Piecewise]", GridBox[{
          {
           FractionBox[
            RowBox[{"\[Mu]", "*", "r", "*", 
             RowBox[{"F", "[", 
              RowBox[{"a", ",", 
               RowBox[{"r", "+", "1"}], ",", "\[Mu]"}], "]"}]}], 
            RowBox[{"F", "[", 
             RowBox[{"a", ",", "r", ",", "\[Mu]"}], "]"}]], 
           RowBox[{"a", ">", "0"}]},
          {"0", 
           RowBox[{"a", "\[Equal]", "0"}]}
         },
         AllowedDimensions->{2, Automatic},
         Editable->True,
         GridBoxAlignment->{
          "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxItemSize->{
          "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{1.}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.84]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}},
         Selectable->True]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
        "RowsIndexed" -> {}},
      GridBoxItemSize->{
       "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.35]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     "Piecewise",
     DeleteWithContents->True,
     Editable->False,
     SelectWithContents->True,
     Selectable->False]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"R", "[", 
    RowBox[{"a_", ",", "k_", ",", "j_", ",", "\[Gamma]_", ",", "\[Mu]_"}], 
    "]"}], ":=", 
   RowBox[{
    RowBox[{"R", "[", 
     RowBox[{"a", ",", "k", ",", "j", ",", "\[Gamma]", ",", "\[Mu]"}], "]"}], 
    "=", 
    TagBox[GridBox[{
       {"\[Piecewise]", GridBox[{
          {
           RowBox[{"\[Gamma]", "*", "a"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"k", "\[Equal]", "0"}], "||", 
             RowBox[{"k", "\[Equal]", "1"}]}], ")"}]},
          {
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "\[Gamma]"}], ")"}], "*", 
             FractionBox[
              RowBox[{
               RowBox[{"G", "[", 
                RowBox[{"a", ",", "k", ",", "\[Mu]"}], "]"}], "*", 
               RowBox[{"(", 
                RowBox[{"k", "-", "1"}], ")"}]}], "2"]}], "+", 
            RowBox[{"\[Gamma]", "*", "a"}]}], 
           RowBox[{
            RowBox[{"k", "\[GreaterEqual]", "2"}], "&&", 
            RowBox[{"j", "\[Equal]", "1"}]}]},
          {
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "\[Gamma]"}], ")"}], "*", 
             FractionBox[
              RowBox[{"a", "*", 
               RowBox[{"(", 
                RowBox[{"k", "+", "j", "-", "3"}], ")"}]}], "2"]}], "+", 
            RowBox[{"\[Gamma]", "*", "a"}]}], 
           RowBox[{
            RowBox[{"k", "\[GreaterEqual]", "2"}], "&&", 
            RowBox[{"2", "\[LessEqual]", "j"}], "&&", 
            RowBox[{"j", "\[LessEqual]", 
             RowBox[{"k", "+", "1"}]}]}]}
         },
         AllowedDimensions->{2, Automatic},
         Editable->True,
         GridBoxAlignment->{
          "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxItemSize->{
          "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{1.}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.84]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}},
         Selectable->True]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
        "RowsIndexed" -> {}},
      GridBoxItemSize->{
       "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.35]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     "Piecewise",
     DeleteWithContents->True,
     Editable->False,
     SelectWithContents->True,
     Selectable->False]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Cost", "[", 
    RowBox[{"a_", ",", "n_", ",", "k_", ",", "\[Gamma]_", ",", "\[Mu]_"}], 
    "]"}], ":=", 
   RowBox[{
    RowBox[{"Cost", "[", 
     RowBox[{"a", ",", "n", ",", "k", ",", "\[Gamma]", ",", "\[Mu]"}], "]"}], 
    "=", 
    RowBox[{
     UnderoverscriptBox["\[Sum]", 
      RowBox[{"j", "=", "1"}], 
      RowBox[{"k", "+", "1"}]], 
     RowBox[{
      RowBox[{"p", "[", 
       RowBox[{"a", ",", "k", ",", "j", ",", "\[Mu]"}], "]"}], "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"R", "[", 
         RowBox[{"a", ",", "k", ",", "j", ",", "\[Gamma]", ",", "\[Mu]"}], 
         "]"}], "+", 
        RowBox[{"OptimalCost", "[", 
         RowBox[{
          RowBox[{"n", "-", "1"}], ",", "j", ",", "\[Gamma]", ",", "\[Mu]"}], 
         "]"}]}], ")"}]}]}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.669940990429265*^9, 3.669940992349835*^9}, {
   3.669941042398069*^9, 3.669941159981086*^9}, {3.67011874232135*^9, 
   3.67011874789062*^9}, 3.670119420755623*^9, {3.670119504506112*^9, 
   3.6701195075542107`*^9}, {3.670122774332747*^9, 3.670122816205921*^9}, {
   3.670125565768889*^9, 3.670125566914225*^9}, {3.6701258209150352`*^9, 
   3.670125849939736*^9}, {3.6701260967364492`*^9, 3.6701261115096273`*^9}, {
   3.670127577952091*^9, 3.6701275929497643`*^9}, {3.670539905606686*^9, 
   3.670539954188632*^9}, {3.670540023646208*^9, 3.670540029089903*^9}, {
   3.680854203011239*^9, 3.6808542692845984`*^9}, {3.680854352688651*^9, 
   3.680854379695271*^9}, {3.680854423313044*^9, 3.680854454011541*^9}, {
   3.6808546692418127`*^9, 3.680854718922879*^9}, {3.680854787536099*^9, 
   3.680855026300568*^9}, {3.68085666129111*^9, 3.680856667837531*^9}, {
   3.6809460100630283`*^9, 3.680946030860652*^9}, {3.680946107207241*^9, 
   3.680946162775567*^9}, {3.680946285640839*^9, 3.680946286904187*^9}, {
   3.6809463232793303`*^9, 3.680946339002398*^9}, {3.6809464379122763`*^9, 
   3.680946472601396*^9}, {3.680946640915572*^9, 3.680946642038453*^9}, {
   3.680946693917694*^9, 3.680946711345537*^9}, {3.680946966227248*^9, 
   3.6809469710655622`*^9}, {3.683869767413789*^9, 3.683869778742872*^9}, {
   3.68387002937289*^9, 3.683870086059393*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"$Assumptions", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"k", "\[Element]", "Integers"}], ",", 
     RowBox[{"a", "\[GreaterEqual]", "0"}], ",", 
     RowBox[{"k", "\[GreaterEqual]", "0"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   UnderoverscriptBox["\[Sum]", 
    RowBox[{"j", "=", "1"}], 
    RowBox[{"k", "+", "1"}]], 
   RowBox[{"p", "[", 
    RowBox[{"a", ",", "k", ",", "j", ",", "\[Mu]"}], "]"}]}], "//", 
  "FullSimplify"}]}], "Input",
 CellChangeTimes->{{3.683870136699054*^9, 3.6838702268102427`*^9}, 
   3.6838733555306396`*^9}],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{{3.683870155730962*^9, 3.683870184222542*^9}, 
   3.683870231437426*^9, 3.683873357821665*^9, 3.68387339103296*^9, 
   3.683877490158502*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Cost", "[", 
  RowBox[{"a", ",", "n", ",", "0", ",", "\[Gamma]", ",", "\[Mu]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.68387024620439*^9, 3.6838702581364326`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"a", " ", "\[Gamma]"}], "+", 
  RowBox[{"OptimalCost", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "1"}], "+", "n"}], ",", "1", ",", "\[Gamma]", ",", 
    "\[Mu]"}], "]"}]}]], "Output",
 CellChangeTimes->{
  3.6838702604886723`*^9, {3.683873363824422*^9, 3.6838733934054327`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Cost", "[", 
  RowBox[{"0", ",", "n", ",", "1", ",", "\[Gamma]", ",", "\[Mu]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$Assumptions", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"k", "\[Element]", "Integers"}], ",", 
     RowBox[{"a", ">", "0"}], ",", 
     RowBox[{"k", "\[GreaterEqual]", "0"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Cost", "[", 
   RowBox[{"a", ",", "n", ",", "1", ",", "\[Gamma]", ",", "\[Mu]"}], "]"}], "//",
   "FullSimplify"}]}], "Input",
 CellChangeTimes->{{3.683870274828155*^9, 3.683870283211694*^9}, {
  3.683873399303278*^9, 3.6838734541563272`*^9}, {3.6838735399166*^9, 
  3.683873567905601*^9}}],

Cell[BoxData[
 RowBox[{"OptimalCost", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"-", "1"}], "+", "n"}], ",", "2", ",", "\[Gamma]", ",", "\[Mu]"}],
   "]"}]], "Output",
 CellChangeTimes->{
  3.683870284266329*^9, {3.683873396540745*^9, 3.683873455836165*^9}, {
   3.683873553321446*^9, 3.683873568492877*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"a", " ", "\[Gamma]"}], "+", 
  RowBox[{"OptimalCost", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "1"}], "+", "n"}], ",", "1", ",", "\[Gamma]", ",", 
    "\[Mu]"}], "]"}], "+", 
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"-", 
     FractionBox["a", "\[Mu]"]}]], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"OptimalCost", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "1"}], "+", "n"}], ",", "1", ",", "\[Gamma]", ",", 
        "\[Mu]"}], "]"}]}], "+", 
     RowBox[{"OptimalCost", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "1"}], "+", "n"}], ",", "2", ",", "\[Gamma]", ",", 
       "\[Mu]"}], "]"}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.683870284266329*^9, {3.683873396540745*^9, 3.683873455836165*^9}, {
   3.683873553321446*^9, 3.6838735685040083`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"Cost", "[", 
        RowBox[{"a", ",", "n", ",", "1", ",", "\[Gamma]", ",", "\[Mu]"}], 
        "]"}], ",", "a"}], "]"}], "\[Equal]", "0"}], "//", "FullSimplify"}], 
   ",", "a"}], "]"}]], "Input",
 CellChangeTimes->{{3.683873460958143*^9, 3.683873522466167*^9}, {
  3.6838735763696003`*^9, 3.6838735771457376`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"a", "\[Rule]", 
    RowBox[{"ConditionalExpression", "[", 
     RowBox[{
      RowBox[{"\[Mu]", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Pi]", " ", 
          RowBox[{"C", "[", "1", "]"}]}], "+", 
         RowBox[{"Log", "[", 
          FractionBox[
           RowBox[{
            RowBox[{"-", 
             RowBox[{"OptimalCost", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "1"}], "+", "n"}], ",", "1", ",", "\[Gamma]", 
               ",", "\[Mu]"}], "]"}]}], "+", 
            RowBox[{"OptimalCost", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "1"}], "+", "n"}], ",", "2", ",", "\[Gamma]", ",",
               "\[Mu]"}], "]"}]}], 
           RowBox[{"\[Gamma]", " ", "\[Mu]"}]], "]"}]}], ")"}]}], ",", 
      RowBox[{
       RowBox[{"C", "[", "1", "]"}], "\[Element]", "Integers"}]}], "]"}]}], 
   "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.6838734713684673`*^9, 3.683873522975751*^9}, {
  3.683873557959978*^9, 3.6838735776541452`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"Cost", "[", 
      RowBox[{"a", ",", "n", ",", "1", ",", "\[Gamma]", ",", "\[Mu]"}], "]"}],
      ",", "a"}], "]"}], "/.", 
   RowBox[{"{", 
    RowBox[{"a", "\[Rule]", 
     RowBox[{"\[Mu]", "*", 
      RowBox[{"Log", "[", 
       FractionBox[
        RowBox[{
         RowBox[{"OptimalCost", "[", 
          RowBox[{
           RowBox[{"n", "-", "1"}], ",", "2", ",", "\[Gamma]", ",", "\[Mu]"}],
           "]"}], "-", 
         RowBox[{"OptimalCost", "[", 
          RowBox[{
           RowBox[{"n", "-", "1"}], ",", "1", ",", "\[Gamma]", ",", "\[Mu]"}],
           "]"}]}], 
        RowBox[{"\[Gamma]", "*", "\[Mu]"}]], "]"}]}]}], "}"}]}], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.683873583084527*^9, 3.6838736854725637`*^9}}],

Cell[BoxData[
 TagBox[GridBox[{
    {"\[Piecewise]", GridBox[{
       {"Indeterminate", 
        RowBox[{
         RowBox[{"\[Mu]", " ", 
          RowBox[{"Log", "[", 
           FractionBox[
            RowBox[{
             RowBox[{"-", 
              RowBox[{"OptimalCost", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "1"}], "+", "n"}], ",", "1", ",", "\[Gamma]", 
                ",", "\[Mu]"}], "]"}]}], "+", 
             RowBox[{"OptimalCost", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "1"}], "+", "n"}], ",", "2", ",", "\[Gamma]", 
               ",", "\[Mu]"}], "]"}]}], 
            RowBox[{"\[Gamma]", " ", "\[Mu]"}]], "]"}]}], "\[Equal]", "0"}]},
       {"0", 
        RowBox[{
         RowBox[{"\[Mu]", " ", 
          RowBox[{"Log", "[", 
           FractionBox[
            RowBox[{
             RowBox[{"-", 
              RowBox[{"OptimalCost", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "1"}], "+", "n"}], ",", "1", ",", "\[Gamma]", 
                ",", "\[Mu]"}], "]"}]}], "+", 
             RowBox[{"OptimalCost", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "1"}], "+", "n"}], ",", "2", ",", "\[Gamma]", 
               ",", "\[Mu]"}], "]"}]}], 
            RowBox[{"\[Gamma]", " ", "\[Mu]"}]], "]"}]}], ">", "0"}]},
       {"\[Gamma]", 
        TagBox["True",
         "PiecewiseDefault",
         AutoDelete->True]}
      },
      AllowedDimensions->{2, Automatic},
      Editable->True,
      GridBoxAlignment->{
       "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
        "RowsIndexed" -> {}},
      GridBoxItemSize->{
       "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.84]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}},
      Selectable->True]}
   },
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}},
   GridBoxItemSize->{
    "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
     "RowsIndexed" -> {}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.35]}, 
       Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}, "RowsIndexed" -> {}}],
  "Piecewise",
  DeleteWithContents->True,
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellChangeTimes->{{3.683873678806086*^9, 3.68387368636486*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Cost", "[", 
    RowBox[{"a", ",", "n", ",", "1", ",", "\[Gamma]", ",", "\[Mu]"}], "]"}], "/.", 
   RowBox[{"{", 
    RowBox[{"a", "\[Rule]", 
     RowBox[{"\[Mu]", "*", 
      RowBox[{"Log", "[", 
       FractionBox[
        RowBox[{
         RowBox[{"OptimalCost", "[", 
          RowBox[{
           RowBox[{"n", "-", "1"}], ",", "2", ",", "\[Gamma]", ",", "\[Mu]"}],
           "]"}], "-", 
         RowBox[{"OptimalCost", "[", 
          RowBox[{
           RowBox[{"n", "-", "1"}], ",", "1", ",", "\[Gamma]", ",", "\[Mu]"}],
           "]"}]}], 
        RowBox[{"\[Gamma]", "*", "\[Mu]"}]], "]"}]}]}], "}"}]}], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.683873748207296*^9, 3.683873757569018*^9}}],

Cell[BoxData[
 TagBox[GridBox[{
    {"\[Piecewise]", GridBox[{
       {
        RowBox[{
         RowBox[{"\[Gamma]", " ", "\[Mu]", " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"Log", "[", 
             FractionBox[
              RowBox[{
               RowBox[{"-", 
                RowBox[{"OptimalCost", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "n"}], ",", "1", ",", "\[Gamma]", 
                  ",", "\[Mu]"}], "]"}]}], "+", 
               RowBox[{"OptimalCost", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "n"}], ",", "2", ",", "\[Gamma]", 
                 ",", "\[Mu]"}], "]"}]}], 
              RowBox[{"\[Gamma]", " ", "\[Mu]"}]], "]"}]}], ")"}]}], "+", 
         RowBox[{"OptimalCost", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "1"}], "+", "n"}], ",", "1", ",", "\[Gamma]", ",", 
           "\[Mu]"}], "]"}]}], 
        RowBox[{
         RowBox[{"\[Mu]", " ", 
          RowBox[{"Log", "[", 
           FractionBox[
            RowBox[{
             RowBox[{"-", 
              RowBox[{"OptimalCost", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "1"}], "+", "n"}], ",", "1", ",", "\[Gamma]", 
                ",", "\[Mu]"}], "]"}]}], "+", 
             RowBox[{"OptimalCost", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "1"}], "+", "n"}], ",", "2", ",", "\[Gamma]", 
               ",", "\[Mu]"}], "]"}]}], 
            RowBox[{"\[Gamma]", " ", "\[Mu]"}]], "]"}]}], ">", "0"}]},
       {
        RowBox[{
         RowBox[{"\[Gamma]", " ", "\[Mu]", " ", 
          RowBox[{"Log", "[", 
           FractionBox[
            RowBox[{
             RowBox[{"-", 
              RowBox[{"OptimalCost", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "1"}], "+", "n"}], ",", "1", ",", "\[Gamma]", 
                ",", "\[Mu]"}], "]"}]}], "+", 
             RowBox[{"OptimalCost", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "1"}], "+", "n"}], ",", "2", ",", "\[Gamma]", 
               ",", "\[Mu]"}], "]"}]}], 
            RowBox[{"\[Gamma]", " ", "\[Mu]"}]], "]"}]}], "+", 
         RowBox[{"OptimalCost", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "1"}], "+", "n"}], ",", "2", ",", "\[Gamma]", ",", 
           "\[Mu]"}], "]"}]}], 
        TagBox["True",
         "PiecewiseDefault",
         AutoDelete->True]}
      },
      AllowedDimensions->{2, Automatic},
      Editable->True,
      GridBoxAlignment->{
       "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
        "RowsIndexed" -> {}},
      GridBoxItemSize->{
       "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.84]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}},
      Selectable->True]}
   },
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}},
   GridBoxItemSize->{
    "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
     "RowsIndexed" -> {}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.35]}, 
       Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}, "RowsIndexed" -> {}}],
  "Piecewise",
  DeleteWithContents->True,
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellChangeTimes->{{3.683873753648992*^9, 3.683873759051146*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Cost", "[", 
   RowBox[{"a", ",", "n", ",", "2", ",", "\[Gamma]", ",", "\[Mu]"}], "]"}], "//",
   "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.683873805750498*^9, 3.68387381811198*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "\[Mu]"], 
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"-", 
     FractionBox["a", "\[Mu]"]}]], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       RowBox[{"(", 
        RowBox[{"a", "+", "\[Mu]", "-", 
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"a", "/", "\[Mu]"}]], " ", "\[Mu]"}]}], ")"}]}], " ", 
      RowBox[{"OptimalCost", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "1"}], "+", "n"}], ",", "1", ",", "\[Gamma]", ",", 
        "\[Mu]"}], "]"}]}], "+", 
     RowBox[{"a", " ", 
      RowBox[{"OptimalCost", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "1"}], "+", "n"}], ",", "2", ",", "\[Gamma]", ",", 
        "\[Mu]"}], "]"}]}], "+", 
     RowBox[{"\[Mu]", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "\[Gamma]"}], ")"}], " ", "\[Mu]"}], "+", 
        
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"a", "/", "\[Mu]"}]], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"a", " ", "\[Gamma]"}], "+", "\[Mu]", "-", 
           RowBox[{"\[Gamma]", " ", "\[Mu]"}]}], ")"}]}], "+", 
        RowBox[{"OptimalCost", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ",", "3", ",", "\[Gamma]", ",", 
          "\[Mu]"}], "]"}]}], ")"}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.683873813742324*^9, 3.683873819466494*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"Cost", "[", 
     RowBox[{"a", ",", "n", ",", "2", ",", "\[Gamma]", ",", "\[Mu]"}], "]"}], 
    ",", "a"}], "]"}], "//", "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.6838738272300577`*^9, 3.683873835510809*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"-", 
     FractionBox["a", "\[Mu]"]}]], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"a", " ", 
      RowBox[{"OptimalCost", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "1"}], "+", "n"}], ",", "1", ",", "\[Gamma]", ",", 
        "\[Mu]"}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "a"}], "+", "\[Mu]"}], ")"}], " ", 
      RowBox[{"OptimalCost", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "1"}], "+", "n"}], ",", "2", ",", "\[Gamma]", ",", 
        "\[Mu]"}], "]"}]}], "+", 
     RowBox[{"\[Mu]", " ", 
      RowBox[{"(", 
       RowBox[{"\[Mu]", "-", 
        RowBox[{"\[Gamma]", " ", "\[Mu]"}], "+", 
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"a", "/", "\[Mu]"}]], " ", "\[Gamma]", " ", "\[Mu]"}], "-", 
        
        RowBox[{"OptimalCost", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ",", "3", ",", "\[Gamma]", ",", 
          "\[Mu]"}], "]"}]}], ")"}]}]}], ")"}]}], 
  SuperscriptBox["\[Mu]", "2"]]], "Output",
 CellChangeTimes->{3.6838738369790783`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"Cost", "[", 
         RowBox[{"a", ",", "n", ",", "2", ",", "\[Gamma]", ",", "1"}], "]"}], 
        ",", "a"}], "]"}], "\[Equal]", "0"}], "//", "FullSimplify"}], ",", 
    "a"}], "]"}], "//", "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.683873842309018*^9, 3.683873905580731*^9}, {
  3.683874049839918*^9, 3.683874051269009*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Solve", "::", "ifun"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Inverse functions are being used by \
\[NoBreak]\\!\\(\\*RowBox[{\\\"Solve\\\"}]\\)\[NoBreak], so some solutions \
may not be found; use Reduce for complete solution information. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/Solve/ifun\\\", \
ButtonNote -> \\\"Solve::ifun\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{{3.6838738563688297`*^9, 3.683873905974519*^9}, 
   3.683874057827579*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"a", "\[Rule]", 
    RowBox[{
     FractionBox[
      RowBox[{
       RowBox[{"-", "1"}], "+", "\[Gamma]", "-", 
       RowBox[{"OptimalCost", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "1"}], "+", "n"}], ",", "2", ",", "\[Gamma]", ",", 
         "1"}], "]"}], "+", 
       RowBox[{"OptimalCost", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "1"}], "+", "n"}], ",", "3", ",", "\[Gamma]", ",", 
         "1"}], "]"}]}], 
      RowBox[{
       RowBox[{"OptimalCost", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "1"}], "+", "n"}], ",", "1", ",", "\[Gamma]", ",", 
         "1"}], "]"}], "-", 
       RowBox[{"OptimalCost", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "1"}], "+", "n"}], ",", "2", ",", "\[Gamma]", ",", 
         "1"}], "]"}]}]], "-", 
     RowBox[{"ProductLog", "[", 
      FractionBox[
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         FractionBox[
          RowBox[{
           RowBox[{"-", "1"}], "+", "\[Gamma]", "-", 
           RowBox[{"OptimalCost", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "1"}], "+", "n"}], ",", "2", ",", "\[Gamma]", ",", 
             "1"}], "]"}], "+", 
           RowBox[{"OptimalCost", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "1"}], "+", "n"}], ",", "3", ",", "\[Gamma]", ",", 
             "1"}], "]"}]}], 
          RowBox[{
           RowBox[{"OptimalCost", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "1"}], "+", "n"}], ",", "1", ",", "\[Gamma]", ",", 
             "1"}], "]"}], "-", 
           RowBox[{"OptimalCost", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "1"}], "+", "n"}], ",", "2", ",", "\[Gamma]", ",", 
             "1"}], "]"}]}]]], " ", "\[Gamma]"}], 
       RowBox[{
        RowBox[{"OptimalCost", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ",", "1", ",", "\[Gamma]", ",", 
          "1"}], "]"}], "-", 
        RowBox[{"OptimalCost", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ",", "2", ",", "\[Gamma]", ",", 
          "1"}], "]"}]}]], "]"}]}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.6838738563892117`*^9, 3.683873906857115*^9}, 
   3.683874058392808*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Cost", "[", 
   RowBox[{"a", ",", "n", ",", "3", ",", "\[Gamma]", ",", "\[Mu]"}], "]"}], "//",
   "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.6838739321564837`*^9, 3.6838739390365067`*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"2", " ", 
    SuperscriptBox["\[Mu]", "2"]}]], 
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"-", 
     FractionBox["a", "\[Mu]"]}]], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["a", "2"], "+", 
         RowBox[{"2", " ", "a", " ", "\[Mu]"}], "-", 
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{"a", "/", "\[Mu]"}]]}], ")"}], " ", 
          SuperscriptBox["\[Mu]", "2"]}]}], ")"}]}], " ", 
      RowBox[{"OptimalCost", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "1"}], "+", "n"}], ",", "1", ",", "\[Gamma]", ",", 
        "\[Mu]"}], "]"}]}], "+", 
     RowBox[{
      SuperscriptBox["a", "2"], " ", 
      RowBox[{"OptimalCost", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "1"}], "+", "n"}], ",", "2", ",", "\[Gamma]", ",", 
        "\[Mu]"}], "]"}]}], "+", 
     RowBox[{"2", " ", "\[Mu]", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"a", " ", 
         RowBox[{"OptimalCost", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "1"}], "+", "n"}], ",", "3", ",", "\[Gamma]", ",", 
           "\[Mu]"}], "]"}]}], "+", 
        RowBox[{"\[Mu]", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "\[Gamma]"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"a", "+", 
              RowBox[{"3", " ", "\[Mu]"}]}], ")"}]}], "+", 
           RowBox[{
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{"a", "/", "\[Mu]"}]], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"a", " ", "\[Gamma]"}], "+", 
              RowBox[{"3", " ", "\[Mu]"}], "-", 
              RowBox[{"3", " ", "\[Gamma]", " ", "\[Mu]"}]}], ")"}]}], "+", 
           RowBox[{"OptimalCost", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "1"}], "+", "n"}], ",", "4", ",", "\[Gamma]", ",", 
             "\[Mu]"}], "]"}]}], ")"}]}]}], ")"}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.683873941166503*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"Cost", "[", 
     RowBox[{"a", ",", "n", ",", "3", ",", "\[Gamma]", ",", "\[Mu]"}], "]"}], 
    ",", "a"}], "]"}], "//", "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.68387394695026*^9, 3.683873955547855*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"2", " ", 
    SuperscriptBox["\[Mu]", "3"]}]], 
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"-", 
     FractionBox["a", "\[Mu]"]}]], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox["a", "2"], " ", 
      RowBox[{"OptimalCost", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "1"}], "+", "n"}], ",", "1", ",", "\[Gamma]", ",", 
        "\[Mu]"}], "]"}]}], "-", 
     RowBox[{"a", " ", 
      RowBox[{"(", 
       RowBox[{"a", "-", 
        RowBox[{"2", " ", "\[Mu]"}]}], ")"}], " ", 
      RowBox[{"OptimalCost", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "1"}], "+", "n"}], ",", "2", ",", "\[Gamma]", ",", 
        "\[Mu]"}], "]"}]}], "+", 
     RowBox[{"2", " ", "\[Mu]", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "a"}], "+", "\[Mu]"}], ")"}], " ", 
         RowBox[{"OptimalCost", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "1"}], "+", "n"}], ",", "3", ",", "\[Gamma]", ",", 
           "\[Mu]"}], "]"}]}], "+", 
        RowBox[{"\[Mu]", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{"a", "/", "\[Mu]"}]], " ", "\[Gamma]", " ", "\[Mu]"}], 
           "-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "\[Gamma]"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"a", "+", 
              RowBox[{"2", " ", "\[Mu]"}]}], ")"}]}], "-", 
           RowBox[{"OptimalCost", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "1"}], "+", "n"}], ",", "4", ",", "\[Gamma]", ",", 
             "\[Mu]"}], "]"}]}], ")"}]}]}], ")"}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.6838739575817966`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Reduce", "[", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"Cost", "[", 
       RowBox[{"a", ",", "n", ",", "3", ",", "\[Gamma]", ",", "\[Mu]"}], 
       "]"}], ",", "a"}], "]"}], "\[Equal]", "0"}], "]"}], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.683874000713725*^9, 3.68387403651593*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Reduce", "::", "nsmet"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"This system cannot be solved with the methods available to \
Reduce. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/Reduce\\\", ButtonNote -> \
\\\"Reduce::nsmet\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{{3.683874031307563*^9, 3.683874037054605*^9}}],

Cell[BoxData[
 RowBox[{"Reduce", "[", 
  RowBox[{
   RowBox[{
    FractionBox["1", "\[Mu]"], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["a", "2"], " ", 
       RowBox[{"OptimalCost", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "1"}], "+", "n"}], ",", "1", ",", "\[Gamma]", ",", 
         "\[Mu]"}], "]"}]}], "-", 
      RowBox[{"a", " ", 
       RowBox[{"(", 
        RowBox[{"a", "-", 
         RowBox[{"2", " ", "\[Mu]"}]}], ")"}], " ", 
       RowBox[{"OptimalCost", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "1"}], "+", "n"}], ",", "2", ",", "\[Gamma]", ",", 
         "\[Mu]"}], "]"}]}], "+", 
      RowBox[{"2", " ", "\[Mu]", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "a"}], "+", "\[Mu]"}], ")"}], " ", 
          RowBox[{"OptimalCost", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "1"}], "+", "n"}], ",", "3", ",", "\[Gamma]", ",", 
            "\[Mu]"}], "]"}]}], "+", 
         RowBox[{"\[Mu]", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"a", "/", "\[Mu]"}]], " ", "\[Gamma]", " ", "\[Mu]"}], 
            "-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "\[Gamma]"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{"a", "+", 
               RowBox[{"2", " ", "\[Mu]"}]}], ")"}]}], "-", 
            RowBox[{"OptimalCost", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "1"}], "+", "n"}], ",", "4", ",", "\[Gamma]", ",",
               "\[Mu]"}], "]"}]}], ")"}]}]}], ")"}]}]}], ")"}]}], "\[Equal]", 
   "0"}], "]"}]], "Output",
 CellChangeTimes->{{3.6838740313307734`*^9, 3.683874039080309*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"Cost", "[", 
        RowBox[{"a", ",", "n", ",", "3", ",", "\[Gamma]", ",", "\[Mu]"}], 
        "]"}], ",", "a"}], "]"}], "\[Equal]", "0"}], "//", "FullSimplify"}], 
   ",", "a"}], "]"}]], "Input",
 CellChangeTimes->{{3.6838739654124126`*^9, 3.683873981222802*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Solve", "::", "nsmet"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"This system cannot be solved with the methods available to \
Solve. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/Solve\\\", ButtonNote -> \
\\\"Solve::nsmet\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.68387398317034*^9}],

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     FractionBox["1", "\[Mu]"], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["a", "2"], " ", 
        RowBox[{"OptimalCost", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ",", "1", ",", "\[Gamma]", ",", 
          "\[Mu]"}], "]"}]}], "-", 
       RowBox[{"a", " ", 
        RowBox[{"(", 
         RowBox[{"a", "-", 
          RowBox[{"2", " ", "\[Mu]"}]}], ")"}], " ", 
        RowBox[{"OptimalCost", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ",", "2", ",", "\[Gamma]", ",", 
          "\[Mu]"}], "]"}]}], "+", 
       RowBox[{"2", " ", "\[Mu]", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "a"}], "+", "\[Mu]"}], ")"}], " ", 
           RowBox[{"OptimalCost", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "1"}], "+", "n"}], ",", "3", ",", "\[Gamma]", ",", 
             "\[Mu]"}], "]"}]}], "+", 
          RowBox[{"\[Mu]", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SuperscriptBox["\[ExponentialE]", 
               RowBox[{"a", "/", "\[Mu]"}]], " ", "\[Gamma]", " ", "\[Mu]"}], 
             "-", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "\[Gamma]"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{"a", "+", 
                RowBox[{"2", " ", "\[Mu]"}]}], ")"}]}], "-", 
             RowBox[{"OptimalCost", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "1"}], "+", "n"}], ",", "4", ",", "\[Gamma]", 
               ",", "\[Mu]"}], "]"}]}], ")"}]}]}], ")"}]}]}], ")"}]}], 
    "\[Equal]", "0"}], ",", "a"}], "]"}]], "Output",
 CellChangeTimes->{3.683873983179677*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"p", "[", 
     RowBox[{"a", ",", "k", ",", "j", ",", "1"}], "]"}], ",", "a"}], "]"}], "//",
   "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"R", "[", 
     RowBox[{"a", ",", "k", ",", "j", ",", "\[Gamma]", ",", "1"}], "]"}], ",",
     "a"}], "]"}], "//", "FullSimplify"}]}], "Input",
 CellChangeTimes->{{3.6838747485476427`*^9, 3.683874786414578*^9}}],

Cell[BoxData[
 TagBox[GridBox[{
    {"\[Piecewise]", GridBox[{
       {"0", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"j", "\[NotEqual]", "1"}], "&&", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"k", "<", "2"}], "&&", 
               RowBox[{"j", "\[NotEqual]", 
                RowBox[{"1", "+", "k"}]}]}], ")"}], "||", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"k", "<", "j"}], "&&", 
               RowBox[{"j", "<", 
                RowBox[{"1", "+", "k"}]}]}], ")"}], "||", 
             RowBox[{"j", ">", 
              RowBox[{"1", "+", "k"}]}]}], ")"}]}], ")"}], "||", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"j", "\[NotEqual]", 
            RowBox[{"1", "+", "k"}]}], "&&", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"1", "<", "j", "<", "2"}], "||", 
             RowBox[{"j", "<", "1"}]}], ")"}]}], ")"}], "||", 
         RowBox[{"k", "<", "1"}]}]},
       {
        FractionBox[
         RowBox[{
          SuperscriptBox["a", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "k"}]], " ", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"-", "a"}]]}], 
         RowBox[{"Gamma", "[", "k", "]"}]], 
        RowBox[{
         RowBox[{"k", "\[GreaterEqual]", "1"}], "&&", 
         RowBox[{"j", "\[Equal]", "1"}]}]},
       {
        RowBox[{"-", 
         FractionBox[
          RowBox[{
           SuperscriptBox["a", 
            RowBox[{
             RowBox[{"-", "j"}], "+", "k"}]], " ", 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"-", "a"}]], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "a", "+", "j", "-", "k"}], ")"}]}], 
          RowBox[{"Gamma", "[", 
           RowBox[{"2", "-", "j", "+", "k"}], "]"}]]}], 
        RowBox[{
         RowBox[{"j", "\[GreaterEqual]", "2"}], "&&", 
         RowBox[{"j", "\[LessEqual]", "k"}]}]},
       {
        RowBox[{
         RowBox[{"-", 
          RowBox[{"Cosh", "[", "a", "]"}]}], "+", 
         RowBox[{"Sinh", "[", "a", "]"}]}], 
        TagBox["True",
         "PiecewiseDefault",
         AutoDelete->True]}
      },
      AllowedDimensions->{2, Automatic},
      Editable->True,
      GridBoxAlignment->{
       "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
        "RowsIndexed" -> {}},
      GridBoxItemSize->{
       "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.84]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}},
      Selectable->True]}
   },
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}},
   GridBoxItemSize->{
    "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
     "RowsIndexed" -> {}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.35]}, 
       Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}, "RowsIndexed" -> {}}],
  "Piecewise",
  DeleteWithContents->True,
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellChangeTimes->{{3.6838747735076323`*^9, 3.683874787918043*^9}}],

Cell[BoxData[
 TagBox[GridBox[{
    {"\[Piecewise]", GridBox[{
       {"\[Gamma]", 
        RowBox[{"k", "<", "2"}]},
       {
        RowBox[{"\[Gamma]", "+", 
         FractionBox[
          RowBox[{
           SuperscriptBox["a", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "k"}]], " ", 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"-", "a"}]], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "k", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "\[Gamma]"}], ")"}], " ", 
           RowBox[{"Gamma", "[", "k", "]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "a"}], "+", "k"}], ")"}], " ", 
              RowBox[{"Gamma", "[", "k", "]"}]}], "+", 
             RowBox[{"a", " ", 
              RowBox[{"Gamma", "[", 
               RowBox[{"k", ",", "a"}], "]"}]}], "-", 
             RowBox[{"Gamma", "[", 
              RowBox[{
               RowBox[{"1", "+", "k"}], ",", "a"}], "]"}]}], ")"}]}], 
          RowBox[{"2", " ", 
           RowBox[{"k", "!"}], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Gamma", "[", "k", "]"}], "-", 
              RowBox[{"Gamma", "[", 
               RowBox[{"k", ",", "a"}], "]"}]}], ")"}], "2"]}]]}], 
        RowBox[{
         RowBox[{"k", "\[GreaterEqual]", "2"}], "&&", 
         RowBox[{"j", "\[Equal]", "1"}]}]},
       {
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "3"}], "+", "j", "+", "k", "-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "5"}], "+", "j", "+", "k"}], ")"}], " ", 
            "\[Gamma]"}]}], ")"}]}], 
        RowBox[{
         RowBox[{"k", "\[GreaterEqual]", "2"}], "&&", 
         RowBox[{"j", "\[GreaterEqual]", "2"}], "&&", 
         RowBox[{"j", "\[LessEqual]", 
          RowBox[{"1", "+", "k"}]}]}]},
       {"0", 
        TagBox["True",
         "PiecewiseDefault",
         AutoDelete->True]}
      },
      AllowedDimensions->{2, Automatic},
      Editable->True,
      GridBoxAlignment->{
       "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
        "RowsIndexed" -> {}},
      GridBoxItemSize->{
       "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.84]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}},
      Selectable->True]}
   },
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}},
   GridBoxItemSize->{
    "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
     "RowsIndexed" -> {}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.35]}, 
       Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}, "RowsIndexed" -> {}}],
  "Piecewise",
  DeleteWithContents->True,
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellChangeTimes->{3.6838747735076323`*^9, 3.68387481063791*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Cost", "[", 
   RowBox[{"a", ",", "1", ",", "j", ",", "\[Gamma]", ",", "1"}], "]"}], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.6838749691210318`*^9, 3.683875003472871*^9}}],

Cell[BoxData[
 RowBox[{
  UnderoverscriptBox["\[Sum]", 
   RowBox[{"j", "=", "1"}], 
   RowBox[{"1", "+", "j"}]], 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"OptimalCost", "[", 
      RowBox[{"0", ",", "j", ",", "\[Gamma]", ",", "1"}], "]"}], "+", 
     RowBox[{"(", 
      TagBox[GridBox[{
         {"\[Piecewise]", GridBox[{
            {
             RowBox[{"a", " ", "\[Gamma]"}], 
             RowBox[{
              RowBox[{"j", "\[Equal]", "0"}], "||", 
              RowBox[{"j", "\[Equal]", "1"}]}]},
            {
             RowBox[{
              RowBox[{"a", " ", "\[Gamma]"}], "+", 
              FractionBox[
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "j"}], ")"}], " ", "j", " ", 
                RowBox[{"(", 
                 RowBox[{"1", "-", "\[Gamma]"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{"1", "-", 
                  FractionBox[
                   RowBox[{"Gamma", "[", 
                    RowBox[{
                    RowBox[{"1", "+", "j"}], ",", "a"}], "]"}], 
                   RowBox[{"Gamma", "[", 
                    RowBox[{"1", "+", "j"}], "]"}]]}], ")"}]}], 
               RowBox[{"2", " ", 
                RowBox[{"(", 
                 RowBox[{"1", "-", 
                  FractionBox[
                   RowBox[{"Gamma", "[", 
                    RowBox[{"j", ",", "a"}], "]"}], 
                   RowBox[{"Gamma", "[", "j", "]"}]]}], ")"}]}]]}], 
             RowBox[{
              RowBox[{"j", "\[GreaterEqual]", "2"}], "&&", 
              RowBox[{"j", "\[Equal]", "1"}]}]},
            {
             RowBox[{
              RowBox[{
               FractionBox["1", "2"], " ", "a", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "3"}], "+", 
                 RowBox[{"2", " ", "j"}]}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{"1", "-", "\[Gamma]"}], ")"}]}], "+", 
              RowBox[{"a", " ", "\[Gamma]"}]}], 
             RowBox[{
              RowBox[{"j", "\[GreaterEqual]", "2"}], "&&", 
              RowBox[{"2", "\[LessEqual]", "j"}], "&&", 
              RowBox[{"j", "\[LessEqual]", 
               RowBox[{"1", "+", "j"}]}]}]},
            {"0", 
             TagBox["True",
              "PiecewiseDefault",
              AutoDelete->True]}
           },
           AllowedDimensions->{2, Automatic},
           Editable->True,
           
           GridBoxAlignment->{
            "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
             "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
           
           GridBoxItemSize->{
            "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, 
             "Rows" -> {{1.}}, "RowsIndexed" -> {}},
           GridBoxSpacings->{"Columns" -> {
               Offset[0.27999999999999997`], {
                Offset[0.84]}, 
               Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
               Offset[0.2], {
                Offset[0.4]}, 
               Offset[0.2]}, "RowsIndexed" -> {}},
           Selectable->True]}
        },
        GridBoxAlignment->{
         "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}},
           "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.35]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       "Piecewise",
       DeleteWithContents->True,
       Editable->False,
       SelectWithContents->True,
       Selectable->False], ")"}]}], ")"}], " ", 
   RowBox[{"(", 
    TagBox[GridBox[{
       {"\[Piecewise]", GridBox[{
          {
           RowBox[{"Boole", "[", 
            RowBox[{"j", "\[Equal]", "1"}], "]"}], 
           RowBox[{"j", "\[Equal]", "0"}]},
          {
           RowBox[{"1", "-", 
            FractionBox[
             RowBox[{"Gamma", "[", 
              RowBox[{"j", ",", "a"}], "]"}], 
             RowBox[{"Gamma", "[", "j", "]"}]]}], 
           RowBox[{
            RowBox[{"j", "\[GreaterEqual]", "1"}], "&&", 
            RowBox[{"j", "\[Equal]", "1"}]}]},
          {
           RowBox[{"a", " ", 
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{"-", "a"}]]}], 
           RowBox[{
            RowBox[{"j", "\[GreaterEqual]", "2"}], "&&", 
            RowBox[{"2", "\[LessEqual]", "j"}], "&&", 
            RowBox[{"j", "\[LessEqual]", "j"}]}]},
          {"0", 
           TagBox["True",
            "PiecewiseDefault",
            AutoDelete->True]}
         },
         AllowedDimensions->{2, Automatic},
         Editable->True,
         GridBoxAlignment->{
          "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxItemSize->{
          "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{1.}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.84]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}},
         Selectable->True]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
        "RowsIndexed" -> {}},
      GridBoxItemSize->{
       "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.35]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     "Piecewise",
     DeleteWithContents->True,
     Editable->False,
     SelectWithContents->True,
     Selectable->False], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.6838749918197937`*^9, 3.683875004504887*^9}}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "PossiblePolicies", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PossiblePolicies", "[", 
    RowBox[{"n_", ",", "k_", ",", "\[Gamma]_", ",", "\[Mu]_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"PossiblePolicies", "[", 
     RowBox[{"n", ",", "k", ",", "\[Gamma]", ",", "\[Mu]"}], "]"}], "=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"sol", ",", "result"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"sol", "=", 
        RowBox[{
         RowBox[{"NSolve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"D", "[", 
              RowBox[{
               RowBox[{"Cost", "[", 
                RowBox[{
                "a", ",", "n", ",", "k", ",", "\[Gamma]", ",", "\[Mu]"}], 
                "]"}], ",", "a"}], "]"}], "\[Equal]", "0"}], "&&", 
            RowBox[{"a", ">", "0"}]}], ",", "a"}], "]"}], "//", "Quiet"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "sol", "]"}], "\[Equal]", "0"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"result", "=", 
          RowBox[{"{", "0", "}"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"result", "=", 
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{"a", "/.", "sol"}]}], "}"}], "]"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "result"}]}], "\[IndentingNewLine]", "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6705429252157784`*^9, 3.6705430257982407`*^9}, {
  3.680856732389703*^9, 3.6808567481875896`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "OptimalPolicy", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"OptimalPolicy", "[", 
    RowBox[{"n_", ",", "k_", ",", "\[Gamma]_", ",", "\[Mu]_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"OptimalPolicy", "[", 
     RowBox[{"n", ",", "k", ",", "\[Gamma]", ",", "\[Mu]"}], "]"}], "=", 
    RowBox[{
     RowBox[{"PossiblePolicies", "[", 
      RowBox[{"n", ",", "k", ",", "\[Gamma]", ",", "\[Mu]"}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{"Ordering", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Cost", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"PossiblePolicies", "[", 
               RowBox[{"n", ",", "k", ",", "\[Gamma]", ",", "\[Mu]"}], "]"}], 
              "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", "n", ",", "k", ",", 
             "\[Gamma]", ",", "\[Mu]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"PossiblePolicies", "[", 
               RowBox[{"n", ",", "k", ",", "\[Gamma]", ",", "\[Mu]"}], "]"}], 
              "]"}]}], "}"}]}], "]"}], ",", "1"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.681016298512516*^9, 3.681016355001041*^9}, 
   3.68101707232943*^9, 3.6810718363619623`*^9, 3.681342054256401*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "OptimalCost", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"OptimalCost", "[", 
    RowBox[{"n_", ",", "k_", ",", "\[Gamma]_", ",", "\[Mu]_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"OptimalCost", "[", 
     RowBox[{"n", ",", "k", ",", "\[Gamma]", ",", "\[Mu]"}], "]"}], "=", 
    TagBox[GridBox[{
       {"\[Piecewise]", GridBox[{
          {
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "\[Gamma]"}], ")"}], "*", 
             FractionBox[
              RowBox[{"\[Mu]", "*", "k", "*", 
               RowBox[{"(", 
                RowBox[{"k", "-", "1"}], ")"}]}], "2"]}], "+", 
            RowBox[{"\[Gamma]", "*", "k", "*", "\[Mu]"}]}], 
           RowBox[{"n", "\[Equal]", "0"}]},
          {
           RowBox[{"Cost", "[", 
            RowBox[{
             RowBox[{"OptimalPolicy", "[", 
              RowBox[{"n", ",", "k", ",", "\[Gamma]", ",", "\[Mu]"}], "]"}], 
             ",", "n", ",", "k", ",", "\[Gamma]", ",", "\[Mu]"}], "]"}], 
           RowBox[{"n", "\[GreaterEqual]", "1"}]}
         },
         AllowedDimensions->{2, Automatic},
         Editable->True,
         GridBoxAlignment->{
          "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxItemSize->{
          "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{1.}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.84]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}},
         Selectable->True]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
        "RowsIndexed" -> {}},
      GridBoxItemSize->{
       "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.35]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     "Piecewise",
     DeleteWithContents->True,
     Editable->False,
     SelectWithContents->True,
     Selectable->False]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6705434386894627`*^9, 3.670543493499186*^9}, 
   3.6705446077790327`*^9, {3.680854083760241*^9, 3.680854154267329*^9}, {
   3.6808568365870733`*^9, 3.680856839921689*^9}, {3.6809047970011168`*^9, 
   3.68090479727159*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Cost", "[", 
   RowBox[{"a", ",", "1", ",", "1", ",", "\[Gamma]", ",", "\[Mu]"}], "]"}], "//",
   "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.6809042413892736`*^9, 3.680904279234866*^9}, 
   3.6809097898586884`*^9, {3.681008400131878*^9, 3.681008414529977*^9}}],

Cell[BoxData[
 TagBox[GridBox[{
    {"\[Piecewise]", GridBox[{
       {
        RowBox[{"\[Mu]", "+", 
         RowBox[{"\[Gamma]", " ", 
          RowBox[{"(", 
           RowBox[{"a", "+", "\[Mu]"}], ")"}]}]}], 
        RowBox[{"a", "\[LessEqual]", "0"}]},
       {
        RowBox[{
         RowBox[{"a", " ", "\[Gamma]"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{"-", 
              FractionBox["a", "\[Mu]"]}]], "+", "\[Gamma]"}], ")"}], " ", 
          "\[Mu]"}]}], 
        TagBox["True",
         "PiecewiseDefault",
         AutoDelete->True]}
      },
      AllowedDimensions->{2, Automatic},
      Editable->True,
      GridBoxAlignment->{
       "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
        "RowsIndexed" -> {}},
      GridBoxItemSize->{
       "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.84]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}},
      Selectable->True]}
   },
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}},
   GridBoxItemSize->{
    "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
     "RowsIndexed" -> {}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.35]}, 
       Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}, "RowsIndexed" -> {}}],
  "Piecewise",
  DeleteWithContents->True,
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellChangeTimes->{3.68117955782515*^9, 3.681257368936445*^9, 
  3.681336518802549*^9, 3.681342064954368*^9, 3.683875053894459*^9, 
  3.683876518808913*^9, 3.683877026395555*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Limit", "[", 
    RowBox[{
     RowBox[{"Assuming", "[", 
      RowBox[{
       RowBox[{"a", ">", "0"}], ",", 
       RowBox[{"FullSimplify", "[", 
        RowBox[{"F", "[", 
         RowBox[{"a", ",", "r", ",", "\[Mu]"}], "]"}], "]"}]}], "]"}], ",", 
     RowBox[{"a", "\[Rule]", "0"}]}], "]"}], "\[Equal]", 
   RowBox[{"F", "[", 
    RowBox[{"0", ",", "r", ",", "\[Mu]"}], "]"}]}], "//", 
  "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{"Assuming", "[", 
  RowBox[{
   RowBox[{"r", "\[GreaterEqual]", "1"}], ",", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"Gamma", "[", 
      RowBox[{"r", ",", "0"}], "]"}], "\[Equal]", 
     RowBox[{"Gamma", "[", "r", "]"}]}], "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.681177726472396*^9, 3.6811777272871313`*^9}, {
  3.681179247437306*^9, 3.681179267946499*^9}, {3.681179414008627*^9, 
  3.6811795283945627`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Limit", "[", 
   RowBox[{
    RowBox[{"1", "-", 
     FractionBox[
      RowBox[{"Gamma", "[", 
       RowBox[{"r", ",", 
        FractionBox["a", "\[Mu]"]}], "]"}], 
      RowBox[{"Gamma", "[", "r", "]"}]]}], ",", 
    RowBox[{"a", "\[Rule]", "0"}]}], "]"}], "\[Equal]", "0"}]], "Output",
 CellChangeTimes->{3.681179576188994*^9, 3.6812573912686167`*^9, 
  3.681342087505954*^9, 3.6838750796957693`*^9, 3.683876543716861*^9, 
  3.683877053222234*^9}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.681179576188994*^9, 3.6812573912686167`*^9, 
  3.681342087505954*^9, 3.6838750796957693`*^9, 3.683876543716861*^9, 
  3.683877053234045*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Mu]", " ", "=", " ", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"OptimalCost", "[", 
       RowBox[{"n", ",", "0", ",", "\[Gamma]", ",", "\[Mu]"}], "]"}], ",", 
      " ", 
      RowBox[{"{", 
       RowBox[{
       "\[Gamma]", ",", " ", "0.1", ",", " ", "0.9", ",", " ", "0.1"}], 
       "}"}]}], "]"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"n", ",", " ", "1", ",", " ", "2"}], "}"}]}], "]"}], "//", 
  "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.6812573994668694`*^9, 3.6812574327716093`*^9}, {
  3.6812574811981564`*^9, 3.681257496730484*^9}, {3.68127622357425*^9, 
  3.681276227738142*^9}, {3.683875090718668*^9, 3.6838750945586147`*^9}, {
  3.683875581390128*^9, 3.68387558158607*^9}, {3.683876428788616*^9, 
  3.683876435468967*^9}, {3.683876978121109*^9, 3.683876978243332*^9}, {
  3.683877041881833*^9, 3.6838770616262302`*^9}, {3.683877459177169*^9, 
  3.6838774593634768`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.1`", "0.2`", "0.30000000000000004`", "0.4`", "0.5`", "0.6`", 
      "0.7000000000000001`", "0.8`", "0.9`"},
     {"0.43025850929940457`", "0.7218875824868202`", "0.9611918412977809`", 
      "1.166516292749662`", "1.3465735902799727`", "1.5064953742595946`", 
      "1.6496724607571127`", "1.7785148410513678`", "1.8948244640920435`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.681257597564945*^9, 3.6812773662387743`*^9, 3.6813433172292347`*^9, 
   3.683875115609438*^9, 3.6838764401208553`*^9, {3.683877055011633*^9, 
   3.683877058969795*^9}, 3.6838775950906143`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"output", " ", "=", " ", "\"\<[\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"n", "=", "1"}], ",", 
    RowBox[{"n", "\[LessEqual]", "5"}], ",", 
    RowBox[{"n", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"\[Gamma]", "=", "0.05"}], ",", 
       RowBox[{"\[Gamma]", "\[LessEqual]", "0.9"}], ",", 
       RowBox[{"\[Gamma]", "+=", "0.05"}], ",", "\[IndentingNewLine]", 
       RowBox[{"output", " ", "=", " ", 
        RowBox[{"StringJoin", "[", 
         RowBox[{"{", 
          RowBox[{"output", ",", 
           RowBox[{"ToString", "[", 
            RowBox[{"OptimalCost", "[", 
             RowBox[{"n", ",", "0", ",", "\[Gamma]", ",", "\[Mu]"}], "]"}], 
            "]"}], ",", "\"\<, \>\""}], "}"}], "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"output", " ", "=", " ", 
      RowBox[{"StringJoin", "[", 
       RowBox[{"{", 
        RowBox[{"output", ",", " ", 
         RowBox[{"ToString", "[", 
          RowBox[{"OptimalCost", "[", 
           RowBox[{"n", ",", " ", "0", ",", " ", "0.95", ",", " ", "\[Mu]"}], 
           "]"}], "]"}], ",", " ", "\"\<; \>\""}], "}"}], "]"}]}]}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"\[Gamma]", "=", "0.05"}], ",", 
    RowBox[{"\[Gamma]", "\[LessEqual]", "0.9"}], ",", 
    RowBox[{"\[Gamma]", "+=", "0.05"}], ",", "\[IndentingNewLine]", 
    RowBox[{"output", "=", 
     RowBox[{"StringJoin", "[", 
      RowBox[{"{", 
       RowBox[{"output", ",", " ", 
        RowBox[{"ToString", "[", 
         RowBox[{"OptimalCost", "[", 
          RowBox[{"6", ",", "0", ",", "\[Gamma]", ",", "\[Mu]"}], "]"}], 
         "]"}], ",", " ", "\"\<, \>\""}], "}"}], "]"}]}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"output", " ", "=", " ", 
   RowBox[{"StringJoin", "[", 
    RowBox[{"{", 
     RowBox[{"output", ",", " ", 
      RowBox[{"ToString", "[", 
       RowBox[{"OptimalCost", "[", 
        RowBox[{"6", ",", "0", ",", "0.95", ",", "\[Mu]"}], "]"}], "]"}], ",",
       " ", "\"\<]\>\""}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "output", "]"}]}], "Input",
 CellChangeTimes->{{3.681279982789009*^9, 3.6812801091410418`*^9}, {
  3.681291716043075*^9, 3.681291966873251*^9}}],

Cell[BoxData["\<\"[0.05, 0.1, 0.15, 0.2, 0.25, 0.3, 0.35, 0.4, 0.45, 0.5, \
0.55, 0.6, 0.65, 0.7, 0.75, 0.8, 0.85, 0.9, 0.95; 0.249787, 0.430259, \
0.584568, 0.721888, 0.846574, 0.961192, 1.06744, 1.16652, 1.25933, 1.34657, \
1.42881, 1.5065, 1.58001, 1.64967, 1.71576, 1.77851, 1.83814, 1.89482, \
1.94873; 0.448742, 0.7608, 1.02291, 1.25323, 1.4601, 1.64827, 1.82069, \
1.9793, 2.12544, 2.26002, 2.38365, 2.49671, 2.59936, 2.69165, 2.77341, \
2.84432, 2.90383, 2.95104, 2.9844; 0.647606, 1.09112, 1.4609, 1.78405, \
2.07299, 2.33466, 2.57334, 2.79184, 2.99202, 3.17509, 3.3418, 3.49249, \
3.62716, 3.74545, 3.8466, 3.92931, 3.99154, 4.02996, 4.03848; 0.846464, \
1.42143, 1.89885, 2.31484, 2.68583, 3.02098, 3.32592, 3.60429, 3.85849, \
4.09006, 4.2999, 4.48837, 4.65532, 4.80009, 4.92136, 5.01698, 5.0834, \
5.11469, 5.09928; 1.04532, 1.75174, 2.33681, 2.84563, 3.29867, 3.7073, \
4.07849, 4.41673, 4.72496, 5.00503, 5.258, 5.48425, 5.6835, 5.85478, 5.99629, \
6.10502, 6.17603, 6.20082, 6.16228]\"\>"], "Print",
 CellChangeTimes->{3.6812919678032312`*^9, 3.681343761380251*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Mu]", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Gamma]", "=", "0.5"}], ";"}]}], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"OptimalPolicy", "[", 
   RowBox[{"1", ",", "1", ",", "\[Gamma]", ",", "\[Mu]"}], "]"}], "\[Equal]", 
  
  RowBox[{
   RowBox[{"-", "\[Mu]"}], "*", 
   RowBox[{"Log", "[", "\[Gamma]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.680905506164727*^9, 3.680905531736383*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.68117964306098*^9, 3.681344725221663*^9, 
  3.6838776086495543`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"num", "=", "6"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{"OptimalCost", "[", 
    RowBox[{"n", ",", "0", ",", "\[Gamma]", ",", "\[Mu]"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"n", ",", "0", ",", "num"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"n", "+", "k"}], "\[LessEqual]", "num"}], ",", 
        RowBox[{"OptimalCost", "[", 
         RowBox[{"n", ",", "k", ",", "\[Gamma]", ",", "\[Mu]"}], "]"}], ",", 
        "0"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "0", ",", "num"}], "}"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"n", ",", "0", ",", "num"}], "}"}]}], "]"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"n", "+", "k"}], "\[LessEqual]", "num"}], ",", 
        RowBox[{"OptimalPolicy", "[", 
         RowBox[{"n", ",", "k", ",", "\[Gamma]", ",", "\[Mu]"}], "]"}], ",", 
        "0"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "0", ",", "num"}], "}"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"n", ",", "1", ",", "num"}], "}"}]}], "]"}], "//", 
  "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.6704760892990427`*^9, 3.670476089332934*^9}, 
   3.6705446154046926`*^9, {3.68085686013916*^9, 3.68085687561231*^9}, {
   3.680857419477059*^9, 3.6808574195051413`*^9}, {3.680857473296444*^9, 
   3.6808574733375874`*^9}, {3.6809054674804077`*^9, 
   3.6809054721962748`*^9}, {3.680905542053706*^9, 3.6809055623140173`*^9}, {
   3.680909537995883*^9, 3.6809095380743237`*^9}, {3.68100038732311*^9, 
   3.681000393552916*^9}, 3.681015817152535*^9, {3.681016658378229*^9, 
   3.681016658449277*^9}, {3.6810174344310017`*^9, 3.681017437077866*^9}, 
   3.681177743487032*^9, {3.6838776140672407`*^9, 3.683877629800583*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.`", ",", "0.5`", ",", "1.3465735902799727`", ",", "2.275600160467455`", 
   ",", "3.214165654081734`", ",", "4.153713557339705`", ",", 
   "5.093361667470079`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.681179674516*^9, 3.681344728143999*^9, {3.683877616664249*^9, 
   3.68387763137265*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.`", "0.5`", "1.5`", "3.`", "5.`", "7.5`", "10.5`"},
     {"0.5`", "1.3465735902799727`", "2.525855803859167`", 
      "4.159407620197224`", "6.270428710356655`", "8.867452658050341`", "0"},
     {"1.3465735902799727`", "2.275600160467455`", "3.477596519080798`", 
      "5.126451243387621`", "7.249488393044352`", "0", "0"},
     {"2.275600160467455`", "3.214165654081734`", "4.418526040006544`", 
      "6.0689586533236435`", "0", "0", "0"},
     {"3.214165654081734`", "4.153713557339705`", "5.358315337828142`", "0", 
      "0", "0", "0"},
     {"4.153713557339705`", "5.093361667470079`", "0", "0", "0", "0", "0"},
     {"5.093361667470079`", "0", "0", "0", "0", "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.681179674516*^9, 3.681344728143999*^9, {3.683877616664249*^9, 
   3.683877631384181*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0.6931471805599453`", "1.6783469900166605`", 
      "2.6740603137235603`", "3.672060748850896`", "4.670908882795983`", 
      "0"},
     {"0", "0.8580531403749649`", "1.9142805390490893`", "2.956716761078062`",
       "3.990881003533622`", "0", "0"},
     {"0", "0.8771309872285578`", "1.9405934724817182`", 
      "2.9877371214784985`", "0", "0", "0"},
     {"0", "0.879095806515942`", "1.9432955219089536`", "0", "0", "0", "0"},
     {"0", "0.8792962202607502`", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.681179674516*^9, 3.681344728143999*^9, {3.683877616664249*^9, 
   3.683877631395052*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TeXForm", "[", 
  RowBox[{"MatrixForm", "[", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"n", "+", "k"}], "\[LessEqual]", "num"}], ",", 
         RowBox[{"OptimalCost", "[", 
          RowBox[{"n", ",", "k", ",", "\[Gamma]", ",", "\[Mu]"}], "]"}], ",", 
         "0"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "0", ",", "num"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", "0", ",", "num"}], "}"}]}], "]"}], "]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.670539860603891*^9, 3.670539901113492*^9}, {
  3.670540104616185*^9, 3.670540105714847*^9}, {3.6808568812877083`*^9, 
  3.680856883770735*^9}}],

Cell["\<\
\\left(
\\begin{array}{ccccccc}
 0. & 0.5 & 1.5 & 3. & 5. & 7.5 & 10.5 \\\\
 0.5 & 1.34657 & 2.48969 & 4.02475 & 5.98026 & 8.37089 & 0 \\\\
 1.34657 & 2.26002 & 3.40683 & 4.94061 & 6.89375 & 0 & 0 \\\\
 2.26002 & 3.17509 & 4.32169 & 5.85527 & 0 & 0 & 0 \\\\
 3.17509 & 4.09006 & 5.23664 & 0 & 0 & 0 & 0 \\\\
 4.09006 & 5.00503 & 0 & 0 & 0 & 0 & 0 \\\\
 5.00503 & 0 & 0 & 0 & 0 & 0 & 0 \\\\
\\end{array}
\\right)\
\>", "Output",
 CellChangeTimes->{3.681179675101001*^9, 3.681344734106827*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TeXForm", "[", 
  RowBox[{"MatrixForm", "[", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"n", "+", "k"}], "\[LessEqual]", "num"}], ",", 
         RowBox[{"OptimalPolicy", "[", 
          RowBox[{"n", ",", "k", ",", "\[Gamma]", ",", "\[Mu]"}], "]"}], ",", 
         "0"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "0", ",", "num"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", "1", ",", "num"}], "}"}]}], "]"}], "]"}], 
  "]"}]], "Input",
 CellChangeTimes->{
  3.670544618954814*^9, {3.6808568917144527`*^9, 3.680856903321348*^9}}],

Cell["\<\
\\left(
\\begin{array}{ccccccc}
 0 & 0.693147 & 1.75711 & 2.82577 & 3.85505 & 4.8492 & 0 \\\\
 0 & 0.826902 & 1.90223 & 2.95223 & 3.95872 & 0 & 0 \\\\
 0 & 0.83013 & 1.90481 & 2.95403 & 0 & 0 & 0 \\\\
 0 & 0.82995 & 1.90455 & 0 & 0 & 0 & 0 \\\\
 0 & 0.829925 & 0 & 0 & 0 & 0 & 0 \\\\
 0 & 0 & 0 & 0 & 0 & 0 & 0 \\\\
\\end{array}
\\right)\
\>", "Output",
 CellChangeTimes->{3.681179675136506*^9, 3.681344737786298*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"Cost", "[", 
    RowBox[{"a", ",", "3", ",", "2", ",", "\[Gamma]", ",", "\[Mu]"}], "]"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"a", ",", "0", ",", "8"}], "}"}], ",", 
   RowBox[{"AxesLabel", "\[Rule]", "Automatic"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.670138358869254*^9, 3.6701383591862383`*^9}, {
   3.670141343206565*^9, 3.670141368071753*^9}, {3.670476245003521*^9, 
   3.670476245744802*^9}, {3.6808569121393747`*^9, 3.680856914621797*^9}, 
   3.6809097008441763`*^9, {3.6809099307267733`*^9, 3.680909932677642*^9}}],

Cell[BoxData[
 GraphicsBox[{{}, {}, 
   {RGBColor[0.368417, 0.506779, 0.709798], AbsoluteThickness[1.6], Opacity[
    1.], LineBox[CompressedData["
1:eJwV1nk4VG8UB/BZspPuGMMMGUSlTaSk5D0tKFG2opIlZEnalKgsoRTKVqFI
iWiRKPXLmmQJlV2W7CqRfR8zv9df9/k893nvPXd5z/kqHDtl6kghkUhiZBJp
4Wjg+Lu68E+Qzp0YVefL/nT4lX7wWDvTAaW2aAi0+NKBIVJ/K4vpgYSSeRFa
PnRYp0VPjmcGIgGF+lOT3nTY8n1DRiQzGmkfzXY/5UGHwvufNoYxn6D2O3LX
bJzoEOAfcvEm8w3KHl25EYzo4OAxxLzBLEbaV85XICYdBKP3PBoeqUM/nAw+
3HwuAe++q+vry7Wj8PsN6UF7JcAyoLX5U0gP+lve6h80QYNTr8+tjRn/g250
xDs1PqbBP+3O2nLBfuS8Ymz2/SMauJXt856T7UfqGWc33k+kgXO7Sqm1bj+S
KzuZaJdAA1uxDlvlu/1IsSDNZDKWBsYuhtGZmn/Rl6bwLSiCBusVlOcqvQfQ
oQGZ1v1+NBgNbygjk4eQzSeVutO2NMh1e416GENI3jHomrMNDa7vDs0uWTOE
uC7DFDtrGsiSdjwJsRxCb1LkDptb0UD31EtfyYwhZBDYf3WXJQ0ql++4H606
jFztLT4bGNNAno9pmvpzGGVoy6sNAQ34zl0Li/0zjEZCRdRJ2P0dY2U3x4eR
dFXEPIFo8Db3KzopPIL4+JzGNbfRwMAjcK36phG0KP2XbZgWDTy6hwRzw0ZQ
smC2mrU6Dco+lhR80x5Fx25bBt5TokFKJacnTH8U5ceuyPy8jAZBjerChqaj
6NOs7eNxRRrsGEwwL3MaRQ3q3eXmCvh5pT3/FEaOogqB8g1ycjTIOLVCIvP3
KJICE6d6KRrELA0+Hh09hs61qHXWidDgwsr8ENOHYyjHVQ1ksA9sGM9Y8mwM
Sf+OtzkmTAPaHtu50IIxpHjgZPuoIA1CPTaHB/WPIbN7KR2y/DTwq/j93wUY
R6WvyhqiSTRw8dojdmhgHMWtvjgsMUnAMxniqPXkOLK93y18ZYKAgbymF/ak
CZRGVv/SN06AO8XZ0J0+gWwuyWvmjhHgEXItJEB7Aj28+aPUfYQA3/hPQumh
Eyj371DG6AABdz5u46eunUTJvUyORw8BDfZ8BwU1J1HLYuq10W4CpPmrksW2
TyKKZ83r09hxBla60gcmEbUi5597FwGJtd6Ba69MImFomj3bQcDz3ncUy6pJ
lNtVuyu2lYCPQuq8FyenUN2B0p9H6wlYab7+3c2LU+jDwW0r+uoICE9Yd8o5
YApxlGZUTmHbbljdviwWn3d+fjSglgCulVJBXPEUmi6q9XpTTcCWDIZvsMw0
Wmp8217rKwGPZ+max5dPo3vPzuhUVREgpCsxtFNtGgk+V622w276IW7D05tG
/BkPl4ZVEuBJFUIXzk6jxIRho4EvBLw5OMe1L59GoZJzvytLCZB9NJO9vW4a
Vcz/t84NO+DvlDu7fRrFulaoiGKb+o3/bB6fRkVPEdpXQsBw2mC+ifwM2pfa
2tVcTMDa+XYf5DmDHtwR/i1ZREBKUjGXpTyLnp1blU/kEXA6yLwTqc6i3kvp
+pW5BGx16vnkoDWLXg6FuF7H/r5q0Y10o1n0GIou8XIImHm9U2LHBbxefVnZ
5AcCDAuLVriUzqL8lR9+k/8jgPHYVPhW9SwikXMnP78noDOgayCzZRY10Kru
38S+oE/J5AzNohK74GeS2Ilft2uHS8+hODWTBvV3BIy1Fhq/c5lDmcNuejfe
EpCfb7yh9dwcCid1ZB3EDk7skCT7zCE7e+FsJWxZB1KLQeQc6r446Fn0hgC9
v8jx54c5xC0oHlyEHTeT78UnykE+dFO/5EwCHFr2Wa1icNAuvaMrLmOr5v3U
2S/PQQ2KubZm2MV+XGqsBgdRAptvULEHBXRurTnKQVZWNq9dXxMAjLzHZukc
5H747gbzDAIW3ZE8pfueg0S/N9zSwC6TcN+qWcRBBRPHPCSx9xPsOlYDBx3+
8qWt6RUB1qL+fF3zHBSo/1X5OLZiyI/qWoF5VKF47JsBdq+QesJnYh797GRS
1mO7CXRvSlOeR20JthROOgGXKLrOp43mUWDyFtc4bB3/eI1jFvOIaddmGYBN
IU2SzO3mUfcl729u2DfnU2I1z8+jv1GLzbdjx0wLVnAfzCMzm+Ds4ZcEWHna
3RtOmUfDJr872rDlJ/+z78qYR81RUpEV2E/HXDmfi+dRIbEvOBU7+1/l2rCB
eXREnlTojO19UnnWZ3IeTf8skD2MrTNwpeQ0iYtEryjy9mJ//rPOxpzORYaF
WuZq2MHO11fryXHRosVJJUrYhr/apzRXcpF7qHS+NHZdT3i4jDYXMbdEbKVg
x9j/sRLT46LXg7s/Tr3A9XZtV+Ht56La5vMVg9jydnETw4e4aHbz6KEe7O72
0Y9d9lzktzXGrQU7xXrvrbqTXPSK2EGtxXZtSzpc4slFjX3lSyuwR5vNx9JC
uKhjRWtbLnb2oZcF9+9w0YpGVkA2tncTX2jYQy46Ipr4PANbx8La0jeNiwQ6
dC2eY5MbspXOZHHRWqe+oBTsYnPxkWN5XGSTdUTzMXZwrVOeeSkXldb4nkjA
NjQtvKFXzUW639co3sdeUi19cHMLF13J0j4Sg123/4ziql4u6vO7wbiLfe9r
+T+ZIS7q1ho0i8Y+bKSYIzbDRTWt2yWisOUqva/zKDyk6GhnHondZVBrNiLK
Q0cqlKUWnFK+Wr6bwUPA53Jkwa67Awfq5Hmolo9PYWH92tLW9yWreOhUXq3T
wvUZ/04Mhm/kofVX7KwW7k+SnFM4AjxkdvvZ74X6+rfePKi8l4eWGfqIPlio
9xgzZOgAD6UKvih9iJ1/I7XgP1seymZQWU+wUzM0xwNO8JD4Z1NqGnZkY8nK
fRd46IqNa0A69mXugaPS/jzUt44Z9wb7uHJvRFcID7l7rdPPwTY29Ch5cZeH
blz1ulmEveUcde7CIx6SCym3/4KtFBepuv0FD92pHqypwV78UcFB5B0PzUW8
bVz4/tO/MmLqP/KQFP/wmV7syo3fyK6NPJTXO+M4u/C9raw3aXTxkMUHpwI+
/L8lBgy6cgd4aJIe9JLA/vCbz3UPmQRiLBH91diql40C0/lJYMCmjW7GfiJ+
J0FClAQ7bPnU9LFvbVKqbWOQ4NuWQRdHbOqXE4M7ZEnQs8zP/jz2xaNZAqkK
JBj4tXUY3wGOBe7QPruGBDVRrkUL+2tjjW0y/w4S2Bkb7prAfuaYWnBCnwSG
/6qqhfD+lZsZ+vHdkASlXiPDctiC8r6L71uQYP2Pw90G2K0n4z1VT5Lg+Hrr
qDRsE3JvRPRZEmx/cze1CLskes2LGU9cr1K/USt2Rk5Ox6erJMjfK7ebwP0m
UKh5j2UMCd652U/4Y888UHDIiydBAVXm2kNs9/UuPopJJPgefzw5D9vSYjpz
4CUJhDwnb81hr0lmyPp/IsFy3UeCPrj/1YHZv7R/JDCzcDsRj/vn7MPu+Mwx
XG9m+OaP2Aq8c0Y50ySIS1H37cV2z4t+UUkhQ/2M8UVV3H8FtjS4DjHIwCEl
SZZjb9lw6JcGwm4jNdNwf7eN/HN32y4yxFifW6ODfX3ES09vDxk+tPRPuGDX
vYpLtjAjw8y4weDCfDi5ptXe24kM/yx9Xbzx/EhUtukouE0G/1x0npeN30/g
0O2yaDKERAUrL8yjwW5fVB1LhhYzWwNH7C2PExO6ksjQeoE9UoldK9dlxfee
DH4mEemP8Dzjl3b8YdBBBintqRJbPB/dhE/U1K+ngIaDmpVGPt6PeYxsg00U
uNA3VuGN3X66KLZgKwWu2/fnf8Q2bWTapelRQKXk5VqTAgI2PykbumxFAUrH
SpULhXje6CwXUwqmwMTHFrcmPM8fnOnUP9tOgVX5nG8cnAcalMJW/+qhgMlB
Qt+sjADxps3iVv0UaPi1Zesz7Ks64Q26ExTYKioSd6icAGcR5MgUocJwptma
fJw/NJIfXC3cRIUlKru8EnBeqWiyyFt8iwqWgoYOH3D+udr8S9I1igrr2DY7
5XA+2tzq6f45hgpP6ZvvXMV+0n6PfTmJCnrbgsMNcb663Nfo/+c9FYybcjp6
G3C/GbfQK+6mgs9zm8K1zQTcFrf85qW1CNQ8BnWJTgLM9Cw7e3oWwQqeW+3S
Ybz/JNS+df9ZBOkbMs9GYyt2CuV1/VsEFrN73URwfhy9lBPTMb0IXH3GTs5i
h7+WM24V5QPDlv1PW3HerJTtza/V4IPMOzvrXk8RsGvszIOiQD6IqepbmcAj
YFNiiEWiEj8ky+oc91xCgw5uVJ2zrwCUKCfoW+D83rvnWxLjkyDEfPJd5uCA
83Zsu1e1gjBkpTnb1NyjQXIw9YaKtwhcMbp8O+krDSbsD/cfzxGFny4RjM18
EiCy65rpa6nF4LFMPDJnpwRcXtIr2mklDhvWRIl1+0mAaP5qUqPREhBKmOJT
KZCAbRf2z3+aXQIzp5ZY8vHR4cGT0KRlDwjI/R4qrrCbDtYHNKqE9tJATsDI
LCuSDm/rHaPyJ2ng2rNJKrSNDlqVGZS+uxLA+VMZ+URJEuR1j09E7aKDv7Iv
a+asJGzU2Bjxpo8O3YOqfTJ5ktA+GlaeFCQJNZGqQg/5GTCwwSSIqc6AforT
rk0WDFj+d20/uZYBom/FJulJDChWOl9z2l8KxIWbj89MMOB2Xb29qZI0eLeO
Kv/eKQVDZoURlGJpmEvT4uSHS0HmAcmdWmeY8H7YLCuwRwqSqgLiu2gsSNtj
fURsgzRMlVpdohWxwDkiNP5ysDR0RBRMLHGXAa9uj7inrdIwWb2VeXWxLLy0
SBJ3XM2E09GKhV65shBn73yR48cEqSrFJT3WSyFMODGMqGaCWf0Ljix3KdSv
dxN5z2bBqM0jt9ZncqDZYOG8/jwLCmxfBS02ZMOtquDIxZ9Z8OGb296f+9iQ
uPel27kSFmTrrCLSTdigSXq7u6mUBS9kkx8YWbCB5+7C//gLC+Ka4rJCj7Gh
QVMvZuN3Fpw3vtYp7MWG71bf6UdbWLAajm4TSGFDfoyJy8sRFix/xaI2prLB
Z+vLK7QxFijKNZWlPGdDsXtZlOc4C6Q5puZ6r9lgrKP1efsUC/jf7z4RlMsG
x7Q+7QYOCzpVNWKptWwg8wf68ARkoDVhxLq2ng1aVw+lOwjJQJPYK6WkJjZ4
ZLe1lwvLwNe/Khk7frKhcfk//WgxGch9yi71/8OGdmfaGhUJGXjPaAs1GWCD
fxe43KLLQFZQnKnCEBv6uiVTxyRl4Jm95M/CcTZcP/NqVb60DCTX1CSFT7FB
aOaM+zKWDCRuD3exncXX4zZkBcvIwIMMI9X182xQu9o2OygrA/fYIhM8HhsK
rwbuNJOTgf8B1cGsiA==
     "]]}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{
    FormBox[
     TagBox["a", HoldForm], TraditionalForm], None},
  AxesOrigin->{0, 4.3},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{
   "DefaultBoundaryStyle" -> Automatic, "DefaultMeshStyle" -> 
    AbsolutePointSize[6], "ScalingFunctions" -> None},
  PlotRange->{{0, 8}, {4.41852604072741, 6.779614500963987}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{3.6811796753923883`*^9, 3.6813447418718843`*^9, 
  3.6838776537857533`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Cost", "[", 
   RowBox[{"a", ",", "3", ",", "2", ",", "\[Gamma]", ",", "\[Mu]"}], "]"}], "//",
   "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.681014794368965*^9, 3.681014817454718*^9}}],

Cell[BoxData[
 TagBox[GridBox[{
    {"\[Piecewise]", GridBox[{
       {
        RowBox[{"5.126451243387621`", "\[VeryThinSpace]", "+", 
         RowBox[{"1.`", " ", "a"}]}], 
        RowBox[{"a", "\[LessEqual]", "0"}]},
       {
        RowBox[{"2.775600160467455`", "\[VeryThinSpace]", "+", 
         RowBox[{"2.3508510829201654`", " ", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"-", "a"}]]}], "+", 
         RowBox[{"a", " ", 
          RowBox[{"(", 
           RowBox[{"0.5`", "\[VeryThinSpace]", "+", 
            RowBox[{"1.2019963586133429`", " ", 
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"-", "a"}]]}]}], ")"}]}]}], 
        TagBox["True",
         "PiecewiseDefault",
         AutoDelete->True]}
      },
      AllowedDimensions->{2, Automatic},
      Editable->True,
      GridBoxAlignment->{
       "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
        "RowsIndexed" -> {}},
      GridBoxItemSize->{
       "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.84]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}},
      Selectable->True]}
   },
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}},
   GridBoxItemSize->{
    "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
     "RowsIndexed" -> {}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.35]}, 
       Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}, "RowsIndexed" -> {}}],
  "Piecewise",
  DeleteWithContents->True,
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellChangeTimes->{3.681179677139817*^9, 3.681344748743945*^9, 
  3.683877658592392*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Cost", "[", 
   RowBox[{"0", ",", "3", ",", "2", ",", "\[Gamma]", ",", "\[Mu]"}], "]"}], "==", 
  RowBox[{"Limit", "[", 
   RowBox[{
    RowBox[{"Cost", "[", 
     RowBox[{"a", ",", "3", ",", "2", ",", "\[Gamma]", ",", "\[Mu]"}], "]"}], 
    ",", 
    RowBox[{"a", "\[Rule]", "0"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6810147317191668`*^9, 3.681014748391487*^9}, {
  3.6810166011289053`*^9, 3.681016601675302*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.681179677425852*^9, 3.681344750739236*^9, 
  3.6838776636924686`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Assuming", "[", 
  RowBox[{
   RowBox[{"a", ">", "0"}], ",", 
   RowBox[{
    RowBox[{"Cost", "[", 
     RowBox[{"a", ",", "3", ",", "2", ",", "\[Gamma]", ",", "\[Mu]"}], "]"}], 
    "//", "FullSimplify"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.67053589737744*^9, 3.670535920886181*^9}, {
  3.680856924389134*^9, 3.680856926772306*^9}, {3.6810148601943197`*^9, 
  3.681014922996269*^9}, {3.681016612529149*^9, 3.6810166130777903`*^9}}],

Cell[BoxData[
 RowBox[{"2.775600160467455`", "\[VeryThinSpace]", "+", 
  RowBox[{"2.3508510829201654`", " ", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"-", "a"}]]}], "+", 
  RowBox[{"a", " ", 
   RowBox[{"(", 
    RowBox[{"0.5`", "\[VeryThinSpace]", "+", 
     RowBox[{"1.2019963586133429`", " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"-", "a"}]]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.681179677506955*^9, 3.6813447534421997`*^9, 
  3.683877668173267*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TeXForm", "[", 
  RowBox[{"Assuming", "[", 
   RowBox[{
    RowBox[{"a", ">", "0"}], ",", 
    RowBox[{
     RowBox[{"Cost", "[", 
      RowBox[{"a", ",", "3", ",", "2", ",", "\[Gamma]", ",", "\[Mu]"}], "]"}],
      "//", "FullSimplify"}]}], "]"}], "]"}]], "Input"],

Cell["\<\
-\\frac{0.5 a^2}{1. e^a-1.}+0.5 a+((0.25 a+1.64681) a+2.18058) e^{-a}+2.76002\
\
\>", "Output",
 CellChangeTimes->{3.681179677535636*^9, 3.6813447567679768`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"PossiblePolicies", "[", 
  RowBox[{"3", ",", "2", ",", "\[Gamma]", ",", "\[Mu]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"OptimalPolicy", "[", 
  RowBox[{"3", ",", "2", ",", "\[Gamma]", ",", "\[Mu]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"OptimalCost", "[", 
  RowBox[{"3", ",", "2", ",", "\[Gamma]", ",", "\[Mu]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.67047699766227*^9, 3.6704770049219437`*^9}, 
   3.670544639254498*^9, {3.670544746880262*^9, 3.6705447541010323`*^9}, {
   3.680856931014089*^9, 3.680856941997087*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "1.9405934724817182`"}], "}"}]], "Output",
 CellChangeTimes->{3.681179677557475*^9, 3.681344759369947*^9, 
  3.683877676777761*^9}],

Cell[BoxData["1.9405934724817182`"], "Output",
 CellChangeTimes->{3.681179677557475*^9, 3.681344759369947*^9, 
  3.683877676784154*^9}],

Cell[BoxData["4.418526040006544`"], "Output",
 CellChangeTimes->{3.681179677557475*^9, 3.681344759369947*^9, 
  3.683877676788148*^9}]
}, Open  ]]
},
WindowSize->{1280, 774},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
PrivateNotebookOptions->{"VersionedStylesheet"->{"Default.nb"[8.] -> False}},
Magnification:>1.25 Inherited,
FrontEndVersion->"10.3 for Mac OS X x86 (32-bit, 64-bit Kernel) (December 10, \
2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 12671, 326, 473, "Input"],
Cell[CellGroupData[{
Cell[13253, 350, 610, 18, 99, "Input"],
Cell[13866, 370, 189, 3, 35, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14092, 378, 191, 4, 35, "Input"],
Cell[14286, 384, 319, 9, 36, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14642, 398, 700, 18, 78, "Input"],
Cell[15345, 418, 307, 8, 36, "Output"],
Cell[15655, 428, 880, 27, 47, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[16572, 460, 445, 12, 36, "Input"],
Cell[17020, 474, 1130, 30, 95, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[18187, 509, 832, 24, 85, "Input"],
Cell[19022, 535, 2853, 79, 108, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[21912, 619, 766, 21, 62, "Input"],
Cell[22681, 642, 3934, 107, 130, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[26652, 754, 225, 5, 36, "Input"],
Cell[26880, 761, 1566, 47, 87, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[28483, 813, 286, 7, 36, "Input"],
Cell[28772, 822, 1214, 37, 75, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[30023, 864, 480, 13, 36, "Input"],
Cell[30506, 879, 604, 12, 29, "Message"],
Cell[31113, 893, 2406, 69, 125, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[33556, 967, 230, 5, 36, "Input"],
Cell[33789, 974, 2326, 68, 89, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[36152, 1047, 283, 7, 36, "Input"],
Cell[36438, 1056, 1920, 58, 89, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[38395, 1119, 361, 10, 36, "Input"],
Cell[38759, 1131, 458, 10, 29, "Message"],
Cell[39220, 1143, 1903, 55, 95, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[41160, 1203, 394, 11, 36, "Input"],
Cell[41557, 1216, 429, 10, 29, "Message"],
Cell[41989, 1228, 1952, 56, 95, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[43978, 1289, 474, 13, 57, "Input"],
Cell[44455, 1304, 3616, 104, 138, "Output"],
Cell[48074, 1410, 3565, 101, 130, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[51676, 1516, 224, 5, 36, "Input"],
Cell[51903, 1523, 6343, 169, 150, "Output"]
}, Open  ]],
Cell[58261, 1695, 1776, 46, 204, "Input"],
Cell[60040, 1743, 1477, 36, 141, "Input"],
Cell[61520, 1781, 2780, 69, 94, "Input"],
Cell[CellGroupData[{
Cell[64325, 1854, 302, 6, 36, "Input"],
Cell[64630, 1862, 2114, 60, 80, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[66781, 1927, 929, 25, 57, "Input"],
Cell[67713, 1954, 486, 13, 71, "Output"],
Cell[68202, 1969, 193, 3, 35, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[68432, 1977, 1032, 24, 57, "Input"],
Cell[69467, 2003, 1113, 24, 72, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[70617, 2032, 2401, 60, 204, "Input"],
Cell[73021, 2094, 1081, 14, 160, "Print"]
}, Open  ]],
Cell[74117, 2111, 150, 4, 57, "Input"],
Cell[CellGroupData[{
Cell[74292, 2119, 304, 8, 36, "Input"],
Cell[74599, 2129, 121, 2, 35, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[74757, 2136, 2087, 52, 99, "Input"],
Cell[76847, 2190, 338, 8, 35, "Output"],
Cell[77188, 2200, 1352, 29, 182, "Output"],
Cell[78543, 2231, 1210, 28, 218, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[79790, 2264, 784, 21, 36, "Input"],
Cell[80577, 2287, 501, 13, 218, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[81115, 2305, 713, 20, 36, "Input"],
Cell[81831, 2327, 427, 12, 200, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[82295, 2344, 589, 12, 35, "Input"],
Cell[82887, 2358, 6526, 120, 296, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[89450, 2483, 226, 5, 36, "Input"],
Cell[89679, 2490, 2133, 58, 60, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[91849, 2553, 457, 11, 35, "Input"],
Cell[92309, 2566, 122, 2, 35, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[92468, 2573, 462, 10, 36, "Input"],
Cell[92933, 2585, 492, 12, 41, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[93462, 2602, 289, 8, 36, "Input"],
Cell[93754, 2612, 171, 4, 35, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[93962, 2621, 562, 11, 78, "Input"],
Cell[94527, 2634, 180, 4, 35, "Output"],
Cell[94710, 2640, 135, 2, 35, "Output"],
Cell[94848, 2644, 134, 2, 69, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
