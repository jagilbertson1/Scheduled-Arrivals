(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     55092,       1439]
NotebookOptionsPosition[     52695,       1357]
NotebookOutlinePosition[     53168,       1375]
CellTagsIndexPosition[     53125,       1372]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"F", ",", "G", ",", "p", ",", "R", ",", "Cost"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"F", "[", 
    RowBox[{"a_", ",", "r_", ",", "\[Mu]_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"F", "[", 
     RowBox[{"a", ",", "r", ",", "\[Mu]"}], "]"}], "=", 
    TagBox[GridBox[{
       {"\[Piecewise]", GridBox[{
          {
           RowBox[{"1", "-", 
            RowBox[{
             UnderoverscriptBox["\[Sum]", 
              RowBox[{"i", "=", "0"}], 
              RowBox[{"r", "-", "1"}]], 
             RowBox[{
              FractionBox["1", 
               RowBox[{"i", "!"}]], "*", 
              SuperscriptBox[
               RowBox[{"(", 
                FractionBox["a", "\[Mu]"], ")"}], "i"], "*", 
              RowBox[{"Exp", "[", 
               FractionBox[
                RowBox[{"-", "a"}], "\[Mu]"], "]"}]}]}]}], 
           RowBox[{"a", ">", "0"}]},
          {"0", 
           RowBox[{"a", "\[Equal]", "0"}]}
         },
         AllowedDimensions->{2, Automatic},
         Editable->True,
         GridBoxAlignment->{
          "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxItemSize->{
          "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{1.}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.84]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}},
         Selectable->True]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
        "RowsIndexed" -> {}},
      GridBoxItemSize->{
       "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.35]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     "Piecewise",
     DeleteWithContents->True,
     Editable->False,
     SelectWithContents->True,
     Selectable->False]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"p", "[", 
    RowBox[{"a_", ",", "k_", ",", "j_", ",", "\[Mu]_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"p", "[", 
     RowBox[{"a", ",", "k", ",", "j", ",", "\[Mu]"}], "]"}], "=", 
    TagBox[GridBox[{
       {"\[Piecewise]", GridBox[{
          {
           RowBox[{"Boole", "[", 
            RowBox[{"j", "\[Equal]", "1"}], "]"}], 
           RowBox[{"k", "\[Equal]", "0"}]},
          {
           RowBox[{"F", "[", 
            RowBox[{"a", ",", "k", ",", "\[Mu]"}], "]"}], 
           RowBox[{
            RowBox[{"k", "\[GreaterEqual]", "1"}], "&&", 
            RowBox[{"j", "\[Equal]", "1"}]}]},
          {
           RowBox[{
            RowBox[{"F", "[", 
             RowBox[{"a", ",", 
              RowBox[{"k", "-", "j", "+", "1"}], ",", "\[Mu]"}], "]"}], "-", 
            RowBox[{"F", "[", 
             RowBox[{"a", ",", 
              RowBox[{"k", "-", "j", "+", "2"}], ",", "\[Mu]"}], "]"}]}], 
           RowBox[{
            RowBox[{"k", "\[GreaterEqual]", "1"}], "&&", 
            RowBox[{"2", "\[LessEqual]", "j"}], "&&", 
            RowBox[{"j", "\[LessEqual]", "k"}]}]},
          {
           RowBox[{"1", "-", 
            RowBox[{"F", "[", 
             RowBox[{"a", ",", "1", ",", "\[Mu]"}], "]"}]}], 
           RowBox[{
            RowBox[{"k", "\[GreaterEqual]", "1"}], "&&", 
            RowBox[{"j", "\[Equal]", 
             RowBox[{"(", 
              RowBox[{"k", "+", "1"}], ")"}]}]}]}
         },
         AllowedDimensions->{2, Automatic},
         Editable->True,
         GridBoxAlignment->{
          "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxItemSize->{
          "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{1.}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.84]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}},
         Selectable->True]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
        "RowsIndexed" -> {}},
      GridBoxItemSize->{
       "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.35]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     "Piecewise",
     DeleteWithContents->True,
     Editable->False,
     SelectWithContents->True,
     Selectable->False]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"G", "[", 
    RowBox[{"a_", ",", "r_", ",", "\[Mu]_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"G", "[", 
     RowBox[{"a", ",", "r", ",", "\[Mu]"}], "]"}], "=", 
    TagBox[GridBox[{
       {"\[Piecewise]", GridBox[{
          {
           RowBox[{"\[Mu]", "*", "r", "*", 
            FractionBox[
             RowBox[{"F", "[", 
              RowBox[{"a", ",", 
               RowBox[{"r", "+", "1"}], ",", "\[Mu]"}], "]"}], 
             RowBox[{"F", "[", 
              RowBox[{"a", ",", "r", ",", "\[Mu]"}], "]"}]]}], 
           RowBox[{"a", ">", "0"}]},
          {"0", 
           RowBox[{"a", "\[Equal]", "0"}]}
         },
         AllowedDimensions->{2, Automatic},
         Editable->True,
         GridBoxAlignment->{
          "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxItemSize->{
          "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{1.}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.84]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}},
         Selectable->True]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
        "RowsIndexed" -> {}},
      GridBoxItemSize->{
       "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.35]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     "Piecewise",
     DeleteWithContents->True,
     Editable->False,
     SelectWithContents->True,
     Selectable->False]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"R", "[", 
    RowBox[{"a_", ",", "k_", ",", "j_", ",", "\[Gamma]_", ",", "\[Mu]_"}], 
    "]"}], ":=", 
   RowBox[{
    RowBox[{"R", "[", 
     RowBox[{"a", ",", "k", ",", "j", ",", "\[Gamma]", ",", "\[Mu]"}], "]"}], 
    "=", 
    TagBox[GridBox[{
       {"\[Piecewise]", GridBox[{
          {
           RowBox[{"\[Gamma]", "*", "a"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"k", "\[Equal]", "0"}], "||", 
             RowBox[{"k", "\[Equal]", "1"}]}], ")"}]},
          {
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "\[Gamma]"}], ")"}], "*", 
             FractionBox[
              RowBox[{
               RowBox[{"G", "[", 
                RowBox[{"a", ",", "k", ",", "\[Mu]"}], "]"}], "*", 
               RowBox[{"(", 
                RowBox[{"k", "-", "1"}], ")"}]}], "2"]}], "+", 
            RowBox[{"\[Gamma]", "*", "a"}]}], 
           RowBox[{
            RowBox[{"k", "\[GreaterEqual]", "2"}], "&&", 
            RowBox[{"j", "\[Equal]", "1"}]}]},
          {
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "\[Gamma]"}], ")"}], "*", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"a", "*", 
                RowBox[{"(", 
                 RowBox[{"j", "-", "2"}], ")"}]}], "+", 
               FractionBox[
                RowBox[{
                 RowBox[{"G", "[", 
                  RowBox[{"a", ",", 
                   RowBox[{"k", "-", 
                    RowBox[{"(", 
                    RowBox[{"j", "-", "1"}], ")"}]}], ",", "\[Mu]"}], "]"}], 
                 "*", 
                 RowBox[{"(", 
                  RowBox[{"k", "-", 
                   RowBox[{"(", 
                    RowBox[{"j", "-", "2"}], ")"}]}], ")"}]}], "2"]}], 
              ")"}]}], "+", 
            RowBox[{"\[Gamma]", "*", "a"}]}], 
           RowBox[{
            RowBox[{"k", "\[GreaterEqual]", "2"}], "&&", 
            RowBox[{"2", "\[LessEqual]", "j"}], "&&", 
            RowBox[{"j", "\[LessEqual]", "k"}]}]},
          {
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "\[Gamma]"}], ")"}], "*", "a", "*", 
             RowBox[{"(", 
              RowBox[{"j", "-", "2"}], ")"}]}], "+", 
            RowBox[{"\[Gamma]", "*", "a"}]}], 
           RowBox[{
            RowBox[{"k", "\[GreaterEqual]", "2"}], "&&", 
            RowBox[{"j", "==", 
             RowBox[{"(", 
              RowBox[{"k", "+", "1"}], ")"}]}]}]}
         },
         AllowedDimensions->{2, Automatic},
         Editable->True,
         GridBoxAlignment->{
          "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxItemSize->{
          "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{1.}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.84]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}},
         Selectable->True]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
        "RowsIndexed" -> {}},
      GridBoxItemSize->{
       "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.35]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     "Piecewise",
     DeleteWithContents->True,
     Editable->False,
     SelectWithContents->True,
     Selectable->False]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Cost", "[", 
    RowBox[{"a_", ",", "n_", ",", "k_", ",", "\[Gamma]_", ",", "\[Mu]_"}], 
    "]"}], ":=", 
   RowBox[{
    RowBox[{"Cost", "[", 
     RowBox[{"a", ",", "n", ",", "k", ",", "\[Gamma]", ",", "\[Mu]"}], "]"}], 
    "=", 
    RowBox[{
     UnderoverscriptBox["\[Sum]", 
      RowBox[{"j", "=", "1"}], 
      RowBox[{"k", "+", "1"}]], 
     RowBox[{
      RowBox[{"p", "[", 
       RowBox[{"a", ",", "k", ",", "j", ",", "\[Mu]"}], "]"}], "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"R", "[", 
         RowBox[{"a", ",", "k", ",", "j", ",", "\[Gamma]", ",", "\[Mu]"}], 
         "]"}], "+", 
        RowBox[{"OptimalCost", "[", 
         RowBox[{
          RowBox[{"n", "-", "1"}], ",", "j", ",", "\[Gamma]", ",", "\[Mu]"}], 
         "]"}]}], ")"}]}]}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.669940990429265*^9, 3.669940992349835*^9}, {
   3.669941042398069*^9, 3.669941159981086*^9}, {3.67011874232135*^9, 
   3.67011874789062*^9}, 3.670119420755623*^9, {3.670119504506112*^9, 
   3.6701195075542107`*^9}, {3.670122774332747*^9, 3.670122816205921*^9}, {
   3.670125565768889*^9, 3.670125566914225*^9}, {3.6701258209150352`*^9, 
   3.670125849939736*^9}, {3.6701260967364492`*^9, 3.6701261115096273`*^9}, {
   3.670127577952091*^9, 3.6701275929497643`*^9}, {3.670539905606686*^9, 
   3.670539954188632*^9}, {3.670540023646208*^9, 3.670540029089903*^9}, {
   3.680854203011239*^9, 3.6808542692845984`*^9}, {3.680854352688651*^9, 
   3.680854379695271*^9}, {3.680854423313044*^9, 3.680854454011541*^9}, {
   3.6808546692418127`*^9, 3.680854718922879*^9}, {3.680854787536099*^9, 
   3.680855026300568*^9}, {3.68085666129111*^9, 3.680856667837531*^9}, {
   3.6809460100630283`*^9, 3.680946030860652*^9}, {3.680946107207241*^9, 
   3.680946162775567*^9}, {3.680946285640839*^9, 3.680946286904187*^9}, {
   3.6809463232793303`*^9, 3.680946339002398*^9}, {3.6809464379122763`*^9, 
   3.680946472601396*^9}, {3.680946640915572*^9, 3.680946642038453*^9}, {
   3.680946693917694*^9, 3.680946711345537*^9}, {3.680946966227248*^9, 
   3.6809469710655622`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "PossiblePolicies", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PossiblePolicies", "[", 
    RowBox[{"n_", ",", "k_", ",", "\[Gamma]_", ",", "\[Mu]_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"PossiblePolicies", "[", 
     RowBox[{"n", ",", "k", ",", "\[Gamma]", ",", "\[Mu]"}], "]"}], "=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"sol", ",", "result"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"sol", "=", 
        RowBox[{
         RowBox[{"NSolve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"D", "[", 
              RowBox[{
               RowBox[{"Cost", "[", 
                RowBox[{
                "a", ",", "n", ",", "k", ",", "\[Gamma]", ",", "\[Mu]"}], 
                "]"}], ",", "a"}], "]"}], "\[Equal]", "0"}], "&&", 
            RowBox[{"a", ">", "0"}]}], ",", "a"}], "]"}], "//", "Quiet"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "sol", "]"}], "\[Equal]", "0"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"result", "=", 
          RowBox[{"{", "0", "}"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"result", "=", 
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{"a", "/.", "sol"}]}], "}"}], "]"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "result"}]}], "\[IndentingNewLine]", "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6705429252157784`*^9, 3.6705430257982407`*^9}, {
  3.680856732389703*^9, 3.6808567481875896`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "OptimalPolicy", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"OptimalPolicy", "[", 
    RowBox[{"n_", ",", "k_", ",", "\[Gamma]_", ",", "\[Mu]_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"OptimalPolicy", "[", 
     RowBox[{"n", ",", "k", ",", "\[Gamma]", ",", "\[Mu]"}], "]"}], "=", 
    RowBox[{
     RowBox[{"PossiblePolicies", "[", 
      RowBox[{"n", ",", "k", ",", "\[Gamma]", ",", "\[Mu]"}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{"Ordering", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Cost", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"PossiblePolicies", "[", 
               RowBox[{"n", ",", "k", ",", "\[Gamma]", ",", "\[Mu]"}], "]"}], 
              "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", "n", ",", "k", ",", 
             "\[Gamma]", ",", "\[Mu]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"PossiblePolicies", "[", 
               RowBox[{"n", ",", "k", ",", "\[Gamma]", ",", "\[Mu]"}], "]"}], 
              "]"}]}], "}"}]}], "]"}], ",", "1"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.681016298512516*^9, 3.681016355001041*^9}, 
   3.68101707232943*^9, 3.6810718363619623`*^9, 3.681342054256401*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "OptimalCost", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"OptimalCost", "[", 
    RowBox[{"n_", ",", "k_", ",", "\[Gamma]_", ",", "\[Mu]_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"OptimalCost", "[", 
     RowBox[{"n", ",", "k", ",", "\[Gamma]", ",", "\[Mu]"}], "]"}], "=", 
    TagBox[GridBox[{
       {"\[Piecewise]", GridBox[{
          {
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "\[Gamma]"}], ")"}], "*", 
             FractionBox[
              RowBox[{"\[Mu]", "*", "k", "*", 
               RowBox[{"(", 
                RowBox[{"k", "-", "1"}], ")"}]}], "2"]}], "+", 
            RowBox[{"\[Gamma]", "*", "k", "*", "\[Mu]"}]}], 
           RowBox[{"n", "\[Equal]", "0"}]},
          {
           RowBox[{"Cost", "[", 
            RowBox[{
             RowBox[{"OptimalPolicy", "[", 
              RowBox[{"n", ",", "k", ",", "\[Gamma]", ",", "\[Mu]"}], "]"}], 
             ",", "n", ",", "k", ",", "\[Gamma]", ",", "\[Mu]"}], "]"}], 
           RowBox[{"n", "\[GreaterEqual]", "1"}]}
         },
         AllowedDimensions->{2, Automatic},
         Editable->True,
         GridBoxAlignment->{
          "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxItemSize->{
          "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{1.}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.84]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}},
         Selectable->True]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
        "RowsIndexed" -> {}},
      GridBoxItemSize->{
       "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.35]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     "Piecewise",
     DeleteWithContents->True,
     Editable->False,
     SelectWithContents->True,
     Selectable->False]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6705434386894627`*^9, 3.670543493499186*^9}, 
   3.6705446077790327`*^9, {3.680854083760241*^9, 3.680854154267329*^9}, {
   3.6808568365870733`*^9, 3.680856839921689*^9}, {3.6809047970011168`*^9, 
   3.68090479727159*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Cost", "[", 
   RowBox[{"a", ",", "1", ",", "1", ",", "\[Gamma]", ",", "\[Mu]"}], "]"}], "//",
   "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.6809042413892736`*^9, 3.680904279234866*^9}, 
   3.6809097898586884`*^9, {3.681008400131878*^9, 3.681008414529977*^9}}],

Cell[BoxData[
 TagBox[GridBox[{
    {"\[Piecewise]", GridBox[{
       {
        RowBox[{"\[Mu]", "+", 
         RowBox[{"\[Gamma]", " ", 
          RowBox[{"(", 
           RowBox[{"a", "+", "\[Mu]"}], ")"}]}]}], 
        RowBox[{"a", "\[LessEqual]", "0"}]},
       {
        RowBox[{
         RowBox[{"a", " ", "\[Gamma]"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{"-", 
              FractionBox["a", "\[Mu]"]}]], "+", "\[Gamma]"}], ")"}], " ", 
          "\[Mu]"}]}], 
        TagBox["True",
         "PiecewiseDefault",
         AutoDelete->True]}
      },
      AllowedDimensions->{2, Automatic},
      Editable->True,
      GridBoxAlignment->{
       "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
        "RowsIndexed" -> {}},
      GridBoxItemSize->{
       "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.84]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}},
      Selectable->True]}
   },
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}},
   GridBoxItemSize->{
    "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
     "RowsIndexed" -> {}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.35]}, 
       Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}, "RowsIndexed" -> {}}],
  "Piecewise",
  DeleteWithContents->True,
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellChangeTimes->{3.68117955782515*^9, 3.681257368936445*^9, 
  3.681336518802549*^9, 3.681342064954368*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Limit", "[", 
    RowBox[{
     RowBox[{"Assuming", "[", 
      RowBox[{
       RowBox[{"a", ">", "0"}], ",", 
       RowBox[{"FullSimplify", "[", 
        RowBox[{"F", "[", 
         RowBox[{"a", ",", "r", ",", "\[Mu]"}], "]"}], "]"}]}], "]"}], ",", 
     RowBox[{"a", "\[Rule]", "0"}]}], "]"}], "\[Equal]", 
   RowBox[{"F", "[", 
    RowBox[{"0", ",", "r", ",", "\[Mu]"}], "]"}]}], "//", 
  "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{"Assuming", "[", 
  RowBox[{
   RowBox[{"r", "\[GreaterEqual]", "1"}], ",", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"Gamma", "[", 
      RowBox[{"r", ",", "0"}], "]"}], "\[Equal]", 
     RowBox[{"Gamma", "[", "r", "]"}]}], "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.681177726472396*^9, 3.6811777272871313`*^9}, {
  3.681179247437306*^9, 3.681179267946499*^9}, {3.681179414008627*^9, 
  3.6811795283945627`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Limit", "[", 
   RowBox[{
    RowBox[{"1", "-", 
     FractionBox[
      RowBox[{"Gamma", "[", 
       RowBox[{"r", ",", 
        FractionBox["a", "\[Mu]"]}], "]"}], 
      RowBox[{"Gamma", "[", "r", "]"}]]}], ",", 
    RowBox[{"a", "\[Rule]", "0"}]}], "]"}], "\[Equal]", "0"}]], "Output",
 CellChangeTimes->{3.681179576188994*^9, 3.6812573912686167`*^9, 
  3.681342087505954*^9}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.681179576188994*^9, 3.6812573912686167`*^9, 
  3.6813420875139627`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Mu]", " ", "=", " ", "1"}], ";"}]], "Input",
 CellChangeTimes->{{3.6812573825827436`*^9, 3.681257397271388*^9}, 
   3.681341929903585*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"OptimalCost", "[", 
       RowBox[{"n", ",", "0", ",", "\[Gamma]", ",", "\[Mu]"}], "]"}], ",", 
      " ", 
      RowBox[{"{", 
       RowBox[{
       "\[Gamma]", ",", " ", "0.05", ",", " ", "0.95", ",", " ", "0.05"}], 
       "}"}]}], "]"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"n", ",", " ", "1", ",", " ", "6"}], "}"}]}], "]"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.6812573994668694`*^9, 3.6812574327716093`*^9}, {
  3.6812574811981564`*^9, 3.681257496730484*^9}, {3.68127622357425*^9, 
  3.681276227738142*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.05`", "0.1`", "0.15000000000000002`", "0.2`", "0.25`", "0.3`", 
      "0.35000000000000003`", "0.4`", "0.45`", "0.5`", "0.55`", 
      "0.6000000000000001`", "0.6500000000000001`", "0.7000000000000001`", 
      "0.7500000000000001`", "0.8`", "0.8500000000000001`", 
      "0.9000000000000001`", "0.9500000000000001`"},
     {"0.2497866136776996`", "0.43025850929940457`", "0.5845679977328821`", 
      "0.7218875824868202`", "0.8465735902799727`", "0.9611918412977807`", 
      "1.0674377435745375`", "1.166516292749662`", "1.2593284632979973`", 
      "1.3465735902799727`", "1.4288103504155916`", "1.5064953742595946`", 
      "1.5800088954600955`", "1.6496724607571127`", "1.7157615543388358`", 
      "1.7785148410513678`", "1.8381410900731088`", "1.894824464092044`", 
      "1.9487286296681732`"},
     {"0.4487422594427639`", "0.7608002253432484`", "1.0229122386743768`", 
      "1.2532252997708557`", "1.460104304195588`", "1.6482735980511463`", 
      "1.820687266505388`", "1.979299938912511`", "2.125442286128438`", 
      "2.260024369120754`", "2.383653513585373`", "2.4967050669084934`", 
      "2.5993643325478786`", "2.6916482952205336`", "2.773409902841764`", 
      "2.8443222706940867`", "2.903831264667646`", "2.951041055593979`", 
      "2.9843990954867676`"},
     {"0.6476057905860826`", "1.0911232495721652`", "1.4608966439936757`", 
      "1.7840527447612584`", "2.072994410041769`", "2.334661125367414`", 
      "2.573344639928775`", "2.7918433484642513`", "2.992018575778555`", 
      "3.1750893754294105`", "3.3417958067078244`", "3.492487027293379`", 
      "3.627159232965218`", "3.745452009036888`", "3.8465990479586485`", 
      "3.9293124037968172`", "3.991543434239171`", "4.0299557602297`", 
      "4.038479772019613`"},
     {"0.8464636958604252`", "1.4214309371272609`", "1.8988546353641547`", 
      "2.3148419774969504`", "2.6858336965526197`", "3.0209839141844466`", 
      "3.325921995686368`", "3.604292103821039`", "3.8584924769680473`", 
      "4.09006435256164`", "4.299903631873898`", "4.488369349487032`", 
      "4.655320170612422`", "4.800086171680167`", "4.921362033308987`", 
      "5.016975030112725`", "5.083404568282293`", "5.1146896856913395`", 
      "5.099279945851459`"},
     {"1.0453212743425766`", "1.7517375956910237`", "2.3368106646186395`", 
      "2.8456281073028338`", "3.2986685420336523`", "3.7073007540481067`", 
      "4.078491761993845`", "4.416731538777065`", "4.7249553552299375`", 
      "5.005027094004314`", "5.257999926921036`", "5.484246370533081`", 
      "5.68349543408816`", "5.854783172610205`", "5.996293274896983`", 
      "6.105015036397313`", "6.176025822250047`", "6.200816810361133`", 
      "6.162279243493822`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.681257597564945*^9, 3.6812773662387743`*^9, 
  3.6813433172292347`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"output", " ", "=", " ", "\"\<[\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"n", "=", "1"}], ",", 
    RowBox[{"n", "\[LessEqual]", "5"}], ",", 
    RowBox[{"n", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"\[Gamma]", "=", "0.05"}], ",", 
       RowBox[{"\[Gamma]", "\[LessEqual]", "0.9"}], ",", 
       RowBox[{"\[Gamma]", "+=", "0.05"}], ",", "\[IndentingNewLine]", 
       RowBox[{"output", " ", "=", " ", 
        RowBox[{"StringJoin", "[", 
         RowBox[{"{", 
          RowBox[{"output", ",", 
           RowBox[{"ToString", "[", 
            RowBox[{"OptimalCost", "[", 
             RowBox[{"n", ",", "0", ",", "\[Gamma]", ",", "\[Mu]"}], "]"}], 
            "]"}], ",", "\"\<, \>\""}], "}"}], "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"output", " ", "=", " ", 
      RowBox[{"StringJoin", "[", 
       RowBox[{"{", 
        RowBox[{"output", ",", " ", 
         RowBox[{"ToString", "[", 
          RowBox[{"OptimalCost", "[", 
           RowBox[{"n", ",", " ", "0", ",", " ", "0.95", ",", " ", "\[Mu]"}], 
           "]"}], "]"}], ",", " ", "\"\<; \>\""}], "}"}], "]"}]}]}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"\[Gamma]", "=", "0.05"}], ",", 
    RowBox[{"\[Gamma]", "\[LessEqual]", "0.9"}], ",", 
    RowBox[{"\[Gamma]", "+=", "0.05"}], ",", "\[IndentingNewLine]", 
    RowBox[{"output", "=", 
     RowBox[{"StringJoin", "[", 
      RowBox[{"{", 
       RowBox[{"output", ",", " ", 
        RowBox[{"ToString", "[", 
         RowBox[{"OptimalCost", "[", 
          RowBox[{"6", ",", "0", ",", "\[Gamma]", ",", "\[Mu]"}], "]"}], 
         "]"}], ",", " ", "\"\<, \>\""}], "}"}], "]"}]}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"output", " ", "=", " ", 
   RowBox[{"StringJoin", "[", 
    RowBox[{"{", 
     RowBox[{"output", ",", " ", 
      RowBox[{"ToString", "[", 
       RowBox[{"OptimalCost", "[", 
        RowBox[{"6", ",", "0", ",", "0.95", ",", "\[Mu]"}], "]"}], "]"}], ",",
       " ", "\"\<]\>\""}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "output", "]"}]}], "Input",
 CellChangeTimes->{{3.681279982789009*^9, 3.6812801091410418`*^9}, {
  3.681291716043075*^9, 3.681291966873251*^9}}],

Cell[BoxData["\<\"[0.05, 0.1, 0.15, 0.2, 0.25, 0.3, 0.35, 0.4, 0.45, 0.5, \
0.55, 0.6, 0.65, 0.7, 0.75, 0.8, 0.85, 0.9, 0.95; 0.249787, 0.430259, \
0.584568, 0.721888, 0.846574, 0.961192, 1.06744, 1.16652, 1.25933, 1.34657, \
1.42881, 1.5065, 1.58001, 1.64967, 1.71576, 1.77851, 1.83814, 1.89482, \
1.94873; 0.448742, 0.7608, 1.02291, 1.25323, 1.4601, 1.64827, 1.82069, \
1.9793, 2.12544, 2.26002, 2.38365, 2.49671, 2.59936, 2.69165, 2.77341, \
2.84432, 2.90383, 2.95104, 2.9844; 0.647606, 1.09112, 1.4609, 1.78405, \
2.07299, 2.33466, 2.57334, 2.79184, 2.99202, 3.17509, 3.3418, 3.49249, \
3.62716, 3.74545, 3.8466, 3.92931, 3.99154, 4.02996, 4.03848; 0.846464, \
1.42143, 1.89885, 2.31484, 2.68583, 3.02098, 3.32592, 3.60429, 3.85849, \
4.09006, 4.2999, 4.48837, 4.65532, 4.80009, 4.92136, 5.01698, 5.0834, \
5.11469, 5.09928; 1.04532, 1.75174, 2.33681, 2.84563, 3.29867, 3.7073, \
4.07849, 4.41673, 4.72496, 5.00503, 5.258, 5.48425, 5.6835, 5.85478, 5.99629, \
6.10502, 6.17603, 6.20082, 6.16228]\"\>"], "Print",
 CellChangeTimes->{3.6812919678032312`*^9, 3.681343761380251*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Mu]", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Gamma]", "=", "0.5"}], ";"}]}], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"OptimalPolicy", "[", 
   RowBox[{"1", ",", "1", ",", "\[Gamma]", ",", "\[Mu]"}], "]"}], "\[Equal]", 
  
  RowBox[{
   RowBox[{"-", "\[Mu]"}], "*", 
   RowBox[{"Log", "[", "\[Gamma]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.680905506164727*^9, 3.680905531736383*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.68117964306098*^9, 3.681344725221663*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"num", "=", "6"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{"OptimalCost", "[", 
    RowBox[{"n", ",", "0", ",", "\[Gamma]", ",", "\[Mu]"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"n", ",", "0", ",", "num"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"n", "+", "k"}], "\[LessEqual]", "num"}], ",", 
        RowBox[{"OptimalCost", "[", 
         RowBox[{"n", ",", "k", ",", "\[Gamma]", ",", "\[Mu]"}], "]"}], ",", 
        "0"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "0", ",", "num"}], "}"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"n", ",", "0", ",", "num"}], "}"}]}], "]"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"n", "+", "k"}], "\[LessEqual]", "num"}], ",", 
        RowBox[{"OptimalPolicy", "[", 
         RowBox[{"n", ",", "k", ",", "\[Gamma]", ",", "\[Mu]"}], "]"}], ",", 
        "0"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "0", ",", "num"}], "}"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"n", ",", "1", ",", "num"}], "}"}]}], "]"}], "//", 
  "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.6704760892990427`*^9, 3.670476089332934*^9}, 
   3.6705446154046926`*^9, {3.68085686013916*^9, 3.68085687561231*^9}, {
   3.680857419477059*^9, 3.6808574195051413`*^9}, {3.680857473296444*^9, 
   3.6808574733375874`*^9}, {3.6809054674804077`*^9, 
   3.6809054721962748`*^9}, {3.680905542053706*^9, 3.6809055623140173`*^9}, {
   3.680909537995883*^9, 3.6809095380743237`*^9}, {3.68100038732311*^9, 
   3.681000393552916*^9}, 3.681015817152535*^9, {3.681016658378229*^9, 
   3.681016658449277*^9}, {3.6810174344310017`*^9, 3.681017437077866*^9}, 
   3.681177743487032*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.`", ",", "0.5`", ",", "1.3465735902799727`", ",", "2.260024369120754`", 
   ",", "3.1750893754294105`", ",", "4.09006435256164`", ",", 
   "5.005027094004314`"}], "}"}]], "Output",
 CellChangeTimes->{3.681179674516*^9, 3.681344728143999*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.`", "0.5`", "1.5`", "3.`", "5.`", "7.5`", "10.5`"},
     {"0.5`", "1.3465735902799727`", "2.489685600977099`", 
      "4.024747397234465`", "5.980256593421476`", "8.370887093172984`", "0"},
     {"1.3465735902799727`", "2.260024369120754`", "3.406832829130295`", 
      "4.940607198478861`", "6.893747390631514`", "0", "0"},
     {"2.260024369120754`", "3.1750893754294105`", "4.321691361585831`", 
      "5.855272245331906`", "0", "0", "0"},
     {"3.1750893754294105`", "4.09006435256164`", "5.236638280129483`", "0", 
      "0", "0", "0"},
     {"4.09006435256164`", "5.005027094004314`", "0", "0", "0", "0", "0"},
     {"5.005027094004314`", "0", "0", "0", "0", "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.681179674516*^9, 3.681344728151023*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0.6931471805599453`", "1.7571124685678317`", 
      "2.8257748622620933`", "3.855047960761582`", "4.849203268544318`", 
      "0"},
     {"0", "0.8269015576815626`", "1.9022303245886247`", 
      "2.9522348291711746`", "3.958717883292117`", "0", "0"},
     {"0", "0.8301300126173135`", "1.9048117914961584`", 
      "2.9540296182730703`", "0", "0", "0"},
     {"0", "0.8299499542644568`", "1.9045486045297464`", "0", "0", "0", "0"},
     {"0", "0.8299254828853426`", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.681179674516*^9, 3.6813447281578407`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TeXForm", "[", 
  RowBox[{"MatrixForm", "[", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"n", "+", "k"}], "\[LessEqual]", "num"}], ",", 
         RowBox[{"OptimalCost", "[", 
          RowBox[{"n", ",", "k", ",", "\[Gamma]", ",", "\[Mu]"}], "]"}], ",", 
         "0"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "0", ",", "num"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", "0", ",", "num"}], "}"}]}], "]"}], "]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.670539860603891*^9, 3.670539901113492*^9}, {
  3.670540104616185*^9, 3.670540105714847*^9}, {3.6808568812877083`*^9, 
  3.680856883770735*^9}}],

Cell["\<\
\\left(
\\begin{array}{ccccccc}
 0. & 0.5 & 1.5 & 3. & 5. & 7.5 & 10.5 \\\\
 0.5 & 1.34657 & 2.48969 & 4.02475 & 5.98026 & 8.37089 & 0 \\\\
 1.34657 & 2.26002 & 3.40683 & 4.94061 & 6.89375 & 0 & 0 \\\\
 2.26002 & 3.17509 & 4.32169 & 5.85527 & 0 & 0 & 0 \\\\
 3.17509 & 4.09006 & 5.23664 & 0 & 0 & 0 & 0 \\\\
 4.09006 & 5.00503 & 0 & 0 & 0 & 0 & 0 \\\\
 5.00503 & 0 & 0 & 0 & 0 & 0 & 0 \\\\
\\end{array}
\\right)\
\>", "Output",
 CellChangeTimes->{3.681179675101001*^9, 3.681344734106827*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TeXForm", "[", 
  RowBox[{"MatrixForm", "[", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"n", "+", "k"}], "\[LessEqual]", "num"}], ",", 
         RowBox[{"OptimalPolicy", "[", 
          RowBox[{"n", ",", "k", ",", "\[Gamma]", ",", "\[Mu]"}], "]"}], ",", 
         "0"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "0", ",", "num"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", "1", ",", "num"}], "}"}]}], "]"}], "]"}], 
  "]"}]], "Input",
 CellChangeTimes->{
  3.670544618954814*^9, {3.6808568917144527`*^9, 3.680856903321348*^9}}],

Cell["\<\
\\left(
\\begin{array}{ccccccc}
 0 & 0.693147 & 1.75711 & 2.82577 & 3.85505 & 4.8492 & 0 \\\\
 0 & 0.826902 & 1.90223 & 2.95223 & 3.95872 & 0 & 0 \\\\
 0 & 0.83013 & 1.90481 & 2.95403 & 0 & 0 & 0 \\\\
 0 & 0.82995 & 1.90455 & 0 & 0 & 0 & 0 \\\\
 0 & 0.829925 & 0 & 0 & 0 & 0 & 0 \\\\
 0 & 0 & 0 & 0 & 0 & 0 & 0 \\\\
\\end{array}
\\right)\
\>", "Output",
 CellChangeTimes->{3.681179675136506*^9, 3.681344737786298*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"Cost", "[", 
    RowBox[{"a", ",", "3", ",", "2", ",", "\[Gamma]", ",", "\[Mu]"}], "]"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"a", ",", "0", ",", "8"}], "}"}], ",", 
   RowBox[{"AxesLabel", "\[Rule]", "Automatic"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.670138358869254*^9, 3.6701383591862383`*^9}, {
   3.670141343206565*^9, 3.670141368071753*^9}, {3.670476245003521*^9, 
   3.670476245744802*^9}, {3.6808569121393747`*^9, 3.680856914621797*^9}, 
   3.6809097008441763`*^9, {3.6809099307267733`*^9, 3.680909932677642*^9}}],

Cell[BoxData[
 GraphicsBox[{{}, {}, 
   {RGBColor[0.368417, 0.506779, 0.709798], AbsoluteThickness[1.6], Opacity[
    1.], LineBox[CompressedData["
1:eJwV1nk4lN0bB/CZQZYoj2GYISNR2bKEQjl3Gz8K2aIaKksqayqlN0losaVI
1hKRhESvKFsRImRNZYl4S5Hs68z8jr+e63NdZ57rOfecc9/ftU7eVq4UEokk
SCaRlp+mrj9bKodDDd31iq5uqqLCj7wDTn10F/S08Qjj0xsq0FZ2RBXSzyKN
UsfQwEoqbNITz0ihh6CBW3afm8uooP9xc/4deiz6/vhbrFcxFSqTqnQi6Y+Q
UEandkYuFYKDwi+E0V+gw22PK9j3qOBydox+k16NGiabAqM8qCAQa/Lw73g7
intdKnd5NRVeftQyNpbtQ61flAbPlIqBfXD3l6rwQRT+XPdyu48YeD8/oxY/
NYwymzXzBTeIwUR0Zx2ZPIa4/mPHhX4TUOrxHA3SxlB2ZDiL8YuA6/+LKKpR
HUP1D/JIKsMEyJB2Pgq3H0PSdxVtzX8QsMc7N1Aifwx10cmbU74T8GH9zqRY
9b+otMF24HA3AXJ8dKus3r9Ie4P/nEMTAXxnrkUmDP9FpzVYlJBGAn59m6wL
m/qL9ul2lmd/IODf0ibkKTSOzo5MWyzUE2B6NkRNS3ccZSqmdDysJeDs9zGB
0shxZF8rGiz2hoC6NzUVzdsm0LgmZfbiCwIyPywNRhpPIK8NViKvCwkI/aQl
tM9qAqUFqLQuFhCwc/S+TZ3bBGr4lecW+BzvV+r8cOWdCaS62a4qKo+AfO8N
1IKfEyjZXtK4KYuA+DU3jsfGTiJDed+KjykE+G0sD7d6MImKzoW+Wo9tu3kq
XzR7Eum5aLgGJBMgZnJ0MaJiEq2kHH6vmkRAxNmt0aG/JpE1r21jTDwBVxp+
lvjBFGo6e+Xd1RgCTvqbiBwcmUI09/hzgzcJyJYmHBxnplD8nLr1IeyRsq4c
Z9I0Wt8R8P7jDQK8KCf2eYlPo1wz1SsV13E9wq+FB2+bRrHB9hKPQgkITKkS
zIuYRtsUz325GUTA3TfbV/CozSCrieC0Wn8COp35DghsmUELNSnh+7GlVjRm
iOyYQflBscJfLhCQaMraI2U7g2J/j3f8OU9AatvFELWAGfRR0yaU6UfA06GX
FPvGGaSR5G6W4kvAG0Etbo7nLBL9ZKwh5EHARhuNl2EXZtEtZ9adFHcCou9v
8j4RPIvAXC9DE/voZpW+dQmzKC2O3HP4FAEclkJFYvUs4rUuulN8ggD9fFrg
Dek5FHXoKF+MKwFpC+Jbjq+fQwqf205pYgvuoY7t0pxDl9KaAj+6END1efUR
rtEceqfLUyyKfZ5HEPn5zqEpOscxwYmAFwcWOc7v51BGueWZhiP4/D6cL9rR
PoeyjubUnMUO/j3rxeybQ37isnWy2FZXpnq/TM2h7vDB9rOOBPx9MlpuKTeP
+k32UJUcCFBj911G5+dR/Ut+kYJD+LylV3MYigtIw6FYb88BAnxCbfqR+gLq
fhvvLoBt4DZY5aK3gP7k7NL6YEvAR2Xem3lmC2jb6oQAW+z557uoO/0WkMyq
ZEFvGwL2Vb7dcLJ2AdG3XOwvsyKAlmYlFNWygGwrwmzCsPuDB0YKvi6gmbjP
h+yw/YwpBUtjCyjidoPcpCX+v5p2bIuWWkSHS1RvaWJPdlfuf3lyEe2/MdH7
3oKA8vL9m7vPLKJ561z/B9g3Ur9JkC8vosRcUuY5bBkX0lfTO4volSVv4Tps
o9/ItffVIhKCoKRr5gSINjYb87xbRDEUnsqj2F/zjihvbF5EtIgd5wywfXwD
x05/x+udQ29PmOHzNF/uzye8hO7Y0qLcsF2+mrOUaUtIUt5TxwhbvazX0EJu
CSUcfOChiF19hcOToI3Xv1kXNrSPgFF+wyhVhyUUMXD9sgd28XCjj6XbEpIR
intogX21wcHa7/QSEh+Nt96MTbsVIFUZitevEHBZ2ksA0MrSrPPw+0RsN9/F
5r0r4b2neAmtyzi6OwC7juplsOXtEtpqMNrjim1BMNsZnUto76xU9lZsR+Eg
vgH2EqrpT08fNCVAPvxzSxs/G/1d83D6I/aQoNb9dwQbzZRsay7D9uD/rvtE
kY3YF7ulErD/oew54WPGRhS7eMoBbMOgFG0nOzaqQc5RRtgU0gzJ5hgbCWcP
pW7BDmNnJmw5x0ZvWckHpbHNL3FdlQLZiKQcxxXBJhbttKRvslH01VYVMnb8
nEADJ5mNfDVTaMMmBLDOH7v3N5ONHkf9be/BlpspcR7IZyONUFF6G/bjyVNL
76rZKD8NaVVgn/KtqnvZxEbDtlT+IuxN49J3n3SxkcrrbcdysYv+fFCLHGEj
99X0jBTsi56KC5dn2Aio0VFx2IYjATU+JA4iTw4u3cKmuHfecRLioLjY+bGb
2O+GNx2xEeegC83P3EKwb5y4rmIky0HvPYadA7H3/eib3bKRg/w23Bi8iC16
fGu1khYH7c7xHPbDbh+MjpbexkETCf/4nsGOdx5miRhxkGlQTKDP8n4Hdihx
LTjIaChO1Gt5v8cSp/8e5CCGgZuiB/b3vok3A84cZP9rqOwUdqbj3qh2Tw7i
NZv6fHJ5/z3ph2rOc1D2szP+y97EWlpfHMRBgZZ7kpc98cVm8kk4B/m4mO5c
/n3RwdyKpLschERc3N2X69HFFxH5gIOSnc9Iei7Xw87RPvAJB+n7HjTyxiZ3
FimcLuSgX7qzs6exq21WjzuVcdDzNDXVc8v1aHMrs6nloG8JPQMXluthVXnT
qIWDNKZ+SAcs16NF6sDWrxzUdkntU9ByPSxOyysPcdDtiSjx69j3mt7/kR7j
oB7+0bYI7ENm8q9F5jlo1GmjRAy27IeL17kULmpNWduVgD1g2mY9LsxFd4xK
ZB4u1+O9itx3Ghfp9zUPZGGr1XYX1yhzkXru4kQJNu2P+2i0DhfRNv0nXI1N
klhcexi46KDG0/Km5e9xooeP2XLR/Wj54SHs8ptZFSVHuUiqMPjYBHZW/pap
YHcukvsmc5qLfYlj6yAVxEWsrTa2y+f7uOLQ7YFwLqrLSVVSxt6/72xNThwX
eZcHxephKyTeUd+Rw0Umjx3UDmF/0Gkmn/rERad7lo6nYRexHHW1B7hIbNLr
97/YqcGjpzgjXOQjqMpXj/3qJ98pEzIJ2hz6Zyexo3QV2npoJNhakNNhju83
T7376E4ZEtzc9pt7HPuCQyF/1loSDLzYUB6I7RSyc5uvKgmMRiemC7B1Wo9m
rNhJghxlA3M53G+yXbMq3I1J0KvWSt2OLTs/9vnjPhJc66R5HMIWkAtclWRH
gigRUnscdrdnynl1TxLIbM+/RMP9LkTwi4l9PAlYYjbCmrh/zievdSlLIQG5
qPfnAWwvjZOX5dNJkF3taRuAbW83VzCSSwJ959GeBmzVDJpMUBUJFnaVP/bG
/bodrP88+UOCpOzBuZb9BCw8+J5SMEmCyN6cJDb2Wu4Zs9dzJHijElSihOeD
V1lszgcKGYxLKl2Dsfn1O0+N0cgw31t6aRueL/qbD/7QRmQIF0sNfWeN5/ed
4bjtu/F6/ci6Oezr4/5GRiZkWPAzD1HF86v9WWKGnTUZnvmUu97F9lTtdr7o
RoZ/pD0+eOB5l6p45FvFLTK0xOUIatkRUBMydqsulgyiA7T3Htij3wNRSwIZ
hFSluI+x9dNS7w+kk6H4m0UT056ANtkBFl8xGd7OpE+LHyRghZTrZ9NvZCgy
t/mfxGHcf4XcWzs0KLCB9Znkied5ZhmtyFSXAj/9xvxLsft83iZUGFCgp1DQ
X/gonvef6MeeGFGg9dptgTzsrY/qxi6xKDD8uNdt9hieF4brRRRuUMDV7Scn
DeeL5NP9xr59FLjSr27KwvmlUyFS5ccgBRoLeJRLsVd3bV3N+oUtIBomg/PO
VcPozj3TFChMlKrvxT6xErnSV/JAbG3H7pOeBGhnJF+t1OUB/p2uS3d9CGjo
sitbFcUD9WQNdTOcv65++SFxKoYH2jyG819hb+0+7/Uungde9admbcR57VHf
PealdB5Y031ong/nuUv/fQoaLuaBTD0t6ZqL+D5P2RlVf+eBaEENfdZlAm6t
tm/21+OFV0lCL3pxXrQ2su8fHOQFsZNCUpvj8H2hajZ/H+YFZVWdC4XY8v2C
ZQN/eKG7/q6O9j3cD/95Hf9tjhc8ez1rdXGejX4uu79bmA9s1z/bBYn4fsoM
lbdp8wF1UOuKy30Cdk+eTn4bwgc88+JS45kE6KaG26UqrIBrLRtMqSUEfOPE
tJ8I5IcTuWFO/YN4npo0p9OqBOCuq3d9q5gY5Cf0+besFYIQBzfuNRMxyLjB
c1Pp4kqIrD+i9iRYDKadD/06/loYDn4e0XEpE4OVu69ZPZdcBcZ6gcb2XDG4
JDok3M9aDXK5o0cKERWEy1VIn8xEQdWCfpgaRIXtfhbsqgVRMHMX9TKop0Ly
o4j0dTjH/5BxdbYRFQdHW+1Gwb1ioBTgVLjCURz+7XCNKZ8Rg5mSTMnmp+Kg
9yGf8l8cFcKCrmQFT4uD3J7j0zG7xWFY2v/+NSMJ0NHWuf3iP3F49NzbkC9G
AvomIt+nh0oAy0NB9d9eCRjZbBlK16KBLCdmS5AmDdb/VvtFbqOBypGHrqaB
NKhWONfqEyQJ86LKz6TbaXCrvcPZSkEKXHZ/3Fu4ThLGrCtvU6qlwHziZZeQ
ryQU2Ers0jtNxznKZsCiVhLSG4NTBsQYcMjo5Wo5SSmYrWX9I/aWARvCZg3a
PKXg2+2KaVEvaYidutIjWyUFMy0G9KurZEA2nanQIkYHn1j5Sv9SGVAiZo0O
nqSDZKO86KDjGpiWS0vSe0UH646cJRnOGuBpMKyOFWTAxJGHHt3ZsvBTvplU
foQBFUefha7ax4S2T3OvNfIZ8KrZY2+vORMc3gasjH/OgCJDZSLPkglGPtWH
uQUMyJHJSDazY8LIzlhO478MSOxKLIxwYoKzjLKZ+2sGnNt/rV/InwmKhjEi
mTUMUAGH7fyZTOhWSKHJ9DBg/TMGz6csJohkrQgI7mWAvGxXXeZTJnw9JjP4
q48BUktWNkbPmfDgt8mLkgEGrCj+n3toKRNKY5NYdj8Z0K+uncDTxoTstogP
dyYZ0H1/3LGtgwlZOl7bF6YY0CXyTCG9iwlVreN5x2YY0PRbKX9nLxMkLHti
NOYZUPqYWRs0zAR6gLZrE4cBxbSeCMsRJlxuo33VIUlDYWii1doxJpjdi7NM
IUtDtrNEb+UUEzIFPcCDVxoyWlvTo2eZkBRWWdzGJw2pO6JPHl1gQteafE0D
fmlIzjdT12AzoVZN/2magDTcY66c5nLx+xQdFYWEpOH/RyNROg==
     "]]}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{
    FormBox[
     TagBox["a", HoldForm], TraditionalForm], None},
  AxesOrigin->{0, 4.2},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{
   "DefaultBoundaryStyle" -> Automatic, "DefaultMeshStyle" -> 
    AbsolutePointSize[6], "ScalingFunctions" -> None},
  PlotRange->{{0, 8}, {4.3216914154872175`, 6.759804328795622}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{3.6811796753923883`*^9, 3.6813447418718843`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Cost", "[", 
   RowBox[{"a", ",", "3", ",", "2", ",", "\[Gamma]", ",", "\[Mu]"}], "]"}], "//",
   "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.681014794368965*^9, 3.681014817454718*^9}}],

Cell[BoxData[
 TagBox[GridBox[{
    {"\[Piecewise]", GridBox[{
       {
        RowBox[{"4.940607198478861`", "\[VeryThinSpace]", "+", 
         RowBox[{"1.`", " ", "a"}]}], 
        RowBox[{"a", "\[LessEqual]", "0"}]},
       {
        RowBox[{"2.760024369120754`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.5`", " ", "a"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"2.180582829358107`", "\[VeryThinSpace]", "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1.6468084600095412`", "\[VeryThinSpace]", "+", 
               RowBox[{"0.25`", " ", "a"}]}], ")"}], " ", "a"}]}], ")"}], " ", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"-", "a"}]]}], "-", 
         FractionBox[
          RowBox[{"0.5`", " ", 
           SuperscriptBox["a", "2"]}], 
          RowBox[{
           RowBox[{"-", "1.`"}], "+", 
           RowBox[{"1.`", " ", 
            SuperscriptBox["\[ExponentialE]", "a"]}]}]]}], 
        TagBox["True",
         "PiecewiseDefault",
         AutoDelete->True]}
      },
      AllowedDimensions->{2, Automatic},
      Editable->True,
      GridBoxAlignment->{
       "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
        "RowsIndexed" -> {}},
      GridBoxItemSize->{
       "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.84]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}},
      Selectable->True]}
   },
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}},
   GridBoxItemSize->{
    "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
     "RowsIndexed" -> {}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.35]}, 
       Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}, "RowsIndexed" -> {}}],
  "Piecewise",
  DeleteWithContents->True,
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellChangeTimes->{3.681179677139817*^9, 3.681344748743945*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Cost", "[", 
   RowBox[{"0", ",", "3", ",", "2", ",", "\[Gamma]", ",", "\[Mu]"}], "]"}], "==", 
  RowBox[{"Limit", "[", 
   RowBox[{
    RowBox[{"Cost", "[", 
     RowBox[{"a", ",", "3", ",", "2", ",", "\[Gamma]", ",", "\[Mu]"}], "]"}], 
    ",", 
    RowBox[{"a", "\[Rule]", "0"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6810147317191668`*^9, 3.681014748391487*^9}, {
  3.6810166011289053`*^9, 3.681016601675302*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.681179677425852*^9, 3.681344750739236*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Assuming", "[", 
  RowBox[{
   RowBox[{"a", ">", "0"}], ",", 
   RowBox[{
    RowBox[{"Cost", "[", 
     RowBox[{"a", ",", "3", ",", "2", ",", "\[Gamma]", ",", "\[Mu]"}], "]"}], 
    "//", "FullSimplify"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.67053589737744*^9, 3.670535920886181*^9}, {
  3.680856924389134*^9, 3.680856926772306*^9}, {3.6810148601943197`*^9, 
  3.681014922996269*^9}, {3.681016612529149*^9, 3.6810166130777903`*^9}}],

Cell[BoxData[
 RowBox[{"2.760024369120754`", "\[VeryThinSpace]", "+", 
  RowBox[{"0.5`", " ", "a"}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"2.180582829358107`", "\[VeryThinSpace]", "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1.6468084600095412`", "\[VeryThinSpace]", "+", 
        RowBox[{"0.25`", " ", "a"}]}], ")"}], " ", "a"}]}], ")"}], " ", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"-", "a"}]]}], "-", 
  FractionBox[
   RowBox[{"0.5`", " ", 
    SuperscriptBox["a", "2"]}], 
   RowBox[{
    RowBox[{"-", "1.`"}], "+", 
    RowBox[{"1.`", " ", 
     SuperscriptBox["\[ExponentialE]", "a"]}]}]]}]], "Output",
 CellChangeTimes->{3.681179677506955*^9, 3.6813447534421997`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TeXForm", "[", 
  RowBox[{"Assuming", "[", 
   RowBox[{
    RowBox[{"a", ">", "0"}], ",", 
    RowBox[{
     RowBox[{"Cost", "[", 
      RowBox[{"a", ",", "3", ",", "2", ",", "\[Gamma]", ",", "\[Mu]"}], "]"}],
      "//", "FullSimplify"}]}], "]"}], "]"}]], "Input"],

Cell["\<\
-\\frac{0.5 a^2}{1. e^a-1.}+0.5 a+((0.25 a+1.64681) a+2.18058) e^{-a}+2.76002\
\
\>", "Output",
 CellChangeTimes->{3.681179677535636*^9, 3.6813447567679768`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"PossiblePolicies", "[", 
  RowBox[{"3", ",", "2", ",", "\[Gamma]", ",", "\[Mu]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"OptimalPolicy", "[", 
  RowBox[{"3", ",", "2", ",", "\[Gamma]", ",", "\[Mu]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"OptimalCost", "[", 
  RowBox[{"3", ",", "2", ",", "\[Gamma]", ",", "\[Mu]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.67047699766227*^9, 3.6704770049219437`*^9}, 
   3.670544639254498*^9, {3.670544746880262*^9, 3.6705447541010323`*^9}, {
   3.680856931014089*^9, 3.680856941997087*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "1.9048117914961584`"}], "}"}]], "Output",
 CellChangeTimes->{3.681179677557475*^9, 3.681344759369947*^9}],

Cell[BoxData["1.9048117914961584`"], "Output",
 CellChangeTimes->{3.681179677557475*^9, 3.681344759375003*^9}],

Cell[BoxData["4.321691361585831`"], "Output",
 CellChangeTimes->{3.681179677557475*^9, 3.6813447593777723`*^9}]
}, Open  ]]
},
WindowSize->{1280, 778},
WindowMargins->{{-1280, Automatic}, {-344, Automatic}},
PrivateNotebookOptions->{"VersionedStylesheet"->{"Default.nb"[8.] -> False}},
Magnification:>1.25 Inherited,
FrontEndVersion->"10.3 for Mac OS X x86 (32-bit, 64-bit Kernel) (December 10, \
2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 13519, 351, 466, "Input"],
Cell[14079, 373, 1776, 46, 204, "Input"],
Cell[15858, 421, 1477, 36, 141, "Input"],
Cell[17338, 459, 2780, 69, 94, "Input"],
Cell[CellGroupData[{
Cell[20143, 532, 302, 6, 36, "Input"],
Cell[20448, 540, 2045, 59, 80, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[22530, 604, 929, 25, 57, "Input"],
Cell[23462, 631, 415, 12, 71, "Output"],
Cell[23880, 645, 124, 2, 35, "Output"]
}, Open  ]],
Cell[24019, 650, 175, 4, 35, "Input"],
Cell[CellGroupData[{
Cell[24219, 658, 658, 18, 36, "Input"],
Cell[24880, 678, 3355, 57, 160, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[28272, 740, 2401, 60, 204, "Input"],
Cell[30676, 802, 1081, 14, 160, "Print"]
}, Open  ]],
Cell[31772, 819, 150, 4, 57, "Input"],
Cell[CellGroupData[{
Cell[31947, 827, 304, 8, 36, "Input"],
Cell[32254, 837, 94, 1, 35, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[32385, 843, 2039, 52, 99, "Input"],
Cell[34427, 897, 286, 6, 35, "Output"],
Cell[34716, 905, 1298, 27, 182, "Output"],
Cell[36017, 934, 1161, 26, 160, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[37215, 965, 784, 21, 36, "Input"],
Cell[38002, 988, 501, 13, 232, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[38540, 1006, 713, 20, 36, "Input"],
Cell[39256, 1028, 427, 12, 214, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[39720, 1045, 589, 12, 35, "Input"],
Cell[40312, 1059, 6412, 117, 297, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[46761, 1181, 226, 5, 36, "Input"],
Cell[46990, 1188, 2404, 65, 72, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[49431, 1258, 457, 11, 35, "Input"],
Cell[49891, 1271, 95, 1, 35, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[50023, 1277, 462, 10, 36, "Input"],
Cell[50488, 1289, 707, 19, 59, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[51232, 1313, 289, 8, 36, "Input"],
Cell[51524, 1323, 171, 4, 49, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[51732, 1332, 562, 11, 78, "Input"],
Cell[52297, 1345, 155, 3, 35, "Output"],
Cell[52455, 1350, 110, 1, 35, "Output"],
Cell[52568, 1353, 111, 1, 69, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
