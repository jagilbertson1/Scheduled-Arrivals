(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     30552,        843]
NotebookOptionsPosition[     29320,        801]
NotebookOutlinePosition[     29790,        820]
CellTagsIndexPosition[     29747,        817]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"F", ",", "G", ",", "p", ",", "R", ",", "Cost"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"F", "[", 
    RowBox[{"a_", ",", "r_", ",", "\[Mu]_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"F", "[", 
     RowBox[{"a", ",", "r", ",", "\[Mu]"}], "]"}], "=", 
    TagBox[GridBox[{
       {"\[Piecewise]", GridBox[{
          {
           RowBox[{"1", "-", 
            RowBox[{
             UnderoverscriptBox["\[Sum]", 
              RowBox[{"i", "=", "0"}], 
              RowBox[{"r", "-", "1"}]], 
             RowBox[{
              FractionBox["1", 
               RowBox[{"i", "!"}]], "*", 
              SuperscriptBox[
               RowBox[{"(", 
                FractionBox["a", "\[Mu]"], ")"}], "i"], "*", 
              RowBox[{"Exp", "[", 
               FractionBox[
                RowBox[{"-", "a"}], "\[Mu]"], "]"}]}]}]}], 
           RowBox[{"a", ">", "0"}]},
          {"0", 
           RowBox[{"a", "\[Equal]", "0"}]}
         },
         AllowedDimensions->{2, Automatic},
         Editable->True,
         GridBoxAlignment->{
          "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxItemSize->{
          "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{1.}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.84]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}},
         Selectable->True]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
        "RowsIndexed" -> {}},
      GridBoxItemSize->{
       "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.35]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     "Piecewise",
     DeleteWithContents->True,
     Editable->False,
     SelectWithContents->True,
     Selectable->False]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"p", "[", 
    RowBox[{"a_", ",", "k_", ",", "j_", ",", "\[Mu]_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"p", "[", 
     RowBox[{"a", ",", "k", ",", "j", ",", "\[Mu]"}], "]"}], "=", 
    TagBox[GridBox[{
       {"\[Piecewise]", GridBox[{
          {
           RowBox[{"Boole", "[", 
            RowBox[{"j", "\[Equal]", 
             RowBox[{"k", "+", "1"}]}], "]"}], 
           RowBox[{"a", "\[Equal]", "0"}]},
          {
           RowBox[{"Boole", "[", 
            RowBox[{"j", "\[Equal]", "1"}], "]"}], 
           RowBox[{
            RowBox[{"a", ">", "0"}], "&&", 
            RowBox[{"k", "\[Equal]", "0"}]}]},
          {
           RowBox[{"F", "[", 
            RowBox[{"a", ",", "k", ",", "\[Mu]"}], "]"}], 
           RowBox[{
            RowBox[{"a", ">", "0"}], "&&", 
            RowBox[{"k", "\[GreaterEqual]", "1"}], "&&", 
            RowBox[{"j", "\[Equal]", "1"}]}]},
          {
           RowBox[{
            RowBox[{"F", "[", 
             RowBox[{"a", ",", 
              RowBox[{"k", "-", "j", "+", "1"}], ",", "\[Mu]"}], "]"}], "-", 
            RowBox[{"F", "[", 
             RowBox[{"a", ",", 
              RowBox[{"k", "-", "j", "+", "2"}], ",", "\[Mu]"}], "]"}]}], 
           RowBox[{
            RowBox[{"a", ">", "0"}], "&&", 
            RowBox[{"k", "\[GreaterEqual]", "1"}], "&&", 
            RowBox[{"2", "\[LessEqual]", "j"}], "&&", 
            RowBox[{"j", "\[LessEqual]", "k"}]}]},
          {
           RowBox[{"1", "-", 
            RowBox[{"F", "[", 
             RowBox[{"a", ",", "1", ",", "\[Mu]"}], "]"}]}], 
           RowBox[{
            RowBox[{"a", ">", "0"}], "&&", 
            RowBox[{"k", "\[GreaterEqual]", "1"}], "&&", 
            RowBox[{"j", "\[Equal]", 
             RowBox[{"(", 
              RowBox[{"k", "+", "1"}], ")"}]}]}]},
          {"0", "True"}
         },
         AllowedDimensions->{2, Automatic},
         Editable->True,
         GridBoxAlignment->{
          "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxItemSize->{
          "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{1.}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.84]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}},
         Selectable->True]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
        "RowsIndexed" -> {}},
      GridBoxItemSize->{
       "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.35]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     "Piecewise",
     DeleteWithContents->True,
     Editable->False,
     SelectWithContents->True,
     Selectable->False]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"G", "[", 
    RowBox[{"a_", ",", "r_", ",", "\[Mu]_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"G", "[", 
     RowBox[{"a", ",", "r", ",", "\[Mu]"}], "]"}], "=", 
    TagBox[GridBox[{
       {"\[Piecewise]", GridBox[{
          {
           RowBox[{"\[Mu]", "*", "r", "*", 
            FractionBox[
             RowBox[{"F", "[", 
              RowBox[{"a", ",", 
               RowBox[{"r", "+", "1"}], ",", "\[Mu]"}], "]"}], 
             RowBox[{"F", "[", 
              RowBox[{"a", ",", "r", ",", "\[Mu]"}], "]"}]]}], 
           RowBox[{"a", ">", "0"}]},
          {"0", 
           RowBox[{"a", "\[Equal]", "0"}]}
         },
         AllowedDimensions->{2, Automatic},
         Editable->True,
         GridBoxAlignment->{
          "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxItemSize->{
          "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{1.}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.84]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}},
         Selectable->True]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
        "RowsIndexed" -> {}},
      GridBoxItemSize->{
       "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.35]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     "Piecewise",
     DeleteWithContents->True,
     Editable->False,
     SelectWithContents->True,
     Selectable->False]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"R", "[", 
    RowBox[{"a_", ",", "k_", ",", "j_", ",", "\[Gamma]_", ",", "\[Mu]_"}], 
    "]"}], ":=", 
   RowBox[{
    RowBox[{"R", "[", 
     RowBox[{"a", ",", "k", ",", "j", ",", "\[Gamma]", ",", "\[Mu]"}], "]"}], 
    "=", 
    TagBox[GridBox[{
       {"\[Piecewise]", GridBox[{
          {"0", 
           RowBox[{"a", "\[Equal]", "0"}]},
          {
           RowBox[{"\[Gamma]", "*", "a"}], 
           RowBox[{
            RowBox[{"a", ">", "0"}], "&&", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"k", "\[Equal]", "0"}], "||", 
              RowBox[{"k", "\[Equal]", "1"}]}], ")"}]}]},
          {
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "\[Gamma]"}], ")"}], "*", 
             FractionBox[
              RowBox[{
               RowBox[{"G", "[", 
                RowBox[{"a", ",", "k", ",", "\[Mu]"}], "]"}], "*", 
               RowBox[{"(", 
                RowBox[{"k", "-", "1"}], ")"}]}], "2"]}], "+", 
            RowBox[{"\[Gamma]", "*", "a"}]}], 
           RowBox[{
            RowBox[{"a", ">", "0"}], "&&", 
            RowBox[{"k", "\[GreaterEqual]", "2"}], "&&", 
            RowBox[{"j", "\[Equal]", "1"}]}]},
          {
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "\[Gamma]"}], ")"}], "*", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"a", "*", 
                RowBox[{"(", 
                 RowBox[{"j", "-", "2"}], ")"}]}], "+", 
               FractionBox[
                RowBox[{
                 RowBox[{"G", "[", 
                  RowBox[{"a", ",", 
                   RowBox[{"k", "-", 
                    RowBox[{"(", 
                    RowBox[{"j", "-", "1"}], ")"}]}], ",", "\[Mu]"}], "]"}], 
                 "*", 
                 RowBox[{"(", 
                  RowBox[{"k", "-", 
                   RowBox[{"(", 
                    RowBox[{"j", "-", "2"}], ")"}]}], ")"}]}], "2"]}], 
              ")"}]}], "+", 
            RowBox[{"\[Gamma]", "*", "a"}]}], 
           RowBox[{
            RowBox[{"a", ">", "0"}], "&&", 
            RowBox[{"k", "\[GreaterEqual]", "2"}], "&&", 
            RowBox[{"2", "\[LessEqual]", "j"}], "&&", 
            RowBox[{"j", "\[LessEqual]", "k"}]}]},
          {
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "\[Gamma]"}], ")"}], "*", "a", "*", 
             RowBox[{"(", 
              RowBox[{"j", "-", "2"}], ")"}]}], "+", 
            RowBox[{"\[Gamma]", "*", "a"}]}], 
           RowBox[{
            RowBox[{"a", ">", "0"}], "&&", 
            RowBox[{"k", "\[GreaterEqual]", "2"}], "&&", 
            RowBox[{"j", "==", 
             RowBox[{"(", 
              RowBox[{"k", "+", "1"}], ")"}]}]}]}
         },
         AllowedDimensions->{2, Automatic},
         Editable->True,
         GridBoxAlignment->{
          "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxItemSize->{
          "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{1.}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.84]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}},
         Selectable->True]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
        "RowsIndexed" -> {}},
      GridBoxItemSize->{
       "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.35]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     "Piecewise",
     DeleteWithContents->True,
     Editable->False,
     SelectWithContents->True,
     Selectable->False]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Cost", "[", 
    RowBox[{"a_", ",", "n_", ",", "k_", ",", "\[Gamma]_", ",", "\[Mu]_"}], 
    "]"}], ":=", 
   RowBox[{
    RowBox[{"Cost", "[", 
     RowBox[{"a", ",", "n", ",", "k", ",", "\[Gamma]", ",", "\[Mu]"}], "]"}], 
    "=", 
    RowBox[{
     UnderoverscriptBox["\[Sum]", 
      RowBox[{"j", "=", "1"}], 
      RowBox[{"k", "+", "1"}]], 
     RowBox[{
      RowBox[{"p", "[", 
       RowBox[{"a", ",", "k", ",", "j", ",", "\[Mu]"}], "]"}], "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"R", "[", 
         RowBox[{"a", ",", "k", ",", "j", ",", "\[Gamma]", ",", "\[Mu]"}], 
         "]"}], "+", 
        RowBox[{"OptimalCost", "[", 
         RowBox[{
          RowBox[{"n", "-", "1"}], ",", "j", ",", "\[Gamma]", ",", "\[Mu]"}], 
         "]"}]}], ")"}]}]}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.669940990429265*^9, 3.669940992349835*^9}, {
   3.669941042398069*^9, 3.669941159981086*^9}, {3.67011874232135*^9, 
   3.67011874789062*^9}, 3.670119420755623*^9, {3.670119504506112*^9, 
   3.6701195075542107`*^9}, {3.670122774332747*^9, 3.670122816205921*^9}, {
   3.670125565768889*^9, 3.670125566914225*^9}, {3.6701258209150352`*^9, 
   3.670125849939736*^9}, {3.6701260967364492`*^9, 3.6701261115096273`*^9}, {
   3.670127577952091*^9, 3.6701275929497643`*^9}, {3.670539905606686*^9, 
   3.670539954188632*^9}, {3.670540023646208*^9, 3.670540029089903*^9}, {
   3.680854203011239*^9, 3.6808542692845984`*^9}, {3.680854352688651*^9, 
   3.680854379695271*^9}, {3.680854423313044*^9, 3.680854454011541*^9}, {
   3.6808546692418127`*^9, 3.680854718922879*^9}, {3.680854787536099*^9, 
   3.680855026300568*^9}, {3.68085666129111*^9, 3.680856667837531*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "PossiblePolicies", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PossiblePolicies", "[", 
    RowBox[{"n_", ",", "k_", ",", "\[Gamma]_", ",", "\[Mu]_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"PossiblePolicies", "[", 
     RowBox[{"n", ",", "k", ",", "\[Gamma]", ",", "\[Mu]"}], "]"}], "=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"sol", ",", "result"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"sol", "=", 
        RowBox[{
         RowBox[{"NSolve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"D", "[", 
              RowBox[{
               RowBox[{"Cost", "[", 
                RowBox[{
                "a", ",", "n", ",", "k", ",", "\[Gamma]", ",", "\[Mu]"}], 
                "]"}], ",", "a"}], "]"}], "\[Equal]", "0"}], "&&", 
            RowBox[{"a", ">", "0"}]}], ",", "a"}], "]"}], "//", "Quiet"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "sol", "]"}], "\[Equal]", "0"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"result", "=", 
          RowBox[{"{", "0", "}"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"result", "=", 
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{"a", "/.", "sol"}]}], "}"}], "]"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "result"}]}], "\[IndentingNewLine]", "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6705429252157784`*^9, 3.6705430257982407`*^9}, {
  3.680856732389703*^9, 3.6808567481875896`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "OptimalPolicy", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"OptimalPolicy", "[", 
    RowBox[{"n_", ",", "k_", ",", "\[Gamma]_", ",", "\[Mu]_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"OptimalPolicy", "[", 
     RowBox[{"n", ",", "k", ",", "\[Gamma]", ",", "\[Mu]"}], "]"}], "=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"a", ",", " ", "costMin", ",", "i", ",", "result"}], "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"a", "=", 
        RowBox[{"PossiblePolicies", "[", 
         RowBox[{"n", ",", "k", ",", "\[Gamma]", ",", "\[Mu]"}], "]"}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"costMin", "=", 
        RowBox[{"Min", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Cost", "[", 
            RowBox[{
             RowBox[{"a", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", "n", ",", "k", ",", 
             "\[Gamma]", ",", "\[Mu]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", "a", "]"}]}], "}"}]}], "]"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "\[LessEqual]", 
          RowBox[{"Length", "[", "a", "]"}]}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Cost", "[", 
              RowBox[{
               RowBox[{"a", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", "n", ",", "k", ",", 
               "\[Gamma]", ",", "\[Mu]"}], "]"}], "\[Equal]", "costMin"}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"result", "=", 
              RowBox[{"a", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", "result"}]}], 
     "\[IndentingNewLine]", "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.67054351161344*^9, 3.670543592924374*^9}, {
  3.670544315953659*^9, 3.670544431301462*^9}, {3.670544474601811*^9, 
  3.670544534353663*^9}, {3.670544597104101*^9, 3.670544604404606*^9}, {
  3.67054465800191*^9, 3.670544676452883*^9}, {3.670544820003334*^9, 
  3.670544828176632*^9}, {3.6808567605116243`*^9, 3.6808567965124397`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "OptimalCost", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"OptimalCost", "[", 
    RowBox[{"n_", ",", "k_", ",", "\[Gamma]_", ",", "\[Mu]_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"OptimalCost", "[", 
     RowBox[{"n", ",", "k", ",", "\[Gamma]", ",", "\[Mu]"}], "]"}], "=", 
    TagBox[GridBox[{
       {"\[Piecewise]", GridBox[{
          {
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "\[Gamma]"}], ")"}], "*", 
             FractionBox[
              RowBox[{"\[Mu]", "*", "k", "*", 
               RowBox[{"(", 
                RowBox[{"k", "-", "1"}], ")"}]}], "2"]}], "+", 
            RowBox[{"\[Gamma]", "*", "k", "*", "\[Mu]"}]}], 
           RowBox[{"n", "\[Equal]", "0"}]},
          {
           RowBox[{"Cost", "[", 
            RowBox[{
             RowBox[{"OptimalPolicy", "[", 
              RowBox[{"n", ",", "k", ",", "\[Gamma]", ",", "\[Mu]"}], "]"}], 
             ",", "n", ",", "k", ",", "\[Gamma]", ",", "\[Mu]"}], "]"}], 
           RowBox[{"n", "\[GreaterEqual]", "1"}]}
         },
         AllowedDimensions->{2, Automatic},
         Editable->True,
         GridBoxAlignment->{
          "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxItemSize->{
          "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{1.}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.84]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}},
         Selectable->True]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
        "RowsIndexed" -> {}},
      GridBoxItemSize->{
       "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.35]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     "Piecewise",
     DeleteWithContents->True,
     Editable->False,
     SelectWithContents->True,
     Selectable->False]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6705434386894627`*^9, 3.670543493499186*^9}, 
   3.6705446077790327`*^9, {3.680854083760241*^9, 3.680854154267329*^9}, {
   3.6808568365870733`*^9, 3.680856839921689*^9}, {3.6809047970011168`*^9, 
   3.68090479727159*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Mu]", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Gamma]", "=", "0.5"}], ";"}]}], "Input",
 CellChangeTimes->{{3.6701388527887487`*^9, 3.670138855349852*^9}, {
  3.670141385030663*^9, 3.670141385207265*^9}, {3.680856850388595*^9, 
  3.6808568544118834`*^9}, {3.680857519176804*^9, 3.680857519254901*^9}, {
  3.680904236111431*^9, 3.680904236212215*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"$Assumptions", "=", 
  RowBox[{"{", 
   RowBox[{"a", ">", "0"}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Cost", "[", 
   RowBox[{"a", ",", "1", ",", "1", ",", "\[Gamma]", ",", "\[Mu]"}], "]"}], "//",
   "FullSimplify"}]}], "Input",
 CellChangeTimes->{{3.6809042413892736`*^9, 3.680904279234866*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"a", ">", "0"}], "}"}]], "Output",
 CellChangeTimes->{3.680904875143713*^9}],

Cell[BoxData[
 RowBox[{"0.5`", "\[VeryThinSpace]", "+", 
  RowBox[{"0.5`", " ", "a"}], "+", 
  RowBox[{"1.`", " ", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"-", "a"}]]}]}]], "Output",
 CellChangeTimes->{3.6809048752157993`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"num", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{"OptimalCost", "[", 
    RowBox[{"n", ",", "0", ",", "\[Gamma]", ",", "\[Mu]"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"n", ",", "0", ",", "num"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"n", "+", "k"}], "\[LessEqual]", "num"}], ",", 
        RowBox[{"OptimalCost", "[", 
         RowBox[{"n", ",", "k", ",", "\[Gamma]", ",", "\[Mu]"}], "]"}], ",", 
        "0"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "0", ",", "num"}], "}"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"n", ",", "0", ",", "num"}], "}"}]}], "]"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"n", "+", "k"}], "\[LessEqual]", "num"}], ",", 
        RowBox[{"OptimalPolicy", "[", 
         RowBox[{"n", ",", "k", ",", "\[Gamma]", ",", "\[Mu]"}], "]"}], ",", 
        "0"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "0", ",", "num"}], "}"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"n", ",", "1", ",", "num"}], "}"}]}], "]"}], "//", 
  "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.6704760892990427`*^9, 3.670476089332934*^9}, 
   3.6705446154046926`*^9, {3.68085686013916*^9, 3.68085687561231*^9}, {
   3.680857419477059*^9, 3.6808574195051413`*^9}, {3.680857473296444*^9, 
   3.6808574733375874`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.`", ",", "0.5`", ",", "1.3465735902799727`"}], "}"}]], "Output",
 CellChangeTimes->{3.680904889495212*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.`", "0.5`", "1.5`"},
     {"0.5`", "1.3465735902799727`", "0"},
     {"1.3465735902799727`", "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.680904889540704*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0.6931471805599453`", "0"},
     {"0", "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.680904889543543*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "\[Mu]"}], "*", 
  RowBox[{"Log", "[", "\[Gamma]", "]"}]}]], "Input",
 CellChangeTimes->{{3.6808574988670073`*^9, 3.680857504845132*^9}}],

Cell[BoxData["0.6931471805599453`"], "Output",
 CellChangeTimes->{3.680904892226017*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"TeXForm", "[", 
  RowBox[{"MatrixForm", "[", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"n", "+", "k"}], "\[LessEqual]", "num"}], ",", 
         RowBox[{"OptimalCost", "[", 
          RowBox[{"n", ",", "k", ",", "\[Gamma]", ",", "\[Mu]"}], "]"}], ",", 
         "0"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "0", ",", "num"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", "0", ",", "num"}], "}"}]}], "]"}], "]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.670539860603891*^9, 3.670539901113492*^9}, {
  3.670540104616185*^9, 3.670540105714847*^9}, {3.6808568812877083`*^9, 
  3.680856883770735*^9}}],

Cell[BoxData[
 RowBox[{"TeXForm", "[", 
  RowBox[{"MatrixForm", "[", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"n", "+", "k"}], "\[LessEqual]", "num"}], ",", 
         RowBox[{"OptimalPolicy", "[", 
          RowBox[{"n", ",", "k", ",", "\[Gamma]", ",", "\[Mu]"}], "]"}], ",", 
         "0"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "0", ",", "num"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", "1", ",", "num"}], "}"}]}], "]"}], "]"}], 
  "]"}]], "Input",
 CellChangeTimes->{
  3.670544618954814*^9, {3.6808568917144527`*^9, 3.680856903321348*^9}}],

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"Cost", "[", 
    RowBox[{"a", ",", "3", ",", "2", ",", "\[Gamma]", ",", "\[Mu]"}], "]"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"a", ",", "0", ",", "8"}], "}"}], ",", 
   RowBox[{"AxesLabel", "\[Rule]", "Automatic"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.670138358869254*^9, 3.6701383591862383`*^9}, {
  3.670141343206565*^9, 3.670141368071753*^9}, {3.670476245003521*^9, 
  3.670476245744802*^9}, {3.6808569121393747`*^9, 3.680856914621797*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Cost", "[", 
   RowBox[{"a", ",", "3", ",", "2", ",", "\[Gamma]", ",", "\[Mu]"}], "]"}], "//",
   "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.670476672658648*^9, 3.6704766837957497`*^9}, {
  3.6808569184390793`*^9, 3.680856920547626*^9}}],

Cell[BoxData[
 RowBox[{"TeXForm", "[", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"Cost", "[", 
    RowBox[{"a", ",", "3", ",", "2", ",", "\[Gamma]", ",", "\[Mu]"}], "]"}], 
   "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.67053589737744*^9, 3.670535920886181*^9}, {
  3.680856924389134*^9, 3.680856926772306*^9}}],

Cell[BoxData[{
 RowBox[{"PossiblePolicies", "[", 
  RowBox[{"3", ",", "2", ",", "\[Gamma]", ",", "\[Mu]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"OptimalPolicy", "[", 
  RowBox[{"3", ",", "2", ",", "\[Gamma]", ",", "\[Mu]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"OptimalCost", "[", 
  RowBox[{"3", ",", "2", ",", "\[Gamma]", ",", "\[Mu]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.67047699766227*^9, 3.6704770049219437`*^9}, 
   3.670544639254498*^9, {3.670544746880262*^9, 3.6705447541010323`*^9}, {
   3.680856931014089*^9, 3.680856941997087*^9}}]
},
WindowSize->{1918, 1035},
WindowMargins->{{Automatic, 0}, {Automatic, 0}},
Magnification:>1.25 Inherited,
FrontEndVersion->"8.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (October 5, \
2011)",
StyleDefinitions->"Default.nb",
PrivateNotebookOptions -> {
 "VersionedStylesheet" -> {"Default.nb"[8.] -> False}}
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 13782, 363, 500, "Input"],
Cell[14342, 385, 1776, 46, 186, "Input"],
Cell[16121, 433, 2532, 61, 224, "Input"],
Cell[18656, 496, 2780, 69, 88, "Input"],
Cell[21439, 567, 413, 8, 53, "Input"],
Cell[CellGroupData[{
Cell[21877, 579, 338, 8, 53, "Input"],
Cell[22218, 589, 115, 3, 33, "Output"],
Cell[22336, 594, 237, 6, 36, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[22610, 605, 1690, 47, 91, "Input"],
Cell[24303, 654, 148, 3, 33, "Output"],
Cell[24454, 659, 706, 19, 85, "Output"],
Cell[25163, 680, 655, 18, 67, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[25855, 703, 176, 4, 33, "Input"],
Cell[26034, 709, 88, 1, 33, "Output"]
}, Open  ]],
Cell[26137, 713, 784, 21, 33, "Input"],
Cell[26924, 736, 713, 20, 33, "Input"],
Cell[27640, 758, 511, 11, 33, "Input"],
Cell[28154, 771, 279, 6, 33, "Input"],
Cell[28436, 779, 315, 7, 33, "Input"],
Cell[28754, 788, 562, 11, 72, "Input"]
}
]
*)

(* End of internal cache information *)
