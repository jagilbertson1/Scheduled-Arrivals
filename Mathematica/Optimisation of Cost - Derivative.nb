(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     44838,       1204]
NotebookOptionsPosition[     42998,       1140]
NotebookOutlinePosition[     43464,       1158]
CellTagsIndexPosition[     43421,       1155]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"F", ",", "G", ",", "p", ",", "R", ",", "Cost"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"F", "[", 
    RowBox[{"a_", ",", "r_", ",", "\[Mu]_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"F", "[", 
     RowBox[{"a", ",", "r", ",", "\[Mu]"}], "]"}], "=", 
    TagBox[GridBox[{
       {"\[Piecewise]", GridBox[{
          {
           RowBox[{"1", "-", 
            RowBox[{
             UnderoverscriptBox["\[Sum]", 
              RowBox[{"i", "=", "0"}], 
              RowBox[{"r", "-", "1"}]], 
             RowBox[{
              FractionBox["1", 
               RowBox[{"i", "!"}]], "*", 
              SuperscriptBox[
               RowBox[{"(", 
                FractionBox["a", "\[Mu]"], ")"}], "i"], "*", 
              RowBox[{"Exp", "[", 
               FractionBox[
                RowBox[{"-", "a"}], "\[Mu]"], "]"}]}]}]}], 
           RowBox[{"a", ">", "0"}]},
          {"0", 
           RowBox[{"a", "\[Equal]", "0"}]}
         },
         AllowedDimensions->{2, Automatic},
         Editable->True,
         GridBoxAlignment->{
          "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxItemSize->{
          "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{1.}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.84]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}},
         Selectable->True]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
        "RowsIndexed" -> {}},
      GridBoxItemSize->{
       "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.35]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     "Piecewise",
     DeleteWithContents->True,
     Editable->False,
     SelectWithContents->True,
     Selectable->False]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"p", "[", 
    RowBox[{"a_", ",", "k_", ",", "j_", ",", "\[Mu]_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"p", "[", 
     RowBox[{"a", ",", "k", ",", "j", ",", "\[Mu]"}], "]"}], "=", 
    TagBox[GridBox[{
       {"\[Piecewise]", GridBox[{
          {
           RowBox[{"Boole", "[", 
            RowBox[{"j", "\[Equal]", "1"}], "]"}], 
           RowBox[{"k", "\[Equal]", "0"}]},
          {
           RowBox[{"F", "[", 
            RowBox[{"a", ",", "k", ",", "\[Mu]"}], "]"}], 
           RowBox[{
            RowBox[{"k", "\[GreaterEqual]", "1"}], "&&", 
            RowBox[{"j", "\[Equal]", "1"}]}]},
          {
           RowBox[{
            RowBox[{"F", "[", 
             RowBox[{"a", ",", 
              RowBox[{"k", "-", "j", "+", "1"}], ",", "\[Mu]"}], "]"}], "-", 
            RowBox[{"F", "[", 
             RowBox[{"a", ",", 
              RowBox[{"k", "-", "j", "+", "2"}], ",", "\[Mu]"}], "]"}]}], 
           RowBox[{
            RowBox[{"k", "\[GreaterEqual]", "1"}], "&&", 
            RowBox[{"2", "\[LessEqual]", "j"}], "&&", 
            RowBox[{"j", "\[LessEqual]", "k"}]}]},
          {
           RowBox[{"1", "-", 
            RowBox[{"F", "[", 
             RowBox[{"a", ",", "1", ",", "\[Mu]"}], "]"}]}], 
           RowBox[{
            RowBox[{"k", "\[GreaterEqual]", "1"}], "&&", 
            RowBox[{"j", "\[Equal]", 
             RowBox[{"(", 
              RowBox[{"k", "+", "1"}], ")"}]}]}]}
         },
         AllowedDimensions->{2, Automatic},
         Editable->True,
         GridBoxAlignment->{
          "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxItemSize->{
          "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{1.}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.84]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}},
         Selectable->True]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
        "RowsIndexed" -> {}},
      GridBoxItemSize->{
       "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.35]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     "Piecewise",
     DeleteWithContents->True,
     Editable->False,
     SelectWithContents->True,
     Selectable->False]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"G", "[", 
    RowBox[{"a_", ",", "r_", ",", "\[Mu]_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"G", "[", 
     RowBox[{"a", ",", "r", ",", "\[Mu]"}], "]"}], "=", 
    TagBox[GridBox[{
       {"\[Piecewise]", GridBox[{
          {
           RowBox[{"\[Mu]", "*", "r", "*", 
            FractionBox[
             RowBox[{"F", "[", 
              RowBox[{"a", ",", 
               RowBox[{"r", "+", "1"}], ",", "\[Mu]"}], "]"}], 
             RowBox[{"F", "[", 
              RowBox[{"a", ",", "r", ",", "\[Mu]"}], "]"}]]}], 
           RowBox[{"a", ">", "0"}]},
          {"0", 
           RowBox[{"a", "\[Equal]", "0"}]}
         },
         AllowedDimensions->{2, Automatic},
         Editable->True,
         GridBoxAlignment->{
          "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxItemSize->{
          "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{1.}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.84]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}},
         Selectable->True]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
        "RowsIndexed" -> {}},
      GridBoxItemSize->{
       "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.35]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     "Piecewise",
     DeleteWithContents->True,
     Editable->False,
     SelectWithContents->True,
     Selectable->False]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"R", "[", 
    RowBox[{"a_", ",", "k_", ",", "j_", ",", "\[Gamma]_", ",", "\[Mu]_"}], 
    "]"}], ":=", 
   RowBox[{
    RowBox[{"R", "[", 
     RowBox[{"a", ",", "k", ",", "j", ",", "\[Gamma]", ",", "\[Mu]"}], "]"}], 
    "=", 
    TagBox[GridBox[{
       {"\[Piecewise]", GridBox[{
          {
           RowBox[{"\[Gamma]", "*", "a"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"k", "\[Equal]", "0"}], "||", 
             RowBox[{"k", "\[Equal]", "1"}]}], ")"}]},
          {
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "\[Gamma]"}], ")"}], "*", 
             FractionBox[
              RowBox[{
               RowBox[{"G", "[", 
                RowBox[{"a", ",", "k", ",", "\[Mu]"}], "]"}], "*", 
               RowBox[{"(", 
                RowBox[{"k", "-", "1"}], ")"}]}], "2"]}], "+", 
            RowBox[{"\[Gamma]", "*", "a"}]}], 
           RowBox[{
            RowBox[{"k", "\[GreaterEqual]", "2"}], "&&", 
            RowBox[{"j", "\[Equal]", "1"}]}]},
          {
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "\[Gamma]"}], ")"}], "*", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"a", "*", 
                RowBox[{"(", 
                 RowBox[{"j", "-", "2"}], ")"}]}], "+", 
               FractionBox[
                RowBox[{
                 RowBox[{"G", "[", 
                  RowBox[{"a", ",", 
                   RowBox[{"k", "-", 
                    RowBox[{"(", 
                    RowBox[{"j", "-", "1"}], ")"}]}], ",", "\[Mu]"}], "]"}], 
                 "*", 
                 RowBox[{"(", 
                  RowBox[{"k", "-", 
                   RowBox[{"(", 
                    RowBox[{"j", "-", "2"}], ")"}]}], ")"}]}], "2"]}], 
              ")"}]}], "+", 
            RowBox[{"\[Gamma]", "*", "a"}]}], 
           RowBox[{
            RowBox[{"k", "\[GreaterEqual]", "2"}], "&&", 
            RowBox[{"2", "\[LessEqual]", "j"}], "&&", 
            RowBox[{"j", "\[LessEqual]", "k"}]}]},
          {
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "\[Gamma]"}], ")"}], "*", "a", "*", 
             RowBox[{"(", 
              RowBox[{"j", "-", "2"}], ")"}]}], "+", 
            RowBox[{"\[Gamma]", "*", "a"}]}], 
           RowBox[{
            RowBox[{"k", "\[GreaterEqual]", "2"}], "&&", 
            RowBox[{"j", "==", 
             RowBox[{"(", 
              RowBox[{"k", "+", "1"}], ")"}]}]}]}
         },
         AllowedDimensions->{2, Automatic},
         Editable->True,
         GridBoxAlignment->{
          "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxItemSize->{
          "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{1.}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.84]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}},
         Selectable->True]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
        "RowsIndexed" -> {}},
      GridBoxItemSize->{
       "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.35]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     "Piecewise",
     DeleteWithContents->True,
     Editable->False,
     SelectWithContents->True,
     Selectable->False]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Cost", "[", 
    RowBox[{"a_", ",", "n_", ",", "k_", ",", "\[Gamma]_", ",", "\[Mu]_"}], 
    "]"}], ":=", 
   RowBox[{
    RowBox[{"Cost", "[", 
     RowBox[{"a", ",", "n", ",", "k", ",", "\[Gamma]", ",", "\[Mu]"}], "]"}], 
    "=", 
    RowBox[{
     UnderoverscriptBox["\[Sum]", 
      RowBox[{"j", "=", "1"}], 
      RowBox[{"k", "+", "1"}]], 
     RowBox[{
      RowBox[{"p", "[", 
       RowBox[{"a", ",", "k", ",", "j", ",", "\[Mu]"}], "]"}], "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"R", "[", 
         RowBox[{"a", ",", "k", ",", "j", ",", "\[Gamma]", ",", "\[Mu]"}], 
         "]"}], "+", 
        RowBox[{"OptimalCost", "[", 
         RowBox[{
          RowBox[{"n", "-", "1"}], ",", "j", ",", "\[Gamma]", ",", "\[Mu]"}], 
         "]"}]}], ")"}]}]}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.669940990429265*^9, 3.669940992349835*^9}, {
   3.669941042398069*^9, 3.669941159981086*^9}, {3.67011874232135*^9, 
   3.67011874789062*^9}, 3.670119420755623*^9, {3.670119504506112*^9, 
   3.6701195075542107`*^9}, {3.670122774332747*^9, 3.670122816205921*^9}, {
   3.670125565768889*^9, 3.670125566914225*^9}, {3.6701258209150352`*^9, 
   3.670125849939736*^9}, {3.6701260967364492`*^9, 3.6701261115096273`*^9}, {
   3.670127577952091*^9, 3.6701275929497643`*^9}, {3.670539905606686*^9, 
   3.670539954188632*^9}, {3.670540023646208*^9, 3.670540029089903*^9}, {
   3.680854203011239*^9, 3.6808542692845984`*^9}, {3.680854352688651*^9, 
   3.680854379695271*^9}, {3.680854423313044*^9, 3.680854454011541*^9}, {
   3.6808546692418127`*^9, 3.680854718922879*^9}, {3.680854787536099*^9, 
   3.680855026300568*^9}, {3.68085666129111*^9, 3.680856667837531*^9}, {
   3.6809460100630283`*^9, 3.680946030860652*^9}, {3.680946107207241*^9, 
   3.680946162775567*^9}, {3.680946285640839*^9, 3.680946286904187*^9}, {
   3.6809463232793303`*^9, 3.680946339002398*^9}, {3.6809464379122763`*^9, 
   3.680946472601396*^9}, {3.680946640915572*^9, 3.680946642038453*^9}, {
   3.680946693917694*^9, 3.680946711345537*^9}, {3.680946966227248*^9, 
   3.6809469710655622`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "PossiblePolicies", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PossiblePolicies", "[", 
    RowBox[{"n_", ",", "k_", ",", "\[Gamma]_", ",", "\[Mu]_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"PossiblePolicies", "[", 
     RowBox[{"n", ",", "k", ",", "\[Gamma]", ",", "\[Mu]"}], "]"}], "=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"sol", ",", "result"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"sol", "=", 
        RowBox[{
         RowBox[{"NSolve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"D", "[", 
              RowBox[{
               RowBox[{"Cost", "[", 
                RowBox[{
                "a", ",", "n", ",", "k", ",", "\[Gamma]", ",", "\[Mu]"}], 
                "]"}], ",", "a"}], "]"}], "\[Equal]", "0"}], "&&", 
            RowBox[{"a", ">", "0"}]}], ",", "a"}], "]"}], "//", "Quiet"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "sol", "]"}], "\[Equal]", "0"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"result", "=", 
          RowBox[{"{", "0", "}"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"result", "=", 
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{"a", "/.", "sol"}]}], "}"}], "]"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "result"}]}], "\[IndentingNewLine]", "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6705429252157784`*^9, 3.6705430257982407`*^9}, {
  3.680856732389703*^9, 3.6808567481875896`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "OptimalPolicy", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"OptimalPolicy", "[", 
    RowBox[{"n_", ",", "k_", ",", "\[Gamma]_", ",", "\[Mu]_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"OptimalPolicy", "[", 
     RowBox[{"n", ",", "k", ",", "\[Gamma]", ",", "\[Mu]"}], "]"}], "=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"a", ",", " ", "costMin", ",", "i", ",", "result"}], "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"a", "=", 
        RowBox[{"PossiblePolicies", "[", 
         RowBox[{"n", ",", "k", ",", "\[Gamma]", ",", "\[Mu]"}], "]"}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"costMin", "=", 
        RowBox[{"Min", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Cost", "[", 
            RowBox[{
             RowBox[{"a", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", "n", ",", "k", ",", 
             "\[Gamma]", ",", "\[Mu]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", "a", "]"}]}], "}"}]}], "]"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "\[LessEqual]", 
          RowBox[{"Length", "[", "a", "]"}]}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Cost", "[", 
              RowBox[{
               RowBox[{"a", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", "n", ",", "k", ",", 
               "\[Gamma]", ",", "\[Mu]"}], "]"}], "\[Equal]", "costMin"}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"result", "=", 
              RowBox[{"a", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", "result"}]}], 
     "\[IndentingNewLine]", "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.67054351161344*^9, 3.670543592924374*^9}, {
  3.670544315953659*^9, 3.670544431301462*^9}, {3.670544474601811*^9, 
  3.670544534353663*^9}, {3.670544597104101*^9, 3.670544604404606*^9}, {
  3.67054465800191*^9, 3.670544676452883*^9}, {3.670544820003334*^9, 
  3.670544828176632*^9}, {3.6808567605116243`*^9, 3.6808567965124397`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "OptimalCost", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"OptimalCost", "[", 
    RowBox[{"n_", ",", "k_", ",", "\[Gamma]_", ",", "\[Mu]_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"OptimalCost", "[", 
     RowBox[{"n", ",", "k", ",", "\[Gamma]", ",", "\[Mu]"}], "]"}], "=", 
    TagBox[GridBox[{
       {"\[Piecewise]", GridBox[{
          {
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "\[Gamma]"}], ")"}], "*", 
             FractionBox[
              RowBox[{"\[Mu]", "*", "k", "*", 
               RowBox[{"(", 
                RowBox[{"k", "-", "1"}], ")"}]}], "2"]}], "+", 
            RowBox[{"\[Gamma]", "*", "k", "*", "\[Mu]"}]}], 
           RowBox[{"n", "\[Equal]", "0"}]},
          {
           RowBox[{"Cost", "[", 
            RowBox[{
             RowBox[{"OptimalPolicy", "[", 
              RowBox[{"n", ",", "k", ",", "\[Gamma]", ",", "\[Mu]"}], "]"}], 
             ",", "n", ",", "k", ",", "\[Gamma]", ",", "\[Mu]"}], "]"}], 
           RowBox[{"n", "\[GreaterEqual]", "1"}]}
         },
         AllowedDimensions->{2, Automatic},
         Editable->True,
         GridBoxAlignment->{
          "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxItemSize->{
          "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{1.}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.84]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}},
         Selectable->True]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
        "RowsIndexed" -> {}},
      GridBoxItemSize->{
       "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.35]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     "Piecewise",
     DeleteWithContents->True,
     Editable->False,
     SelectWithContents->True,
     Selectable->False]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6705434386894627`*^9, 3.670543493499186*^9}, 
   3.6705446077790327`*^9, {3.680854083760241*^9, 3.680854154267329*^9}, {
   3.6808568365870733`*^9, 3.680856839921689*^9}, {3.6809047970011168`*^9, 
   3.68090479727159*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Cost", "[", 
   RowBox[{"a", ",", "1", ",", "1", ",", "\[Gamma]", ",", "\[Mu]"}], "]"}], "//",
   "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.6809042413892736`*^9, 3.680904279234866*^9}, 
   3.6809097898586884`*^9}],

Cell[BoxData[
 TagBox[GridBox[{
    {"\[Piecewise]", GridBox[{
       {
        RowBox[{"\[Mu]", "+", 
         RowBox[{"\[Gamma]", " ", 
          RowBox[{"(", 
           RowBox[{"a", "+", "\[Mu]"}], ")"}]}]}], 
        RowBox[{"a", "\[LessEqual]", "0"}]},
       {
        RowBox[{
         RowBox[{"a", " ", "\[Gamma]"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{"-", 
              FractionBox["a", "\[Mu]"]}]], "+", "\[Gamma]"}], ")"}], " ", 
          "\[Mu]"}]}], 
        TagBox["True",
         "PiecewiseDefault",
         AutoDelete->True]}
      },
      AllowedDimensions->{2, Automatic},
      Editable->True,
      GridBoxAlignment->{
       "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
        "RowsIndexed" -> {}},
      GridBoxItemSize->{
       "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.84]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}},
      Selectable->True]}
   },
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}},
   GridBoxItemSize->{
    "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
     "RowsIndexed" -> {}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.35]}, 
       Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}, "RowsIndexed" -> {}}],
  "Piecewise",
  DeleteWithContents->True,
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellChangeTimes->{3.680953188287046*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Mu]", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Gamma]", "=", "0.5"}], ";"}]}], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"OptimalPolicy", "[", 
   RowBox[{"1", ",", "1", ",", "\[Gamma]", ",", "\[Mu]"}], "]"}], "\[Equal]", 
  
  RowBox[{
   RowBox[{"-", "\[Mu]"}], "*", 
   RowBox[{"Log", "[", "\[Gamma]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.680905506164727*^9, 3.680905531736383*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.680953188568213*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"num", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{"OptimalCost", "[", 
    RowBox[{"n", ",", "0", ",", "\[Gamma]", ",", "\[Mu]"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"n", ",", "0", ",", "num"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"n", "+", "k"}], "\[LessEqual]", "num"}], ",", 
        RowBox[{"OptimalCost", "[", 
         RowBox[{"n", ",", "k", ",", "\[Gamma]", ",", "\[Mu]"}], "]"}], ",", 
        "0"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "0", ",", "num"}], "}"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"n", ",", "0", ",", "num"}], "}"}]}], "]"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"n", "+", "k"}], "\[LessEqual]", "num"}], ",", 
        RowBox[{"OptimalPolicy", "[", 
         RowBox[{"n", ",", "k", ",", "\[Gamma]", ",", "\[Mu]"}], "]"}], ",", 
        "0"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "0", ",", "num"}], "}"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"n", ",", "1", ",", "num"}], "}"}]}], "]"}], "//", 
  "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.6704760892990427`*^9, 3.670476089332934*^9}, 
   3.6705446154046926`*^9, {3.68085686013916*^9, 3.68085687561231*^9}, {
   3.680857419477059*^9, 3.6808574195051413`*^9}, {3.680857473296444*^9, 
   3.6808574733375874`*^9}, {3.6809054674804077`*^9, 
   3.6809054721962748`*^9}, {3.680905542053706*^9, 3.6809055623140173`*^9}, {
   3.680909537995883*^9, 3.6809095380743237`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.`", ",", "0.5`", ",", "1.3465735902799727`", ",", "2.260024369120754`", 
   ",", "3.1750893754294105`"}], "}"}]], "Output",
 CellChangeTimes->{3.6809531923971643`*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.`", "0.5`", "1.5`", "3.`", "5.`"},
     {"0.5`", "1.3465735902799727`", "2.489685600977099`", 
      "4.024747397234465`", "0"},
     {"1.3465735902799727`", "2.260024369120754`", "3.406832829130295`", "0", 
      "0"},
     {"2.260024369120754`", "3.1750893754294105`", "0", "0", "0"},
     {"3.1750893754294105`", "0", "0", "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.680953192464779*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0.6931471805599453`", "1.7571124685678317`", 
      "2.8257748622620933`", "0"},
     {"0", "0.8269015576815626`", "1.9022303245886247`", "0", "0"},
     {"0", "0.8301300126173135`", "0", "0", "0"},
     {"0", "0", "0", "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.680953192472603*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TeXForm", "[", 
  RowBox[{"MatrixForm", "[", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"n", "+", "k"}], "\[LessEqual]", "num"}], ",", 
         RowBox[{"OptimalCost", "[", 
          RowBox[{"n", ",", "k", ",", "\[Gamma]", ",", "\[Mu]"}], "]"}], ",", 
         "0"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "0", ",", "num"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", "0", ",", "num"}], "}"}]}], "]"}], "]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.670539860603891*^9, 3.670539901113492*^9}, {
  3.670540104616185*^9, 3.670540105714847*^9}, {3.6808568812877083`*^9, 
  3.680856883770735*^9}}],

Cell["\<\
\\left(
\\begin{array}{ccccc}
 0. & 0.5 & 1.5 & 3. & 5. \\\\
 0.5 & 1.34657 & 2.48969 & 4.02475 & 0 \\\\
 1.34657 & 2.26002 & 3.40683 & 0 & 0 \\\\
 2.26002 & 3.17509 & 0 & 0 & 0 \\\\
 3.17509 & 0 & 0 & 0 & 0 \\\\
\\end{array}
\\right)\
\>", "Output",
 CellChangeTimes->{3.680953192729274*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TeXForm", "[", 
  RowBox[{"MatrixForm", "[", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"n", "+", "k"}], "\[LessEqual]", "num"}], ",", 
         RowBox[{"OptimalPolicy", "[", 
          RowBox[{"n", ",", "k", ",", "\[Gamma]", ",", "\[Mu]"}], "]"}], ",", 
         "0"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "0", ",", "num"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", "1", ",", "num"}], "}"}]}], "]"}], "]"}], 
  "]"}]], "Input",
 CellChangeTimes->{
  3.670544618954814*^9, {3.6808568917144527`*^9, 3.680856903321348*^9}}],

Cell["\<\
\\left(
\\begin{array}{ccccc}
 0 & 0.693147 & 1.75711 & 2.82577 & 0 \\\\
 0 & 0.826902 & 1.90223 & 0 & 0 \\\\
 0 & 0.83013 & 0 & 0 & 0 \\\\
 0 & 0 & 0 & 0 & 0 \\\\
\\end{array}
\\right)\
\>", "Output",
 CellChangeTimes->{3.6809531927515593`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"Cost", "[", 
    RowBox[{"a", ",", "3", ",", "2", ",", "\[Gamma]", ",", "\[Mu]"}], "]"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"a", ",", "0", ",", "8"}], "}"}], ",", 
   RowBox[{"AxesLabel", "\[Rule]", "Automatic"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.670138358869254*^9, 3.6701383591862383`*^9}, {
   3.670141343206565*^9, 3.670141368071753*^9}, {3.670476245003521*^9, 
   3.670476245744802*^9}, {3.6808569121393747`*^9, 3.680856914621797*^9}, 
   3.6809097008441763`*^9, {3.6809099307267733`*^9, 3.680909932677642*^9}}],

Cell[BoxData[
 GraphicsBox[{{}, {}, 
   {RGBColor[0.368417, 0.506779, 0.709798], AbsoluteThickness[1.6], Opacity[
    1.], LineBox[CompressedData["
1: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
Euga
     "]]}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{
    FormBox[
     TagBox["a", HoldForm], TraditionalForm], None},
  AxesOrigin->{0, 4.5},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{
   "DefaultBoundaryStyle" -> Automatic, "DefaultMeshStyle" -> 
    AbsolutePointSize[6], "ScalingFunctions" -> None},
  PlotRange->{{0, 8}, {4.5843645910166, 7.499999494993148}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{3.680953193185912*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Cost", "[", 
   RowBox[{"a", ",", "3", ",", "2", ",", "\[Gamma]", ",", "\[Mu]"}], "]"}], "//",
   "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.670476672658648*^9, 3.6704766837957497`*^9}, {
  3.6808569184390793`*^9, 3.680856920547626*^9}}],

Cell[BoxData[
 TagBox[GridBox[{
    {"\[Piecewise]", GridBox[{
       {
        RowBox[{"7.5`", "\[VeryThinSpace]", "+", 
         RowBox[{"1.`", " ", "a"}]}], 
        RowBox[{"a", "\[LessEqual]", "0"}]},
       {
        RowBox[{"2.760024369120753`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.5`", " ", "a"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"4.739975630879247`", "\[VeryThinSpace]", "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1.6468084600095412`", "\[VeryThinSpace]", "+", 
               RowBox[{"0.25`", " ", "a"}]}], ")"}], " ", "a"}]}], ")"}], " ", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"-", "a"}]]}], "-", 
         FractionBox[
          RowBox[{"0.5`", " ", 
           SuperscriptBox["a", "2"]}], 
          RowBox[{
           RowBox[{"-", "1.`"}], "+", 
           RowBox[{"1.`", " ", 
            SuperscriptBox["\[ExponentialE]", "a"]}]}]]}], 
        TagBox["True",
         "PiecewiseDefault",
         AutoDelete->True]}
      },
      AllowedDimensions->{2, Automatic},
      Editable->True,
      GridBoxAlignment->{
       "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
        "RowsIndexed" -> {}},
      GridBoxItemSize->{
       "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.84]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}},
      Selectable->True]}
   },
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}},
   GridBoxItemSize->{
    "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
     "RowsIndexed" -> {}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.35]}, 
       Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}, "RowsIndexed" -> {}}],
  "Piecewise",
  DeleteWithContents->True,
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellChangeTimes->{3.68095319525391*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TeXForm", "[", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"Cost", "[", 
    RowBox[{"a", ",", "3", ",", "2", ",", "\[Gamma]", ",", "\[Mu]"}], "]"}], 
   "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.67053589737744*^9, 3.670535920886181*^9}, {
  3.680856924389134*^9, 3.680856926772306*^9}}],

Cell["\<\
\\begin{cases}
 1. a+7.5 & a\\leq 0 \\\\
 -\\frac{0.5 a^2}{1. e^a-1.}+0.5 a+((0.25 a+1.64681) a+4.73998) \
e^{-a}+2.76002 & \\text{True}
\\end{cases}\
\>", "Output",
 CellChangeTimes->{3.6809531954832478`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"PossiblePolicies", "[", 
  RowBox[{"3", ",", "2", ",", "\[Gamma]", ",", "\[Mu]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"OptimalPolicy", "[", 
  RowBox[{"3", ",", "2", ",", "\[Gamma]", ",", "\[Mu]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"OptimalCost", "[", 
  RowBox[{"3", ",", "2", ",", "\[Gamma]", ",", "\[Mu]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.67047699766227*^9, 3.6704770049219437`*^9}, 
   3.670544639254498*^9, {3.670544746880262*^9, 3.6705447541010323`*^9}, {
   3.680856931014089*^9, 3.680856941997087*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "2.5822258896918453`"}], "}"}]], "Output",
 CellChangeTimes->{3.6809531956899347`*^9}],

Cell[BoxData["2.5822258896918453`"], "Output",
 CellChangeTimes->{3.680953195694916*^9}],

Cell[BoxData["4.5843644642165575`"], "Output",
 CellChangeTimes->{3.68095319569775*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"PossiblePolicies", "[", 
   RowBox[{"3", ",", "2", ",", "\[Gamma]", ",", "\[Mu]"}], "]"}], "[", 
  RowBox[{"[", 
   RowBox[{
    RowBox[{"Ordering", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Cost", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"PossiblePolicies", "[", 
            RowBox[{"3", ",", "2", ",", "\[Gamma]", ",", "\[Mu]"}], "]"}], 
           "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", "3", ",", "2", ",", 
          "\[Gamma]", ",", "\[Mu]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", 
           RowBox[{"PossiblePolicies", "[", 
            RowBox[{"3", ",", "2", ",", "\[Gamma]", ",", "\[Mu]"}], "]"}], 
           "]"}]}], "}"}]}], "]"}], ",", "1"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.680953270566944*^9, 3.680953388368101*^9}}],

Cell[BoxData["2.5822258896918453`"], "Output",
 CellChangeTimes->{{3.6809533130443497`*^9, 3.680953358554549*^9}, 
   3.680953389018724*^9}]
}, Open  ]]
},
WindowSize->{1280, 774},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
PrivateNotebookOptions->{"VersionedStylesheet"->{"Default.nb"[8.] -> False}},
Magnification:>1.25 Inherited,
FrontEndVersion->"10.3 for Mac OS X x86 (32-bit, 64-bit Kernel) (December 10, \
2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 13519, 351, 466, "Input"],
Cell[14079, 373, 1776, 46, 204, "Input"],
Cell[15858, 421, 2532, 61, 246, "Input"],
Cell[18393, 484, 2780, 69, 94, "Input"],
Cell[CellGroupData[{
Cell[21198, 557, 256, 6, 36, "Input"],
Cell[21457, 565, 1977, 58, 80, "Output"]
}, Open  ]],
Cell[23449, 626, 150, 4, 57, "Input"],
Cell[CellGroupData[{
Cell[23624, 634, 304, 8, 36, "Input"],
Cell[23931, 644, 73, 1, 35, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[24041, 650, 1844, 49, 99, "Input"],
Cell[25888, 701, 212, 5, 35, "Output"],
Cell[26103, 708, 939, 23, 138, "Output"],
Cell[27045, 733, 836, 21, 116, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[27918, 759, 784, 21, 36, "Input"],
Cell[28705, 782, 302, 11, 195, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[29044, 798, 713, 20, 36, "Input"],
Cell[29760, 820, 255, 10, 177, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[30052, 835, 589, 12, 35, "Input"],
Cell[30644, 849, 7005, 128, 292, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[37686, 982, 279, 6, 36, "Input"],
Cell[37968, 990, 2367, 65, 72, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[40372, 1060, 315, 7, 36, "Input"],
Cell[40690, 1069, 219, 7, 104, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[40946, 1081, 562, 11, 78, "Input"],
Cell[41511, 1094, 135, 3, 35, "Output"],
Cell[41649, 1099, 88, 1, 35, "Output"],
Cell[41740, 1102, 87, 1, 35, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[41864, 1108, 975, 25, 78, "Input"],
Cell[42842, 1135, 140, 2, 35, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
